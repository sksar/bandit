import{S as B,i as Q,s as U,e as g,t as M,a as O,f as w,j as v,k as j,g as p,d as L,m as h,o as T,p as b,A as S,U as le,a8 as de,b as q,K as ae,u as D,H as ue,r as k,z as _e,_ as V,$ as A,a0 as C,a1 as F,c as me,l as he,q as pe,v as be,B as H,I as z,M as J,T as G,a9 as W,D as ye,a7 as ve,V as X,N as Y,O as Z}from"./index.5a1822b8.js";import{f as N}from"./index.63bf04fb.js";import{t as ge,a as we,l as ke}from"./formatting.925f31ed.js";import"./index.0c99c3d9.js";import{c as De,E as Ee,T as Te,Q as Se,d as Ie}from"./VennDiagram.svelte_svelte_type_style_lang.a7320854.js";function Me(o){let e,t,n,r,i,s;return{c(){e=g("div"),t=g("span"),n=M("Loading..."),r=O(),i=g("div"),this.h()},l(l){e=w(l,"DIV",{class:!0});var a=v(e);t=w(a,"SPAN",{class:!0});var d=v(t);n=j(d,"Loading..."),d.forEach(p),r=L(a),i=w(a,"DIV",{class:!0}),v(i).forEach(p),a.forEach(p),this.h()},h(){h(t,"class","sr-only"),h(i,"class","h-full w-full bg-gray-200 rounded-md dark:bg-gray-400"),h(e,"class","animate-pulse h-full w-full my-2")},m(l,a){T(l,e,a),b(e,t),b(t,n),b(e,r),b(e,i)},p:S,i(l){l&&(s||le(()=>{s=de(e,N,{}),s.start()}))},o:S,d(l){l&&p(e)}}}class je extends B{constructor(e){super(),Q(this,e,null,Me,U,{})}}const Ve=o=>({loaded:o&2}),x=o=>({loaded:o[1]}),Ae=o=>({loaded:o&1}),$=o=>({loaded:o[0]}),Ce=o=>({loaded:o&1}),ee=o=>({loaded:o[0]}),Fe=o=>({loaded:o&1}),te=o=>({loaded:o[0]});function Oe(o){let e;const t=o[4].default,n=V(t,o,o[3],x);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,i){n&&n.m(r,i),e=!0},p(r,i){n&&n.p&&(!e||i&10)&&A(n,t,r,r[3],e?F(t,r[3],i,Ve):C(r[3]),x)},i(r){e||(k(n,r),e=!0)},o(r){D(n,r),e=!1},d(r){n&&n.d(r)}}}function Le(o){let e;const t=o[4].error,n=V(t,o,o[3],$);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,i){n&&n.m(r,i),e=!0},p(r,i){n&&n.p&&(!e||i&9)&&A(n,t,r,r[3],e?F(t,r[3],i,Ae):C(r[3]),$)},i(r){e||(k(n,r),e=!0)},o(r){D(n,r),e=!1},d(r){n&&n.d(r)}}}function qe(o){let e;const t=o[4].skeleton,n=V(t,o,o[3],ee),r=n||Qe();return{c(){r&&r.c()},l(i){r&&r.l(i)},m(i,s){r&&r.m(i,s),e=!0},p(i,s){n&&n.p&&(!e||s&9)&&A(n,t,i,i[3],e?F(t,i[3],s,Ce):C(i[3]),ee)},i(i){e||(k(r,i),e=!0)},o(i){D(r,i),e=!1},d(i){r&&r.d(i)}}}function Be(o){let e;const t=o[4].default,n=V(t,o,o[3],te);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,i){n&&n.m(r,i),e=!0},p(r,i){n&&n.p&&(!e||i&9)&&A(n,t,r,r[3],e?F(t,r[3],i,Fe):C(r[3]),te)},i(r){e||(k(n,r),e=!0)},o(r){D(n,r),e=!1},d(r){n&&n.d(r)}}}function Qe(o){let e,t,n;return t=new je({}),{c(){e=g("div"),me(t.$$.fragment),this.h()},l(r){e=w(r,"DIV",{class:!0});var i=v(e);he(t.$$.fragment,i),i.forEach(p),this.h()},h(){h(e,"class","w-full h-64")},m(r,i){T(r,e,i),pe(t,e,null),n=!0},p:S,i(r){n||(k(t.$$.fragment,r),n=!0)},o(r){D(t.$$.fragment,r),n=!1},d(r){r&&p(e),be(t)}}}function Ue(o){let e,t,n,r;const i=[Be,qe,Le,Oe],s=[];function l(a,d){var c,f;return!a[0]||!((c=a[0])!=null&&c.__isQueryStore)?0:!a[1]||!((f=a[1])!=null&&f.loaded)&&!a[1].error?1:a[1].error?2:3}return e=l(o),t=s[e]=i[e](o),{c(){t.c(),n=q()},l(a){t.l(a),n=q()},m(a,d){s[e].m(a,d),T(a,n,d),r=!0},p(a,[d]){let c=e;e=l(a),e===c?s[e].p(a,d):(ae(),D(s[c],1,1,()=>{s[c]=null}),ue(),t=s[e],t?t.p(a,d):(t=s[e]=i[e](a),t.c()),k(t,1),t.m(n.parentNode,n))},i(a){r||(k(t),r=!0)},o(a){D(t),r=!1},d(a){s[e].d(a),a&&p(n)}}}function ze(o,e,t){let{$$slots:n={},$$scope:r}=e,{data:i}=e,s=()=>{},l;return _e(s),o.$$set=a=>{"data"in a&&t(0,i=a.data),"$$scope"in a&&t(3,r=a.$$scope)},o.$$.update=()=>{o.$$.dirty&5&&i!=null&&i.__isQueryStore&&(i.fetch(),s(),t(2,s=i.subscribe(a=>{t(1,l=a)})))},[i,l,s,r,n]}class dt extends B{constructor(e){super(),Q(this,e,ze,Ue,U,{data:0})}}const _t=Symbol(),mt=Symbol(),ht={}.VITE_BUILD_STRICT==="true";function Ne(o,e){return o<e?-1:o>e?1:o>=e?0:NaN}function*Re(o,e){if(e===void 0)for(let t of o)t!=null&&(t=+t)>=t&&(yield t);else{let t=-1;for(let n of o)(n=e(n,++t,o))!=null&&(n=+n)>=n&&(yield n)}}class Ke{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],s=e+i,l=Math.abs(e)<Math.abs(i)?e-(s-i):i-(s-e);l&&(t[n++]=l),e=s}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t=this._n,n,r,i,s=0;if(t>0){for(s=e[--t];t>0&&(n=s,r=e[--t],s=n+r,i=r-(s-n),!i););t>0&&(i<0&&e[t-1]<0||i>0&&e[t-1]>0)&&(r=i*2,n=s+r,r==n-s&&(s=n))}return s}}function fe(o,e){const t=new Ke;if(e===void 0)for(let n of o)(n=+n)&&t.add(n);else{let n=-1;for(let r of o)(r=+e(r,++n,o))&&t.add(r)}return+t}function R(o,e){let t;if(e===void 0)for(const n of o)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let r of o)(r=e(r,++n,o))!=null&&(t<r||t===void 0&&r>=r)&&(t=r)}return t}function K(o,e){let t;if(e===void 0)for(const n of o)n!=null&&(t>n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let r of o)(r=e(r,++n,o))!=null&&(t>r||t===void 0&&r>=r)&&(t=r)}return t}function ce(o,e,t=0,n=o.length-1,r=Ne){for(;n>t;){if(n-t>600){const a=n-t+1,d=e-t+1,c=Math.log(a),f=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*f*(a-f)/a)*(d-a/2<0?-1:1),_=Math.max(t,Math.floor(e-d*f/a+u)),m=Math.min(n,Math.floor(e+(a-d)*f/a+u));ce(o,e,_,m,r)}const i=o[e];let s=t,l=n;for(I(o,t,e),r(o[n],i)>0&&I(o,t,n);s<l;){for(I(o,s,l),++s,--l;r(o[s],i)<0;)++s;for(;r(o[l],i)>0;)--l}r(o[t],i)===0?I(o,t,l):(++l,I(o,l,n)),l<=e&&(t=l+1),e<=l&&(n=l-1)}return o}function I(o,e,t){const n=o[e];o[e]=o[t],o[t]=n}function Pe(o,e,t){if(o=Float64Array.from(Re(o,t)),!!(n=o.length)){if((e=+e)<=0||n<2)return K(o);if(e>=1)return R(o);var n,r=(n-1)*e,i=Math.floor(r),s=R(ce(o,i).subarray(0,i+1)),l=K(o.subarray(i+1));return s+(l-s)*(r-i)}}function He(o,e){return Pe(o,.5,e)}function ne(o,e){return n=>{e=e??{};const r={},i=Object.keys(o);for(const s of i)r[s]=o[s](n);if(e.rest&&n.length){const s=Object.keys(n[0]);for(const l of s)i.includes(l)||(r[l]=e.rest(l)(n))}return[r]}}function re(){return o=>o.length}function Je(o){const e=typeof o=="function"?o:t=>t[o];return t=>fe(t,e)}function Ge(o,e){let t=0;for(let n=0;n<o.length;++n){const r=e(o[n],n,o);+r===r&&(t+=1)}return t?fe(o,e)/t:void 0}function We(o){const e=typeof o=="function"?o:t=>t[o];return t=>K(t,e)}function Xe(o){const e=typeof o=="function"?o:t=>t[o];return t=>R(t,e)}function Ye(o){const e=typeof o=="function"?o:t=>t[o];return t=>Ge(t,e)}function Ze(o){const e=typeof o=="function"?o:t=>t[o];return t=>He(t,e)}function oe(o,e={}){const t=typeof o=="function"?o:n=>n[o];return n=>{const r=new Map;let i=0;for(const s of n){const l=t(s);if(!r.has(l)){if(!e.includeUndefined&&l===void 0||e.includeNull===!1&&l===null)continue;i+=1,r.set(l,!0)}}return i}}function ie(o,e,t=!0){const n=ge(o,ne(t?{count:re(),countDistinct:oe(e),min:We(e),max:Xe(e),median:Ze(e),mean:Ye(e),sum:Je(e)}:{count:re(),countDistinct:oe(e)}))[0],{maxDecimals:r,unitType:i}=xe(o.map(s=>s[e]));return{min:n.min,max:n.max,median:n.median,mean:n.mean,count:n.count,countDistinct:n.countDistinct,sum:n.sum,maxDecimals:r,unitType:i}}function xe(o){var e;if(o==null||o.length===0)return{maxDecimals:0,unitType:"unknown"};{let t=0;for(const n of o){const r=(e=n==null?void 0:n.toString().split(".")[1])==null?void 0:e.length;r>t&&(t=r)}return{maxDecimals:t,unitType:"number"}}}function $e(o,e){let t=we(o,e),n=["id","gdp"],r=["of","the","and","in","on"];function i(s){return s.replace(/\S*/g,function(l){return!n.includes(l)&&!r.includes(l)?l.charAt(0).toUpperCase()+l.substr(1).toLowerCase():n.includes(l)?l.toUpperCase():l.toLowerCase()})}return t=i(t.replace(/_/g," ")),t}function pt(o,e="object"){const t={},n=De(o);for(const r of Object.keys(o[0])){const i=n.find(d=>{var c;return((c=d.name)==null?void 0:c.toLowerCase())===(r==null?void 0:r.toLowerCase())})??{name:r,evidenceType:Ee.STRING,typeFidelity:Te.INFERRED},s=i.evidenceType;let l=i.evidenceType==="number"?ie(o,r,!0):ie(o,r,!1);i.evidenceType!=="number"&&(l.maxDecimals=0,l.unitType=i.evidenceType);const a=ke(r,i,l);t[r]={title:$e(r,a),type:s,evidenceColumnType:i,format:a,columnUnitSummary:l}}return e!=="object"?Object.entries(t).map(([r,i])=>({id:r,...i})):t}function et(o){let e,t,n;return{c(){e=g("br"),t=g("a"),n=M("View environment variables →"),this.h()},l(r){e=w(r,"BR",{}),t=w(r,"A",{class:!0,href:!0});var i=v(t);n=j(i,"View environment variables →"),i.forEach(p),this.h()},h(){h(t,"class","credentials-link svelte-1no0yro"),h(t,"href","https://docs.evidence.dev/cli/#environment-variables")},m(r,i){T(r,e,i),T(r,t,i),b(t,n)},d(r){r&&p(e),r&&p(t)}}}function tt(o){let e,t,n,r,i,s,l,a;function d(u,_){if(u[0]===nt)return et}let c=d(o),f=c&&c(o);return{c(){e=g("div"),t=g("div"),n=g("div"),r=M(o[1]),i=O(),s=g("div"),l=M(o[0]),a=O(),f&&f.c(),this.h()},l(u){e=w(u,"DIV",{width:!0,class:!0});var _=v(e);t=w(_,"DIV",{class:!0});var m=v(t);n=w(m,"DIV",{class:!0});var y=v(n);r=j(y,o[1]),y.forEach(p),i=L(m),s=w(m,"DIV",{class:!0});var E=v(s);l=j(E,o[0]),a=L(E),f&&f.l(E),E.forEach(p),m.forEach(p),_.forEach(p),this.h()},h(){h(n,"class","font-bold text-center text-lg"),h(s,"class","text-center [word-wrap:break-work] text-xs"),H(s,"w-[7.8em]",o[1].includes("Value")),h(t,"class","m-auto w-full"),h(e,"width","100%"),h(e,"class","grid grid-rows-auto box-content grid-cols-1 justify-center bg-red-50 text-grey-700 font-ui font-normal rounded border border-red-200 min-h-[150px] py-5 px-8 my-5 print:break-inside-avoid")},m(u,_){T(u,e,_),b(e,t),b(t,n),b(n,r),b(t,i),b(t,s),b(s,l),b(s,a),f&&f.m(s,null)},p(u,[_]){_&2&&z(r,u[1]),_&1&&z(l,u[0]),c!==(c=d(u))&&(f&&f.d(1),f=c&&c(u),f&&(f.c(),f.m(s,null))),_&2&&H(s,"w-[7.8em]",u[1].includes("Value"))},i:S,o:S,d(u){u&&p(e),f&&f.d()}}}const nt="SQL Error: Missing database connection; set the EVIDENCE_DATABASE environment variable.";function rt(o,e,t){let{error:n}=e,{chartType:r}=e;return o.$$set=i=>{"error"in i&&t(0,n=i.error),"chartType"in i&&t(1,r=i.chartType)},[n,r]}class bt extends B{constructor(e){super(),Q(this,e,rt,tt,U,{error:0,chartType:1})}}function yt(o,e,t){var i,s,l,a,d;let n=[];if(o===void 0)throw Error("No dataset provided");if(typeof o!="object")throw Error("'"+o+"' is not a recognized query result. Data should be provided in the format: data = {"+o.replace("data.","")+"}");if(o[0]===void 0||o.length===0)throw Error("Dataset is empty: query ran successfully, but no data was returned from the database");if(((s=(i=o[0])==null?void 0:i.error_object)==null?void 0:s.error)!=null)throw Error("SQL Error: "+((d=(a=(l=o[0])==null?void 0:l.error_object)==null?void 0:a.error)==null?void 0:d.message));if(e!=null){if(!(e instanceof Array))throw Error("reqCols must be passed in as an array");for(var r=0;r<e.length;r++)if(e[r]==null)throw Error("Missing required columns");if(o.__isQueryStore||o instanceof Se)for(const f of o.columns)n.push(f.name);else for(const f of Object.keys(o[0]))n.push(f);let c;for(r=0;r<e.length;r++)if(c=e[r],!n.includes(c))throw Error("'"+c+"' is not a column in the dataset");if(t!=null&&t[0]!=null){for(r=0;r<t.length;r++)if(c=t[r],!n.includes(c))throw Error("'"+c+"' is not a column in the dataset")}}}function se(o){let e,t,n,r,i,s,l,a,d,c;const f=o[7].default,u=V(f,o,o[6],null),_=u||ot();return{c(){e=g("div"),t=g("button"),n=g("span"),r=M(o[1]),i=O(),_&&_.c(),this.h()},l(m){e=w(m,"DIV",{});var y=v(e);t=w(y,"BUTTON",{type:!0,"aria-label":!0,class:!0});var E=v(t);n=w(E,"SPAN",{});var P=v(n);r=j(P,o[1]),P.forEach(p),i=L(E),_&&_.l(E),E.forEach(p),y.forEach(p),this.h()},h(){h(t,"type","button"),h(t,"aria-label",o[1]),h(t,"class",s=W(o[4].class)+" svelte-p80uux")},m(m,y){T(m,e,y),b(e,t),b(t,n),b(n,r),b(t,i),_&&_.m(t,null),a=!0,d||(c=ye(t,"click",function(){ve(o[3](o[0]))&&o[3](o[0]).apply(this,arguments)}),d=!0)},p(m,y){o=m,(!a||y&2)&&z(r,o[1]),u&&u.p&&(!a||y&64)&&A(u,f,o,o[6],a?F(f,o[6],y,null):C(o[6]),null),(!a||y&2)&&h(t,"aria-label",o[1]),(!a||y&16&&s!==(s=W(o[4].class)+" svelte-p80uux"))&&h(t,"class",s)},i(m){a||(k(_,m),m&&le(()=>{l||(l=X(e,N,{duration:200},!0)),l.run(1)}),a=!0)},o(m){D(_,m),m&&(l||(l=X(e,N,{duration:200},!1)),l.run(0)),a=!1},d(m){m&&p(e),_&&_.d(m),m&&l&&l.end(),d=!1,c()}}}function ot(o){let e,t;return{c(){e=Y("svg"),t=Y("path"),this.h()},l(n){e=Z(n,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0});var r=v(e);t=Z(r,"path",{d:!0}),v(t).forEach(p),r.forEach(p),this.h()},h(){h(t,"d","M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 9l-5 5-5-5M12 12.8V2.5"),h(e,"width","12"),h(e,"height","12"),h(e,"viewBox","0 0 24 24"),h(e,"fill","none"),h(e,"stroke-width","2"),h(e,"stroke-linecap","round"),h(e,"stroke-linejoin","round")},m(n,r){T(n,e,r),b(e,t)},p:S,d(n){n&&p(e)}}}function it(o){let e,t,n=o[2]&&se(o);return{c(){n&&n.c(),e=q()},l(r){n&&n.l(r),e=q()},m(r,i){n&&n.m(r,i),T(r,e,i),t=!0},p(r,[i]){r[2]?n?(n.p(r,i),i&4&&k(n,1)):(n=se(r),n.c(),k(n,1),n.m(e.parentNode,e)):n&&(ae(),D(n,1,1,()=>{n=null}),ue())},i(r){t||(k(n),t=!0)},o(r){D(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function st(o,e,t){let{$$slots:n={},$$scope:r}=e,{data:i}=e,{queryID:s}=e,{text:l="Download"}=e,{display:a}=e;const d=new Date,c=new Date(d.getTime()-d.getTimezoneOffset()*6e4).toISOString().slice(0,19).replaceAll(":","-");let{downloadData:f=u=>{const _={fieldSeparator:",",quoteStrings:'"',decimalSeparator:".",showLabels:!0,showTitle:!1,filename:(s??"evidence_download")+` ${c}`,useTextFile:!1,useBom:!0,useKeysAsHeaders:!0},m=JSON.parse(JSON.stringify(Array.from(u)));new Ie.ExportToCsv(_).generateCsv(m)}}=e;return o.$$set=u=>{t(4,e=J(J({},e),G(u))),"data"in u&&t(0,i=u.data),"queryID"in u&&t(5,s=u.queryID),"text"in u&&t(1,l=u.text),"display"in u&&t(2,a=u.display),"downloadData"in u&&t(3,f=u.downloadData),"$$scope"in u&&t(6,r=u.$$scope)},e=G(e),[i,l,a,f,e,s,r,n]}class vt extends B{constructor(e){super(),Q(this,e,st,it,U,{data:0,queryID:5,text:1,display:2,downloadData:3})}}export{vt as D,bt as E,dt as Q,ne as a,Je as b,yt as c,_t as d,$e as f,pt as g,oe as n,mt as p,ht as s};
