(function(){"use strict";var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function commonjsRequire(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(()=>{var Uh=Object.create,us=Object.defineProperty,Lh=Object.getOwnPropertyDescriptor,Nh=Object.getOwnPropertyNames,kh=Object.getPrototypeOf,Ch=Object.prototype.hasOwnProperty,sa=(t=>typeof commonjsRequire<"u"?commonjsRequire:typeof Proxy<"u"?new Proxy(t,{get:(e,i)=>(typeof commonjsRequire<"u"?commonjsRequire:e)[i]}):t)(function(t){if(typeof commonjsRequire<"u")return commonjsRequire.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')}),ds=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),dn=(t,e)=>{for(var i in e)us(t,i,{get:e[i],enumerable:!0})},Mc=(t,e,i,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Nh(e))!Ch.call(t,r)&&r!==i&&us(t,r,{get:()=>e[r],enumerable:!(n=Lh(e,r))||n.enumerable});return t},Uc=(t,e,i)=>(i=t!=null?Uh(kh(t)):{},Mc(e||!t||!t.__esModule?us(i,"default",{value:t,enumerable:!0}):i,t)),Ph=t=>Mc(us({},"__esModule",{value:!0}),t),rl=ds((t,e)=>{var i,n,r,s,a,o,u,d,p,v,Z,J,zt,te,Ut,Ne,si,ee,Ve,cn,ui,ci,ai,ut,ce;(function(rt){var Xt=typeof commonjsGlobal=="object"?commonjsGlobal:typeof self=="object"?self:typeof this=="object"?this:{};typeof e=="object"&&typeof e.exports=="object"?rt(Qt(Xt,Qt(e.exports))):rt(Qt(Xt));function Qt(b,_){return b!==Xt&&(typeof Object.create=="function"?Object.defineProperty(b,"__esModule",{value:!0}):b.__esModule=!0),function(m,S){return b[m]=_?_(m,S):S}}})(function(rt){var Xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,_){b.__proto__=_}||function(b,_){for(var m in _)Object.prototype.hasOwnProperty.call(_,m)&&(b[m]=_[m])};i=function(b,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");Xt(b,_);function m(){this.constructor=b}b.prototype=_===null?Object.create(_):(m.prototype=_.prototype,new m)},n=Object.assign||function(b){for(var _,m=1,S=arguments.length;m<S;m++){_=arguments[m];for(var x in _)Object.prototype.hasOwnProperty.call(_,x)&&(b[x]=_[x])}return b},r=function(b,_){var m={};for(var S in b)Object.prototype.hasOwnProperty.call(b,S)&&_.indexOf(S)<0&&(m[S]=b[S]);if(b!=null&&typeof Object.getOwnPropertySymbols=="function")for(var x=0,S=Object.getOwnPropertySymbols(b);x<S.length;x++)_.indexOf(S[x])<0&&Object.prototype.propertyIsEnumerable.call(b,S[x])&&(m[S[x]]=b[S[x]]);return m},s=function(b,_,m,S){var x=arguments.length,E=x<3?_:S===null?S=Object.getOwnPropertyDescriptor(_,m):S,at;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(b,_,m,S);else for(var A=b.length-1;A>=0;A--)(at=b[A])&&(E=(x<3?at(E):x>3?at(_,m,E):at(_,m))||E);return x>3&&E&&Object.defineProperty(_,m,E),E},a=function(b,_){return function(m,S){_(m,S,b)}},o=function(b,_){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(b,_)},u=function(b,_,m,S){function x(E){return E instanceof m?E:new m(function(at){at(E)})}return new(m||(m=Promise))(function(E,at){function A(le){try{lt(S.next(le))}catch(Qi){at(Qi)}}function ae(le){try{lt(S.throw(le))}catch(Qi){at(Qi)}}function lt(le){le.done?E(le.value):x(le.value).then(A,ae)}lt((S=S.apply(b,_||[])).next())})},d=function(b,_){var m={label:0,sent:function(){if(E[0]&1)throw E[1];return E[1]},trys:[],ops:[]},S,x,E,at;return at={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(at[Symbol.iterator]=function(){return this}),at;function A(lt){return function(le){return ae([lt,le])}}function ae(lt){if(S)throw new TypeError("Generator is already executing.");for(;m;)try{if(S=1,x&&(E=lt[0]&2?x.return:lt[0]?x.throw||((E=x.return)&&E.call(x),0):x.next)&&!(E=E.call(x,lt[1])).done)return E;switch(x=0,E&&(lt=[lt[0]&2,E.value]),lt[0]){case 0:case 1:E=lt;break;case 4:return m.label++,{value:lt[1],done:!1};case 5:m.label++,x=lt[1],lt=[0];continue;case 7:lt=m.ops.pop(),m.trys.pop();continue;default:if(E=m.trys,!(E=E.length>0&&E[E.length-1])&&(lt[0]===6||lt[0]===2)){m=0;continue}if(lt[0]===3&&(!E||lt[1]>E[0]&&lt[1]<E[3])){m.label=lt[1];break}if(lt[0]===6&&m.label<E[1]){m.label=E[1],E=lt;break}if(E&&m.label<E[2]){m.label=E[2],m.ops.push(lt);break}E[2]&&m.ops.pop(),m.trys.pop();continue}lt=_.call(b,m)}catch(le){lt=[6,le],x=0}finally{S=E=0}if(lt[0]&5)throw lt[1];return{value:lt[0]?lt[1]:void 0,done:!0}}},p=function(b,_){for(var m in b)m!=="default"&&!Object.prototype.hasOwnProperty.call(_,m)&&ce(_,b,m)},ce=Object.create?function(b,_,m,S){S===void 0&&(S=m);var x=Object.getOwnPropertyDescriptor(_,m);(!x||("get"in x?!_.__esModule:x.writable||x.configurable))&&(x={enumerable:!0,get:function(){return _[m]}}),Object.defineProperty(b,S,x)}:function(b,_,m,S){S===void 0&&(S=m),b[S]=_[m]},v=function(b){var _=typeof Symbol=="function"&&Symbol.iterator,m=_&&b[_],S=0;if(m)return m.call(b);if(b&&typeof b.length=="number")return{next:function(){return b&&S>=b.length&&(b=void 0),{value:b&&b[S++],done:!b}}};throw new TypeError(_?"Object is not iterable.":"Symbol.iterator is not defined.")},Z=function(b,_){var m=typeof Symbol=="function"&&b[Symbol.iterator];if(!m)return b;var S=m.call(b),x,E=[],at;try{for(;(_===void 0||_-- >0)&&!(x=S.next()).done;)E.push(x.value)}catch(A){at={error:A}}finally{try{x&&!x.done&&(m=S.return)&&m.call(S)}finally{if(at)throw at.error}}return E},J=function(){for(var b=[],_=0;_<arguments.length;_++)b=b.concat(Z(arguments[_]));return b},zt=function(){for(var b=0,_=0,m=arguments.length;_<m;_++)b+=arguments[_].length;for(var S=Array(b),x=0,_=0;_<m;_++)for(var E=arguments[_],at=0,A=E.length;at<A;at++,x++)S[x]=E[at];return S},te=function(b,_,m){if(m||arguments.length===2)for(var S=0,x=_.length,E;S<x;S++)(E||!(S in _))&&(E||(E=Array.prototype.slice.call(_,0,S)),E[S]=_[S]);return b.concat(E||Array.prototype.slice.call(_))},Ut=function(b){return this instanceof Ut?(this.v=b,this):new Ut(b)},Ne=function(b,_,m){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var S=m.apply(b,_||[]),x,E=[];return x={},at("next"),at("throw"),at("return"),x[Symbol.asyncIterator]=function(){return this},x;function at(oe){S[oe]&&(x[oe]=function(ln){return new Promise(function(sr,fs){E.push([oe,ln,sr,fs])>1||A(oe,ln)})})}function A(oe,ln){try{ae(S[oe](ln))}catch(sr){Qi(E[0][3],sr)}}function ae(oe){oe.value instanceof Ut?Promise.resolve(oe.value.v).then(lt,le):Qi(E[0][2],oe)}function lt(oe){A("next",oe)}function le(oe){A("throw",oe)}function Qi(oe,ln){oe(ln),E.shift(),E.length&&A(E[0][0],E[0][1])}},si=function(b){var _,m;return _={},S("next"),S("throw",function(x){throw x}),S("return"),_[Symbol.iterator]=function(){return this},_;function S(x,E){_[x]=b[x]?function(at){return(m=!m)?{value:Ut(b[x](at)),done:x==="return"}:E?E(at):at}:E}},ee=function(b){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=b[Symbol.asyncIterator],m;return _?_.call(b):(b=typeof v=="function"?v(b):b[Symbol.iterator](),m={},S("next"),S("throw"),S("return"),m[Symbol.asyncIterator]=function(){return this},m);function S(E){m[E]=b[E]&&function(at){return new Promise(function(A,ae){at=b[E](at),x(A,ae,at.done,at.value)})}}function x(E,at,A,ae){Promise.resolve(ae).then(function(lt){E({value:lt,done:A})},at)}},Ve=function(b,_){return Object.defineProperty?Object.defineProperty(b,"raw",{value:_}):b.raw=_,b};var Qt=Object.create?function(b,_){Object.defineProperty(b,"default",{enumerable:!0,value:_})}:function(b,_){b.default=_};cn=function(b){if(b&&b.__esModule)return b;var _={};if(b!=null)for(var m in b)m!=="default"&&Object.prototype.hasOwnProperty.call(b,m)&&ce(_,b,m);return Qt(_,b),_},ui=function(b){return b&&b.__esModule?b:{default:b}},ci=function(b,_,m,S){if(m==="a"&&!S)throw new TypeError("Private accessor was defined without a getter");if(typeof _=="function"?b!==_||!S:!_.has(b))throw new TypeError("Cannot read private member from an object whose class did not declare it");return m==="m"?S:m==="a"?S.call(b):S?S.value:_.get(b)},ai=function(b,_,m,S,x){if(S==="m")throw new TypeError("Private method is not writable");if(S==="a"&&!x)throw new TypeError("Private accessor was defined without a setter");if(typeof _=="function"?b!==_||!x:!_.has(b))throw new TypeError("Cannot write private member to an object whose class did not declare it");return S==="a"?x.call(b,m):x?x.value=m:_.set(b,m),m},ut=function(b,_){if(_===null||typeof _!="object"&&typeof _!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof b=="function"?_===b:b.has(_)},rt("__extends",i),rt("__assign",n),rt("__rest",r),rt("__decorate",s),rt("__param",a),rt("__metadata",o),rt("__awaiter",u),rt("__generator",d),rt("__exportStar",p),rt("__createBinding",ce),rt("__values",v),rt("__read",Z),rt("__spread",J),rt("__spreadArrays",zt),rt("__spreadArray",te),rt("__await",Ut),rt("__asyncGenerator",Ne),rt("__asyncDelegator",si),rt("__asyncValues",ee),rt("__makeTemplateObject",Ve),rt("__importStar",cn),rt("__importDefault",ui),rt("__classPrivateFieldGet",ci),rt("__classPrivateFieldSet",ai),rt("__classPrivateFieldIn",ut)})}),ic=ds(()=>{}),zu=ds(()=>{}),Ku=ds((exports,module)=>{(function(){var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&typeof module=="object"&&module.exports,AMD=!1,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(t){return typeof t=="object"&&t.buffer&&t.buffer.constructor===ArrayBuffer});var createOutputMethod=function(t,e){return function(i){return new Sha256(e,!0).update(i)[t]()}},createMethod=function(t){var e=createOutputMethod("hex",t);NODE_JS&&(e=nodeWrap(e,t)),e.create=function(){return new Sha256(t)},e.update=function(r){return e.create().update(r)};for(var i=0;i<OUTPUT_TYPES.length;++i){var n=OUTPUT_TYPES[i];e[n]=createOutputMethod(n,t)}return e},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(t){if(typeof t=="string")return crypto.createHash(algorithm).update(t,"utf8").digest("hex");if(t==null)throw new Error(ERROR);return t.constructor===ArrayBuffer&&(t=new Uint8Array(t)),Array.isArray(t)||ArrayBuffer.isView(t)||t.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(t)).digest("hex"):method(t)};return nodeMethod},createHmacOutputMethod=function(t,e){return function(i,n){return new HmacSha256(i,e,!0).update(n)[t]()}},createHmacMethod=function(t){var e=createHmacOutputMethod("hex",t);e.create=function(r){return new HmacSha256(r,t)},e.update=function(r,s){return e.create(r).update(s)};for(var i=0;i<OUTPUT_TYPES.length;++i){var n=OUTPUT_TYPES[i];e[n]=createHmacOutputMethod(n,t)}return e};function Sha256(t,e){e?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=t}Sha256.prototype.update=function(t){if(!this.finalized){var e,i=typeof t;if(i!=="string"){if(i==="object"){if(t===null)throw new Error(ERROR);if(ARRAY_BUFFER&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(t)))throw new Error(ERROR)}else throw new Error(ERROR);e=!0}for(var n,r=0,s,a=t.length,o=this.blocks;r<a;){if(this.hashed&&(this.hashed=!1,o[0]=this.block,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),e)for(s=this.start;r<a&&s<64;++r)o[s>>2]|=t[r]<<SHIFT[s++&3];else for(s=this.start;r<a&&s<64;++r)n=t.charCodeAt(r),n<128?o[s>>2]|=n<<SHIFT[s++&3]:n<2048?(o[s>>2]|=(192|n>>6)<<SHIFT[s++&3],o[s>>2]|=(128|n&63)<<SHIFT[s++&3]):n<55296||n>=57344?(o[s>>2]|=(224|n>>12)<<SHIFT[s++&3],o[s>>2]|=(128|n>>6&63)<<SHIFT[s++&3],o[s>>2]|=(128|n&63)<<SHIFT[s++&3]):(n=65536+((n&1023)<<10|t.charCodeAt(++r)&1023),o[s>>2]|=(240|n>>18)<<SHIFT[s++&3],o[s>>2]|=(128|n>>12&63)<<SHIFT[s++&3],o[s>>2]|=(128|n>>6&63)<<SHIFT[s++&3],o[s>>2]|=(128|n&63)<<SHIFT[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=o[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=EXTRA[e&3],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var t=this.h0,e=this.h1,i=this.h2,n=this.h3,r=this.h4,s=this.h5,a=this.h6,o=this.h7,u=this.blocks,d,p,v,Z,J,zt,te,Ut,Ne,si,ee;for(d=16;d<64;++d)J=u[d-15],p=(J>>>7|J<<25)^(J>>>18|J<<14)^J>>>3,J=u[d-2],v=(J>>>17|J<<15)^(J>>>19|J<<13)^J>>>10,u[d]=u[d-16]+p+u[d-7]+v<<0;for(ee=e&i,d=0;d<64;d+=4)this.first?(this.is224?(Ut=300032,J=u[0]-1413257819,o=J-150054599<<0,n=J+24177077<<0):(Ut=704751109,J=u[0]-210244248,o=J-1521486534<<0,n=J+143694565<<0),this.first=!1):(p=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),v=(r>>>6|r<<26)^(r>>>11|r<<21)^(r>>>25|r<<7),Ut=t&e,Z=Ut^t&i^ee,te=r&s^~r&a,J=o+v+te+K[d]+u[d],zt=p+Z,o=n+J<<0,n=J+zt<<0),p=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),v=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),Ne=n&t,Z=Ne^n&e^Ut,te=o&r^~o&s,J=a+v+te+K[d+1]+u[d+1],zt=p+Z,a=i+J<<0,i=J+zt<<0,p=(i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10),v=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7),si=i&n,Z=si^i&t^Ne,te=a&o^~a&r,J=s+v+te+K[d+2]+u[d+2],zt=p+Z,s=e+J<<0,e=J+zt<<0,p=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),v=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),ee=e&i,Z=ee^e&n^si,te=s&a^~s&o,J=r+v+te+K[d+3]+u[d+3],zt=p+Z,r=t+J<<0,t=J+zt<<0;this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+i<<0,this.h3=this.h3+n<<0,this.h4=this.h4+r<<0,this.h5=this.h5+s<<0,this.h6=this.h6+a<<0,this.h7=this.h7+o<<0},Sha256.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,i=this.h2,n=this.h3,r=this.h4,s=this.h5,a=this.h6,o=this.h7,u=HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[r&15]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15];return this.is224||(u+=HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15]),u},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,i=this.h2,n=this.h3,r=this.h4,s=this.h5,a=this.h6,o=this.h7,u=[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24&255,i>>16&255,i>>8&255,i&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,s>>24&255,s>>16&255,s>>8&255,s&255,a>>24&255,a>>16&255,a>>8&255,a&255];return this.is224||u.push(o>>24&255,o>>16&255,o>>8&255,o&255),u},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(this.is224?28:32),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),e.setUint32(20,this.h5),e.setUint32(24,this.h6),this.is224||e.setUint32(28,this.h7),t};function HmacSha256(t,e,i){var n,r=typeof t;if(r==="string"){var s=[],a=t.length,o=0,u;for(n=0;n<a;++n)u=t.charCodeAt(n),u<128?s[o++]=u:u<2048?(s[o++]=192|u>>6,s[o++]=128|u&63):u<55296||u>=57344?(s[o++]=224|u>>12,s[o++]=128|u>>6&63,s[o++]=128|u&63):(u=65536+((u&1023)<<10|t.charCodeAt(++n)&1023),s[o++]=240|u>>18,s[o++]=128|u>>12&63,s[o++]=128|u>>6&63,s[o++]=128|u&63);t=s}else if(r==="object"){if(t===null)throw new Error(ERROR);if(ARRAY_BUFFER&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(t)))throw new Error(ERROR)}else throw new Error(ERROR);t.length>64&&(t=new Sha256(e,!0).update(t).array());var d=[],p=[];for(n=0;n<64;++n){var v=t[n]||0;d[n]=92^v,p[n]=54^v}Sha256.call(this,e,i),this.update(p),this.oKeyPad=d,this.inner=!0,this.sharedMemory=i}HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var t=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(t),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()}),O_={};dn(O_,{registerWorker:()=>Qu});var nl=Uc(rl(),1),{__extends:N_,__assign:k_,__rest:il,__decorate:C_,__param:P_,__metadata:H_,__awaiter:I,__generator:V_,__exportStar:z_,__createBinding:j_,__values:W_,__read:$_,__spread:Y_,__spreadArrays:X_,__spreadArray:G_,__await:W,__asyncGenerator:ue,__asyncDelegator:On,__asyncValues:Ee,__makeTemplateObject:K_,__importStar:J_,__importDefault:q_,__classPrivateFieldGet:Z_,__classPrivateFieldSet:Q_,__classPrivateFieldIn:ty}=nl.default,fa={};dn(fa,{compareArrayLike:()=>da,joinUint8Arrays:()=>Ie,memcpy:()=>Rn,rebaseValueOffsets:()=>hi,toArrayBufferView:()=>$,toArrayBufferViewAsyncIterator:()=>We,toArrayBufferViewIterator:()=>or,toBigInt64Array:()=>Yh,toBigUint64Array:()=>Kh,toFloat32Array:()=>Jh,toFloat32ArrayAsyncIterator:()=>fp,toFloat32ArrayIterator:()=>ip,toFloat64Array:()=>qh,toFloat64ArrayAsyncIterator:()=>hp,toFloat64ArrayIterator:()=>sp,toInt16Array:()=>$h,toInt16ArrayAsyncIterator:()=>cp,toInt16ArrayIterator:()=>tp,toInt32Array:()=>fn,toInt32ArrayAsyncIterator:()=>lp,toInt32ArrayIterator:()=>ep,toInt8Array:()=>Wh,toInt8ArrayAsyncIterator:()=>ap,toInt8ArrayIterator:()=>Qh,toUint16Array:()=>Xh,toUint16ArrayAsyncIterator:()=>up,toUint16ArrayIterator:()=>rp,toUint32Array:()=>Gh,toUint32ArrayAsyncIterator:()=>dp,toUint32ArrayIterator:()=>np,toUint8Array:()=>L,toUint8ArrayAsyncIterator:()=>ua,toUint8ArrayIterator:()=>la,toUint8ClampedArray:()=>Zh,toUint8ClampedArrayAsyncIterator:()=>pp,toUint8ClampedArrayIterator:()=>op});var Hh=new TextDecoder("utf-8"),di=t=>Hh.decode(t),Vh=new TextEncoder,Yr=t=>Vh.encode(t),[ny,ms]=(()=>{let t=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw t()}return e.asIntN=()=>{throw t()},e.asUintN=()=>{throw t()},typeof BigInt<"u"?[BigInt,!0]:[e,!1]})(),[Oe,iy]=(()=>{let t=()=>{throw new Error("BigInt64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[e,!1]})(),[Re,sy]=(()=>{let t=()=>{throw new Error("BigUint64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[e,!1]})(),zh=t=>typeof t=="number",sl=t=>typeof t=="boolean",Mt=t=>typeof t=="function",re=t=>t!=null&&Object(t)===t,ze=t=>re(t)&&Mt(t.then),je=t=>re(t)&&Mt(t[Symbol.iterator]),Me=t=>re(t)&&Mt(t[Symbol.asyncIterator]),_s=t=>re(t)&&re(t.schema),ys=t=>re(t)&&"done"in t&&"value"in t,bs=t=>re(t)&&Mt(t.stat)&&zh(t.fd),gs=t=>re(t)&&fi(t.body),ws=t=>"_getDOMStream"in t&&"_getNodeStream"in t,ol=t=>re(t)&&Mt(t.abort)&&Mt(t.getWriter)&&!ws(t),fi=t=>re(t)&&Mt(t.cancel)&&Mt(t.getReader)&&!ws(t),al=t=>re(t)&&Mt(t.end)&&Mt(t.write)&&sl(t.writable)&&!ws(t),vs=t=>re(t)&&Mt(t.read)&&Mt(t.pipe)&&sl(t.readable)&&!ws(t),cl=t=>re(t)&&Mt(t.clear)&&Mt(t.bytes)&&Mt(t.position)&&Mt(t.setPosition)&&Mt(t.capacity)&&Mt(t.getBufferIdentifier)&&Mt(t.createLong),ca=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function jh(t){let e=t[0]?[t[0]]:[],i,n,r,s;for(let a,o,u=0,d=0,p=t.length;++u<p;){if(a=e[d],o=t[u],!a||!o||a.buffer!==o.buffer||o.byteOffset<a.byteOffset){o&&(e[++d]=o);continue}if({byteOffset:i,byteLength:r}=a,{byteOffset:n,byteLength:s}=o,i+r<n||n+s<i){o&&(e[++d]=o);continue}e[d]=new Uint8Array(a.buffer,i,n-i+s)}return e}function Rn(t,e,i=0,n=e.byteLength){let r=t.byteLength,s=new Uint8Array(t.buffer,t.byteOffset,r),a=new Uint8Array(e.buffer,e.byteOffset,Math.min(n,r));return s.set(a,i),t}function Ie(t,e){let i=jh(t),n=i.reduce((p,v)=>p+v.byteLength,0),r,s,a,o=0,u=-1,d=Math.min(e||Number.POSITIVE_INFINITY,n);for(let p=i.length;++u<p;){if(r=i[u],s=r.subarray(0,Math.min(r.length,d-o)),d<=o+s.length){s.length<r.length?i[u]=r.subarray(s.length):s.length===r.length&&u++,a?Rn(a,s,o):a=s;break}Rn(a||(a=new Uint8Array(d)),s,o),o+=s.length}return[a||new Uint8Array(0),i.slice(u),n-(a?a.byteLength:0)]}function $(t,e){let i=ys(e)?e.value:e;return i instanceof t?t===Uint8Array?new t(i.buffer,i.byteOffset,i.byteLength):i:i?(typeof i=="string"&&(i=Yr(i)),i instanceof ArrayBuffer?new t(i):i instanceof ca?new t(i):cl(i)?$(t,i.bytes()):ArrayBuffer.isView(i)?i.byteLength<=0?new t(0):new t(i.buffer,i.byteOffset,i.byteLength/t.BYTES_PER_ELEMENT):t.from(i)):new t(0)}var Wh=t=>$(Int8Array,t),$h=t=>$(Int16Array,t),fn=t=>$(Int32Array,t),Yh=t=>$(Oe,t),L=t=>$(Uint8Array,t),Xh=t=>$(Uint16Array,t),Gh=t=>$(Uint32Array,t),Kh=t=>$(Re,t),Jh=t=>$(Float32Array,t),qh=t=>$(Float64Array,t),Zh=t=>$(Uint8ClampedArray,t),aa=t=>(t.next(),t);function*or(t,e){let i=function*(r){yield r},n=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof ca?i(e):je(e)?e:i(e);return yield*aa(function*(r){let s=null;do s=r.next(yield $(t,s));while(!s.done)}(n[Symbol.iterator]())),new t}var Qh=t=>or(Int8Array,t),tp=t=>or(Int16Array,t),ep=t=>or(Int32Array,t),la=t=>or(Uint8Array,t),rp=t=>or(Uint16Array,t),np=t=>or(Uint32Array,t),ip=t=>or(Float32Array,t),sp=t=>or(Float64Array,t),op=t=>or(Uint8ClampedArray,t);function We(t,e){return ue(this,arguments,function*(){if(ze(e))return yield W(yield W(yield*On(Ee(We(t,yield W(e))))));let i=function(s){return ue(this,arguments,function*(){yield yield W(yield W(s))})},n=function(s){return ue(this,arguments,function*(){yield W(yield*On(Ee(aa(function*(a){let o=null;do o=a.next(yield o==null?void 0:o.value);while(!o.done)}(s[Symbol.iterator]())))))})},r=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof ca?i(e):je(e)?n(e):Me(e)?e:i(e);return yield W(yield*On(Ee(aa(function(s){return ue(this,arguments,function*(){let a=null;do a=yield W(s.next(yield yield W($(t,a))));while(!a.done)})}(r[Symbol.asyncIterator]()))))),yield W(new t)})}var ap=t=>We(Int8Array,t),cp=t=>We(Int16Array,t),lp=t=>We(Int32Array,t),ua=t=>We(Uint8Array,t),up=t=>We(Uint16Array,t),dp=t=>We(Uint32Array,t),fp=t=>We(Float32Array,t),hp=t=>We(Float64Array,t),pp=t=>We(Uint8ClampedArray,t);function hi(t,e,i){if(t!==0){i=i.slice(0,e+1);for(let n=-1;++n<=e;)i[n]+=t}return i}function da(t,e){let i=0,n=t.length;if(n!==e.length)return!1;if(n>0)do if(t[i]!==e[i])return!1;while(++i<n);return!0}var jt={fromIterable(t){return Ss(mp(t))},fromAsyncIterable(t){return Ss(_p(t))},fromDOMStream(t){return Ss(yp(t))},fromNodeStream(t){return Ss(bp(t))},toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}},Ss=t=>(t.next(),t);function*mp(t){let e,i=!1,n=[],r,s,a,o=0;function u(){return s==="peek"?Ie(n,a)[0]:([r,n,o]=Ie(n,a),r)}({cmd:s,size:a}=yield null);let d=la(t)[Symbol.iterator]();try{do if({done:e,value:r}=Number.isNaN(a-o)?d.next():d.next(a-o),!e&&r.byteLength>0&&(n.push(r),o+=r.byteLength),e||a<=o)do({cmd:s,size:a}=yield u());while(a<o);while(!e)}catch(p){(i=!0)&&typeof d.throw=="function"&&d.throw(p)}finally{i===!1&&typeof d.return=="function"&&d.return(null)}return null}function _p(t){return ue(this,arguments,function*(){let e,i=!1,n=[],r,s,a,o=0;function u(){return s==="peek"?Ie(n,a)[0]:([r,n,o]=Ie(n,a),r)}({cmd:s,size:a}=yield yield W(null));let d=ua(t)[Symbol.asyncIterator]();try{do if({done:e,value:r}=Number.isNaN(a-o)?yield W(d.next()):yield W(d.next(a-o)),!e&&r.byteLength>0&&(n.push(r),o+=r.byteLength),e||a<=o)do({cmd:s,size:a}=yield yield W(u()));while(a<o);while(!e)}catch(p){(i=!0)&&typeof d.throw=="function"&&(yield W(d.throw(p)))}finally{i===!1&&typeof d.return=="function"&&(yield W(d.return(new Uint8Array(0))))}return yield W(null)})}function yp(t){return ue(this,arguments,function*(){let e=!1,i=!1,n=[],r,s,a,o=0;function u(){return s==="peek"?Ie(n,a)[0]:([r,n,o]=Ie(n,a),r)}({cmd:s,size:a}=yield yield W(null));let d=new pa(t);try{do if({done:e,value:r}=Number.isNaN(a-o)?yield W(d.read()):yield W(d.read(a-o)),!e&&r.byteLength>0&&(n.push(L(r)),o+=r.byteLength),e||a<=o)do({cmd:s,size:a}=yield yield W(u()));while(a<o);while(!e)}catch(p){(i=!0)&&(yield W(d.cancel(p)))}finally{i===!1?yield W(d.cancel()):t.locked&&d.releaseLock()}return yield W(null)})}var pa=class{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return I(this,void 0,void 0,function*(){let{reader:e,source:i}=this;e&&(yield e.cancel(t).catch(()=>{})),i&&i.locked&&this.releaseLock()})}read(t){return I(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};let e=yield this.reader.read();return!e.done&&(e.value=L(e)),e})}},ha=(t,e)=>{let i=r=>n([e,r]),n;return[e,i,new Promise(r=>(n=r)&&t.once(e,i))]};function bp(t){return ue(this,arguments,function*(){let e=[],i="error",n=!1,r=null,s,a,o=0,u=[],d;function p(){return s==="peek"?Ie(u,a)[0]:([d,u,o]=Ie(u,a),d)}if({cmd:s,size:a}=yield yield W(null),t.isTTY)return yield yield W(new Uint8Array(0)),yield W(null);try{e[0]=ha(t,"end"),e[1]=ha(t,"error");do{if(e[2]=ha(t,"readable"),[i,r]=yield W(Promise.race(e.map(Z=>Z[2]))),i==="error")break;if((n=i==="end")||(Number.isFinite(a-o)?(d=L(t.read(a-o)),d.byteLength<a-o&&(d=L(t.read()))):d=L(t.read()),d.byteLength>0&&(u.push(d),o+=d.byteLength)),n||a<=o)do({cmd:s,size:a}=yield yield W(p()));while(a<o)}while(!n)}finally{yield W(v(e,i==="error"?r:null))}return yield W(null);function v(Z,J){return d=u=null,new Promise((zt,te)=>{for(let[Ut,Ne]of Z)t.off(Ut,Ne);try{let Ut=t.destroy;Ut&&Ut.call(t,J),J=void 0}catch(Ut){J=Ut||J}finally{J!=null?te(J):zt()}})}})}var Lt;(function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"})(Lt||(Lt={}));var vt;(function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"})(vt||(vt={}));var yt;(function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"})(yt||(yt={}));var Wt;(function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"})(Wt||(Wt={}));var X;(function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"})(X||(X={}));var ne;(function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(ne||(ne={}));var tt;(function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"})(tt||(tt={}));var f;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"})(f||(f={}));var Ue;(function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"})(Ue||(Ue={}));var Oa={};dn(Oa,{clampIndex:()=>lm,clampRange:()=>_i,createElementComparator:()=>Jr});var gp=void 0;function $e(t){if(t===null)return"null";if(t===gp)return"undefined";switch(typeof t){case"number":return`${t}`;case"bigint":return`${t}`;case"string":return`"${t}"`}return typeof t[Symbol.toPrimitive]=="function"?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof Oe||t instanceof Re?`[${[...t].map(e=>$e(e))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,(e,i)=>typeof i=="bigint"?`${i}`:i)}var _a={};dn(_a,{BN:()=>hn,bignumToBigInt:()=>Is,bignumToString:()=>Xr,isArrowBigNumSymbol:()=>ll});var ll=Symbol.for("isArrowBigNum");function Ye(t,...e){return e.length===0?Object.setPrototypeOf($(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}Ye.prototype[ll]=!0,Ye.prototype.toJSON=function(){return`"${Xr(this)}"`},Ye.prototype.valueOf=function(){return ul(this)},Ye.prototype.toString=function(){return Xr(this)},Ye.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return ul(this);case"string":return Xr(this);case"default":return Is(this)}return Xr(this)};function Mn(...t){return Ye.apply(this,t)}function Un(...t){return Ye.apply(this,t)}function pi(...t){return Ye.apply(this,t)}Object.setPrototypeOf(Mn.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(Un.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(pi.prototype,Object.create(Uint32Array.prototype)),Object.assign(Mn.prototype,Ye.prototype,{constructor:Mn,signed:!0,TypedArray:Int32Array,BigIntArray:Oe}),Object.assign(Un.prototype,Ye.prototype,{constructor:Un,signed:!1,TypedArray:Uint32Array,BigIntArray:Re}),Object.assign(pi.prototype,Ye.prototype,{constructor:pi,signed:!0,TypedArray:Uint32Array,BigIntArray:Re});function ul(t){let{buffer:e,byteOffset:i,length:n,signed:r}=t,s=new Re(e,i,n),a=r&&s[s.length-1]&BigInt(1)<<BigInt(63),o=BigInt(a?1:0),u=BigInt(0);if(a){for(let d of s)o+=~d*(BigInt(1)<<BigInt(32)*u++);o*=BigInt(-1)}else for(let d of s)o+=d*(BigInt(1)<<BigInt(32)*u++);return o}var Xr,Is;ms?(Is=t=>t.byteLength===8?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:ma(t),Xr=t=>t.byteLength===8?`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`:ma(t)):(Xr=ma,Is=Xr);function ma(t){let e="",i=new Uint32Array(2),n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),r=new Uint32Array((n=new Uint16Array(n).reverse()).buffer),s=-1,a=n.length-1;do{for(i[0]=n[s=0];s<a;)n[s++]=i[1]=i[0]/10,i[0]=(i[0]-i[1]*10<<16)+n[s];n[s]=i[1]=i[0]/10,i[0]=i[0]-i[1]*10,e=`${i[0]}${e}`}while(r[0]||r[1]||r[2]||r[3]);return e??"0"}var hn=class{static new(t,e){switch(e){case!0:return new Mn(t);case!1:return new Un(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case Oe:return new Mn(t)}return t.byteLength===16?new pi(t):new Un(t)}static signed(t){return new Mn(t)}static unsigned(t){return new Un(t)}static decimal(t){return new pi(t)}constructor(t,e){return hn.new(t,e)}},dl,fl,hl,pl,ml,_l,yl,bl,gl,wl,vl,Sl,Il,Fl,Al,xl,Bl,Tl,Dl,B=class{static isNull(t){return(t==null?void 0:t.typeId)===f.Null}static isInt(t){return(t==null?void 0:t.typeId)===f.Int}static isFloat(t){return(t==null?void 0:t.typeId)===f.Float}static isBinary(t){return(t==null?void 0:t.typeId)===f.Binary}static isUtf8(t){return(t==null?void 0:t.typeId)===f.Utf8}static isBool(t){return(t==null?void 0:t.typeId)===f.Bool}static isDecimal(t){return(t==null?void 0:t.typeId)===f.Decimal}static isDate(t){return(t==null?void 0:t.typeId)===f.Date}static isTime(t){return(t==null?void 0:t.typeId)===f.Time}static isTimestamp(t){return(t==null?void 0:t.typeId)===f.Timestamp}static isInterval(t){return(t==null?void 0:t.typeId)===f.Interval}static isList(t){return(t==null?void 0:t.typeId)===f.List}static isStruct(t){return(t==null?void 0:t.typeId)===f.Struct}static isUnion(t){return(t==null?void 0:t.typeId)===f.Union}static isFixedSizeBinary(t){return(t==null?void 0:t.typeId)===f.FixedSizeBinary}static isFixedSizeList(t){return(t==null?void 0:t.typeId)===f.FixedSizeList}static isMap(t){return(t==null?void 0:t.typeId)===f.Map}static isDictionary(t){return(t==null?void 0:t.typeId)===f.Dictionary}static isDenseUnion(t){return B.isUnion(t)&&t.mode===vt.Dense}static isSparseUnion(t){return B.isUnion(t)&&t.mode===vt.Sparse}get typeId(){return f.NONE}};dl=Symbol.toStringTag,B[dl]=(t=>(t.children=null,t.ArrayType=Array,t[Symbol.toStringTag]="DataType"))(B.prototype);var ie=class extends B{toString(){return"Null"}get typeId(){return f.Null}};fl=Symbol.toStringTag,ie[fl]=(t=>t[Symbol.toStringTag]="Null")(ie.prototype);var xt=class extends B{constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return f.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?Oe:Re}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};hl=Symbol.toStringTag,xt[hl]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(xt.prototype);var ar=class extends xt{constructor(){super(!0,32)}get ArrayType(){return Int32Array}};Object.defineProperty(ar.prototype,"ArrayType",{value:Int32Array});var de=class extends B{constructor(t){super(),this.precision=t}get typeId(){return f.Float}get ArrayType(){switch(this.precision){case yt.HALF:return Uint16Array;case yt.SINGLE:return Float32Array;case yt.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};pl=Symbol.toStringTag,de[pl]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(de.prototype);var Ar=class extends B{constructor(){super()}get typeId(){return f.Binary}toString(){return"Binary"}};ml=Symbol.toStringTag,Ar[ml]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(Ar.prototype);var xr=class extends B{constructor(){super()}get typeId(){return f.Utf8}toString(){return"Utf8"}};_l=Symbol.toStringTag,xr[_l]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(xr.prototype);var Br=class extends B{constructor(){super()}get typeId(){return f.Bool}toString(){return"Bool"}};yl=Symbol.toStringTag,Br[yl]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(Br.prototype);var Tr=class extends B{constructor(t,e,i=128){super(),this.scale=t,this.precision=e,this.bitWidth=i}get typeId(){return f.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};bl=Symbol.toStringTag,Tr[bl]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Tr.prototype);var Dr=class extends B{constructor(t){super(),this.unit=t}get typeId(){return f.Date}toString(){return`Date${(this.unit+1)*32}<${Wt[this.unit]}>`}};gl=Symbol.toStringTag,Dr[gl]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Dr.prototype);var Xe=class extends B{constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return f.Time}toString(){return`Time${this.bitWidth}<${X[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return Oe}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}};wl=Symbol.toStringTag,Xe[wl]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(Xe.prototype);var Er=class extends B{constructor(t,e){super(),this.unit=t,this.timezone=e}get typeId(){return f.Timestamp}toString(){return`Timestamp<${X[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};vl=Symbol.toStringTag,Er[vl]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(Er.prototype);var Or=class extends B{constructor(t){super(),this.unit=t}get typeId(){return f.Interval}toString(){return`Interval<${ne[this.unit]}>`}};Sl=Symbol.toStringTag,Or[Sl]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Or.prototype);var Ge=class extends B{constructor(t){super(),this.children=[t]}get typeId(){return f.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};Il=Symbol.toStringTag,Ge[Il]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(Ge.prototype);var ht=class extends B{constructor(t){super(),this.children=t}get typeId(){return f.Struct}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};Fl=Symbol.toStringTag,ht[Fl]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(ht.prototype);var Ke=class extends B{constructor(t,e,i){super(),this.mode=t,this.children=i,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce((n,r,s)=>(n[r]=s)&&n||n,Object.create(null))}get typeId(){return f.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}};Al=Symbol.toStringTag,Ke[Al]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(Ke.prototype);var Rr=class extends B{constructor(t){super(),this.byteWidth=t}get typeId(){return f.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};xl=Symbol.toStringTag,Rr[xl]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(Rr.prototype);var Je=class extends B{constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return f.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};Bl=Symbol.toStringTag,Je[Bl]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(Je.prototype);var qe=class extends B{constructor(t,e=!1){super(),this.children=[t],this.keysSorted=e}get typeId(){return f.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};Tl=Symbol.toStringTag,qe[Tl]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(qe.prototype);var wp=(t=>()=>++t)(-1),Fe=class extends B{constructor(t,e,i,n){super(),this.indices=e,this.dictionary=t,this.isOrdered=n||!1,this.id=i==null?wp():typeof i=="number"?i:i.low}get typeId(){return f.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};Dl=Symbol.toStringTag,Fe[Dl]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(Fe.prototype);function Ae(t){let e=t;switch(t.typeId){case f.Decimal:return t.bitWidth/32;case f.Timestamp:return 2;case f.Date:return 1+e.unit;case f.Interval:return 1+e.unit;case f.FixedSizeList:return e.listSize;case f.FixedSizeBinary:return e.byteWidth;default:return 1}}var D=class{visitMany(t,...e){return t.map((i,n)=>this.visit(i,...e.map(r=>r[n])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return vp(this,t,e)}getVisitFnByTypeId(t,e=!0){return Ln(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}};function vp(t,e,i=!0){return typeof e=="number"?Ln(t,e,i):typeof e=="string"&&e in f?Ln(t,f[e],i):e&&e instanceof B?Ln(t,El(e),i):e!=null&&e.type&&e.type instanceof B?Ln(t,El(e.type),i):Ln(t,f.NONE,i)}function Ln(t,e,i=!0){let n=null;switch(e){case f.Null:n=t.visitNull;break;case f.Bool:n=t.visitBool;break;case f.Int:n=t.visitInt;break;case f.Int8:n=t.visitInt8||t.visitInt;break;case f.Int16:n=t.visitInt16||t.visitInt;break;case f.Int32:n=t.visitInt32||t.visitInt;break;case f.Int64:n=t.visitInt64||t.visitInt;break;case f.Uint8:n=t.visitUint8||t.visitInt;break;case f.Uint16:n=t.visitUint16||t.visitInt;break;case f.Uint32:n=t.visitUint32||t.visitInt;break;case f.Uint64:n=t.visitUint64||t.visitInt;break;case f.Float:n=t.visitFloat;break;case f.Float16:n=t.visitFloat16||t.visitFloat;break;case f.Float32:n=t.visitFloat32||t.visitFloat;break;case f.Float64:n=t.visitFloat64||t.visitFloat;break;case f.Utf8:n=t.visitUtf8;break;case f.Binary:n=t.visitBinary;break;case f.FixedSizeBinary:n=t.visitFixedSizeBinary;break;case f.Date:n=t.visitDate;break;case f.DateDay:n=t.visitDateDay||t.visitDate;break;case f.DateMillisecond:n=t.visitDateMillisecond||t.visitDate;break;case f.Timestamp:n=t.visitTimestamp;break;case f.TimestampSecond:n=t.visitTimestampSecond||t.visitTimestamp;break;case f.TimestampMillisecond:n=t.visitTimestampMillisecond||t.visitTimestamp;break;case f.TimestampMicrosecond:n=t.visitTimestampMicrosecond||t.visitTimestamp;break;case f.TimestampNanosecond:n=t.visitTimestampNanosecond||t.visitTimestamp;break;case f.Time:n=t.visitTime;break;case f.TimeSecond:n=t.visitTimeSecond||t.visitTime;break;case f.TimeMillisecond:n=t.visitTimeMillisecond||t.visitTime;break;case f.TimeMicrosecond:n=t.visitTimeMicrosecond||t.visitTime;break;case f.TimeNanosecond:n=t.visitTimeNanosecond||t.visitTime;break;case f.Decimal:n=t.visitDecimal;break;case f.List:n=t.visitList;break;case f.Struct:n=t.visitStruct;break;case f.Union:n=t.visitUnion;break;case f.DenseUnion:n=t.visitDenseUnion||t.visitUnion;break;case f.SparseUnion:n=t.visitSparseUnion||t.visitUnion;break;case f.Dictionary:n=t.visitDictionary;break;case f.Interval:n=t.visitInterval;break;case f.IntervalDayTime:n=t.visitIntervalDayTime||t.visitInterval;break;case f.IntervalYearMonth:n=t.visitIntervalYearMonth||t.visitInterval;break;case f.FixedSizeList:n=t.visitFixedSizeList;break;case f.Map:n=t.visitMap;break}if(typeof n=="function")return n;if(!i)return()=>null;throw new Error(`Unrecognized type '${f[e]}'`)}function El(t){switch(t.typeId){case f.Null:return f.Null;case f.Int:{let{bitWidth:e,isSigned:i}=t;switch(e){case 8:return i?f.Int8:f.Uint8;case 16:return i?f.Int16:f.Uint16;case 32:return i?f.Int32:f.Uint32;case 64:return i?f.Int64:f.Uint64}return f.Int}case f.Float:switch(t.precision){case yt.HALF:return f.Float16;case yt.SINGLE:return f.Float32;case yt.DOUBLE:return f.Float64}return f.Float;case f.Binary:return f.Binary;case f.Utf8:return f.Utf8;case f.Bool:return f.Bool;case f.Decimal:return f.Decimal;case f.Time:switch(t.unit){case X.SECOND:return f.TimeSecond;case X.MILLISECOND:return f.TimeMillisecond;case X.MICROSECOND:return f.TimeMicrosecond;case X.NANOSECOND:return f.TimeNanosecond}return f.Time;case f.Timestamp:switch(t.unit){case X.SECOND:return f.TimestampSecond;case X.MILLISECOND:return f.TimestampMillisecond;case X.MICROSECOND:return f.TimestampMicrosecond;case X.NANOSECOND:return f.TimestampNanosecond}return f.Timestamp;case f.Date:switch(t.unit){case Wt.DAY:return f.DateDay;case Wt.MILLISECOND:return f.DateMillisecond}return f.Date;case f.Interval:switch(t.unit){case ne.DAY_TIME:return f.IntervalDayTime;case ne.YEAR_MONTH:return f.IntervalYearMonth}return f.Interval;case f.Map:return f.Map;case f.List:return f.List;case f.Struct:return f.Struct;case f.Union:switch(t.mode){case vt.Dense:return f.DenseUnion;case vt.Sparse:return f.SparseUnion}return f.Union;case f.FixedSizeBinary:return f.FixedSizeBinary;case f.FixedSizeList:return f.FixedSizeList;case f.Dictionary:return f.Dictionary}throw new Error(`Unrecognized type '${f[t.typeId]}'`)}D.prototype.visitInt8=null,D.prototype.visitInt16=null,D.prototype.visitInt32=null,D.prototype.visitInt64=null,D.prototype.visitUint8=null,D.prototype.visitUint16=null,D.prototype.visitUint32=null,D.prototype.visitUint64=null,D.prototype.visitFloat16=null,D.prototype.visitFloat32=null,D.prototype.visitFloat64=null,D.prototype.visitDateDay=null,D.prototype.visitDateMillisecond=null,D.prototype.visitTimestampSecond=null,D.prototype.visitTimestampMillisecond=null,D.prototype.visitTimestampMicrosecond=null,D.prototype.visitTimestampNanosecond=null,D.prototype.visitTimeSecond=null,D.prototype.visitTimeMillisecond=null,D.prototype.visitTimeMicrosecond=null,D.prototype.visitTimeNanosecond=null,D.prototype.visitDenseUnion=null,D.prototype.visitSparseUnion=null,D.prototype.visitIntervalDayTime=null,D.prototype.visitIntervalYearMonth=null;var ya={};dn(ya,{float64ToUint16:()=>mi,uint16ToFloat64:()=>Us});var Ol=new Float64Array(1),Nn=new Uint32Array(Ol.buffer);function Us(t){let e=(t&31744)>>10,i=(t&1023)/1024,n=Math.pow(-1,(t&32768)>>15);switch(e){case 31:return n*(i?Number.NaN:1/0);case 0:return n*(i?6103515625e-14*i:0)}return n*Math.pow(2,e-15)*(1+i)}function mi(t){if(t!==t)return 32256;Ol[0]=t;let e=(Nn[1]&2147483648)>>16&65535,i=Nn[1]&2146435072,n=0;return i>=1089470464?Nn[0]>0?i=31744:(i=(i&2080374784)>>16,n=(Nn[1]&1048575)>>10):i<=1056964608?(n=1048576+(Nn[1]&1048575),n=1048576+(n<<(i>>20)-998)>>21,i=0):(i=i-1056964608>>10,n=(Nn[1]&1048575)+512>>10),e|i|n&65535}var N=class extends D{};function j(t){return(e,i,n)=>{if(e.setValid(i,n!=null))return t(e,i,n)}}var Sp=(t,e,i)=>{t[e]=Math.trunc(i/864e5)},ba=(t,e,i)=>{t[e]=Math.trunc(i%4294967296),t[e+1]=Math.trunc(i/4294967296)},Ip=(t,e,i)=>{t[e]=Math.trunc(i*1e3%4294967296),t[e+1]=Math.trunc(i*1e3/4294967296)},Fp=(t,e,i)=>{t[e]=Math.trunc(i*1e6%4294967296),t[e+1]=Math.trunc(i*1e6/4294967296)},Rl=(t,e,i,n)=>{if(i+1<e.length){let{[i]:r,[i+1]:s}=e;t.set(n.subarray(0,s-r),r)}},Ap=({offset:t,values:e},i,n)=>{let r=t+i;n?e[r>>3]|=1<<r%8:e[r>>3]&=~(1<<r%8)},Mr=({values:t},e,i)=>{t[e]=i},ga=({values:t},e,i)=>{t[e]=i},Ml=({values:t},e,i)=>{t[e]=mi(i)},xp=(t,e,i)=>{switch(t.type.precision){case yt.HALF:return Ml(t,e,i);case yt.SINGLE:case yt.DOUBLE:return ga(t,e,i)}},Ls=({values:t},e,i)=>{Sp(t,e,i.valueOf())},Ns=({values:t},e,i)=>{ba(t,e*2,i.valueOf())},wa=({stride:t,values:e},i,n)=>{e.set(n.subarray(0,t),t*i)},Bp=({values:t,valueOffsets:e},i,n)=>Rl(t,e,i,n),Tp=({values:t,valueOffsets:e},i,n)=>{Rl(t,e,i,Yr(n))},va=(t,e,i)=>{t.type.unit===Wt.DAY?Ls(t,e,i):Ns(t,e,i)},ks=({values:t},e,i)=>ba(t,e*2,i/1e3),Cs=({values:t},e,i)=>ba(t,e*2,i),Ps=({values:t},e,i)=>Ip(t,e*2,i),Hs=({values:t},e,i)=>Fp(t,e*2,i),Sa=(t,e,i)=>{switch(t.type.unit){case X.SECOND:return ks(t,e,i);case X.MILLISECOND:return Cs(t,e,i);case X.MICROSECOND:return Ps(t,e,i);case X.NANOSECOND:return Hs(t,e,i)}},Vs=({values:t},e,i)=>{t[e]=i},zs=({values:t},e,i)=>{t[e]=i},js=({values:t},e,i)=>{t[e]=i},Ws=({values:t},e,i)=>{t[e]=i},Ia=(t,e,i)=>{switch(t.type.unit){case X.SECOND:return Vs(t,e,i);case X.MILLISECOND:return zs(t,e,i);case X.MICROSECOND:return js(t,e,i);case X.NANOSECOND:return Ws(t,e,i)}},Fa=({values:t,stride:e},i,n)=>{t.set(n.subarray(0,e),e*i)},Dp=(t,e,i)=>{let n=t.children[0],r=t.valueOffsets,s=$t.getVisitFn(n);if(Array.isArray(i))for(let a=-1,o=r[e],u=r[e+1];o<u;)s(n,o++,i[++a]);else for(let a=-1,o=r[e],u=r[e+1];o<u;)s(n,o++,i.get(++a))},Ep=(t,e,i)=>{let n=t.children[0],{valueOffsets:r}=t,s=$t.getVisitFn(n),{[e]:a,[e+1]:o}=r,u=i instanceof Map?i.entries():Object.entries(i);for(let d of u)if(s(n,a,d),++a>=o)break},Op=(t,e)=>(i,n,r,s)=>n&&i(n,t,e[s]),Rp=(t,e)=>(i,n,r,s)=>n&&i(n,t,e.get(s)),Mp=(t,e)=>(i,n,r,s)=>n&&i(n,t,e.get(r.name)),Up=(t,e)=>(i,n,r,s)=>n&&i(n,t,e[r.name]),Lp=(t,e,i)=>{let n=t.type.children.map(s=>$t.getVisitFn(s.type)),r=i instanceof Map?Mp(e,i):i instanceof k?Rp(e,i):Array.isArray(i)?Op(e,i):Up(e,i);t.type.children.forEach((s,a)=>r(n[a],t.children[a],s,a))},Np=(t,e,i)=>{t.type.mode===vt.Dense?Ul(t,e,i):Ll(t,e,i)},Ul=(t,e,i)=>{let n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];$t.visit(r,t.valueOffsets[e],i)},Ll=(t,e,i)=>{let n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];$t.visit(r,e,i)},kp=(t,e,i)=>{var n;(n=t.dictionary)===null||n===void 0||n.set(t.values[e],i)},Aa=(t,e,i)=>{t.type.unit===ne.DAY_TIME?$s(t,e,i):Ys(t,e,i)},$s=({values:t},e,i)=>{t.set(i.subarray(0,2),2*e)},Ys=({values:t},e,i)=>{t[e]=i[0]*12+i[1]%12},Cp=(t,e,i)=>{let{stride:n}=t,r=t.children[0],s=$t.getVisitFn(r);if(Array.isArray(i))for(let a=-1,o=e*n;++a<n;)s(r,o+a,i[a]);else for(let a=-1,o=e*n;++a<n;)s(r,o+a,i.get(a))};N.prototype.visitBool=j(Ap),N.prototype.visitInt=j(Mr),N.prototype.visitInt8=j(Mr),N.prototype.visitInt16=j(Mr),N.prototype.visitInt32=j(Mr),N.prototype.visitInt64=j(Mr),N.prototype.visitUint8=j(Mr),N.prototype.visitUint16=j(Mr),N.prototype.visitUint32=j(Mr),N.prototype.visitUint64=j(Mr),N.prototype.visitFloat=j(xp),N.prototype.visitFloat16=j(Ml),N.prototype.visitFloat32=j(ga),N.prototype.visitFloat64=j(ga),N.prototype.visitUtf8=j(Tp),N.prototype.visitBinary=j(Bp),N.prototype.visitFixedSizeBinary=j(wa),N.prototype.visitDate=j(va),N.prototype.visitDateDay=j(Ls),N.prototype.visitDateMillisecond=j(Ns),N.prototype.visitTimestamp=j(Sa),N.prototype.visitTimestampSecond=j(ks),N.prototype.visitTimestampMillisecond=j(Cs),N.prototype.visitTimestampMicrosecond=j(Ps),N.prototype.visitTimestampNanosecond=j(Hs),N.prototype.visitTime=j(Ia),N.prototype.visitTimeSecond=j(Vs),N.prototype.visitTimeMillisecond=j(zs),N.prototype.visitTimeMicrosecond=j(js),N.prototype.visitTimeNanosecond=j(Ws),N.prototype.visitDecimal=j(Fa),N.prototype.visitList=j(Dp),N.prototype.visitStruct=j(Lp),N.prototype.visitUnion=j(Np),N.prototype.visitDenseUnion=j(Ul),N.prototype.visitSparseUnion=j(Ll),N.prototype.visitDictionary=j(kp),N.prototype.visitInterval=j(Aa),N.prototype.visitIntervalDayTime=j($s),N.prototype.visitIntervalYearMonth=j(Ys),N.prototype.visitFixedSizeList=j(Cp),N.prototype.visitMap=j(Ep);var $t=new N,Ze=Symbol.for("parent"),kn=Symbol.for("rowIndex"),Gr=class{constructor(t,e){return this[Ze]=t,this[kn]=e,new Proxy(this,new Ba)}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[kn],e=this[Ze],i=e.type.children,n={};for(let r=-1,s=i.length;++r<s;)n[i[r].name]=Dt.visit(e.children[r],t);return n}toString(){return`{${[...this].map(([t,e])=>`${$e(t)}: ${$e(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new xa(this[Ze],this[kn])}},xa=class{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,Dt.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}};Object.defineProperties(Gr.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Ze]:{writable:!0,enumerable:!1,configurable:!1,value:null},[kn]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});var Ba=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Ze].type.children.map(e=>e.name)}has(t,e){return t[Ze].type.children.findIndex(i=>i.name===e)!==-1}getOwnPropertyDescriptor(t,e){if(t[Ze].type.children.findIndex(i=>i.name===e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];let i=t[Ze].type.children.findIndex(n=>n.name===e);if(i!==-1){let n=Dt.visit(t[Ze].children[i],t[kn]);return Reflect.set(t,e,n),n}}set(t,e,i){let n=t[Ze].type.children.findIndex(r=>r.name===e);return n!==-1?($t.visit(t[Ze].children[n],t[kn],i),Reflect.set(t,e,i)):Reflect.has(t,e)||typeof e=="symbol"?Reflect.set(t,e,i):!1}},O=class extends D{};function P(t){return(e,i)=>e.getValid(i)?t(e,i):null}var Pp=(t,e)=>864e5*t[e],Ta=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),Hp=(t,e)=>4294967296*(t[e+1]/1e3)+(t[e]>>>0)/1e3,Vp=(t,e)=>4294967296*(t[e+1]/1e6)+(t[e]>>>0)/1e6,Nl=t=>new Date(t),zp=(t,e)=>Nl(Pp(t,e)),jp=(t,e)=>Nl(Ta(t,e)),Wp=(t,e)=>null,kl=(t,e,i)=>{if(i+1>=e.length)return null;let n=e[i],r=e[i+1];return t.subarray(n,r)},$p=({offset:t,values:e},i)=>{let n=t+i;return(e[n>>3]&1<<n%8)!==0},Cl=({values:t},e)=>zp(t,e),Pl=({values:t},e)=>jp(t,e*2),Kr=({stride:t,values:e},i)=>e[t*i],Yp=({stride:t,values:e},i)=>Us(e[t*i]),Hl=({values:t},e)=>t[e],Xp=({stride:t,values:e},i)=>e.subarray(t*i,t*(i+1)),Gp=({values:t,valueOffsets:e},i)=>kl(t,e,i),Kp=({values:t,valueOffsets:e},i)=>{let n=kl(t,e,i);return n!==null?di(n):null},Jp=({values:t},e)=>t[e],qp=({type:t,values:e},i)=>t.precision!==yt.HALF?e[i]:Us(e[i]),Zp=(t,e)=>t.type.unit===Wt.DAY?Cl(t,e):Pl(t,e),Vl=({values:t},e)=>1e3*Ta(t,e*2),zl=({values:t},e)=>Ta(t,e*2),jl=({values:t},e)=>Hp(t,e*2),Wl=({values:t},e)=>Vp(t,e*2),Qp=(t,e)=>{switch(t.type.unit){case X.SECOND:return Vl(t,e);case X.MILLISECOND:return zl(t,e);case X.MICROSECOND:return jl(t,e);case X.NANOSECOND:return Wl(t,e)}},$l=({values:t},e)=>t[e],Yl=({values:t},e)=>t[e],Xl=({values:t},e)=>t[e],Gl=({values:t},e)=>t[e],tm=(t,e)=>{switch(t.type.unit){case X.SECOND:return $l(t,e);case X.MILLISECOND:return Yl(t,e);case X.MICROSECOND:return Xl(t,e);case X.NANOSECOND:return Gl(t,e)}},em=({values:t,stride:e},i)=>hn.decimal(t.subarray(e*i,e*(i+1))),rm=(t,e)=>{let{valueOffsets:i,stride:n,children:r}=t,{[e*n]:s,[e*n+1]:a}=i,o=r[0].slice(s,a-s);return new k([o])},nm=(t,e)=>{let{valueOffsets:i,children:n}=t,{[e]:r,[e+1]:s}=i,a=n[0];return new cr(a.slice(r,s-r))},im=(t,e)=>new Gr(t,e),sm=(t,e)=>t.type.mode===vt.Dense?Kl(t,e):Jl(t,e),Kl=(t,e)=>{let i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];return Dt.visit(n,t.valueOffsets[e])},Jl=(t,e)=>{let i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];return Dt.visit(n,e)},om=(t,e)=>{var i;return(i=t.dictionary)===null||i===void 0?void 0:i.get(t.values[e])},am=(t,e)=>t.type.unit===ne.DAY_TIME?ql(t,e):Zl(t,e),ql=({values:t},e)=>t.subarray(2*e,2*(e+1)),Zl=({values:t},e)=>{let i=t[e],n=new Int32Array(2);return n[0]=Math.trunc(i/12),n[1]=Math.trunc(i%12),n},cm=(t,e)=>{let{stride:i,children:n}=t,r=n[0].slice(e*i,i);return new k([r])};O.prototype.visitNull=P(Wp),O.prototype.visitBool=P($p),O.prototype.visitInt=P(Jp),O.prototype.visitInt8=P(Kr),O.prototype.visitInt16=P(Kr),O.prototype.visitInt32=P(Kr),O.prototype.visitInt64=P(Hl),O.prototype.visitUint8=P(Kr),O.prototype.visitUint16=P(Kr),O.prototype.visitUint32=P(Kr),O.prototype.visitUint64=P(Hl),O.prototype.visitFloat=P(qp),O.prototype.visitFloat16=P(Yp),O.prototype.visitFloat32=P(Kr),O.prototype.visitFloat64=P(Kr),O.prototype.visitUtf8=P(Kp),O.prototype.visitBinary=P(Gp),O.prototype.visitFixedSizeBinary=P(Xp),O.prototype.visitDate=P(Zp),O.prototype.visitDateDay=P(Cl),O.prototype.visitDateMillisecond=P(Pl),O.prototype.visitTimestamp=P(Qp),O.prototype.visitTimestampSecond=P(Vl),O.prototype.visitTimestampMillisecond=P(zl),O.prototype.visitTimestampMicrosecond=P(jl),O.prototype.visitTimestampNanosecond=P(Wl),O.prototype.visitTime=P(tm),O.prototype.visitTimeSecond=P($l),O.prototype.visitTimeMillisecond=P(Yl),O.prototype.visitTimeMicrosecond=P(Xl),O.prototype.visitTimeNanosecond=P(Gl),O.prototype.visitDecimal=P(em),O.prototype.visitList=P(rm),O.prototype.visitStruct=P(im),O.prototype.visitUnion=P(sm),O.prototype.visitDenseUnion=P(Kl),O.prototype.visitSparseUnion=P(Jl),O.prototype.visitDictionary=P(om),O.prototype.visitInterval=P(am),O.prototype.visitIntervalDayTime=P(ql),O.prototype.visitIntervalYearMonth=P(Zl),O.prototype.visitFixedSizeList=P(cm),O.prototype.visitMap=P(nm);var Dt=new O,Le=Symbol.for("keys"),Cn=Symbol.for("vals"),cr=class{constructor(t){return this[Le]=new k([t.children[0]]).memoize(),this[Cn]=t.children[1],new Proxy(this,new Ea)}[Symbol.iterator](){return new Da(this[Le],this[Cn])}get size(){return this[Le].length}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[Le],e=this[Cn],i={};for(let n=-1,r=t.length;++n<r;)i[t.get(n)]=Dt.visit(e,n);return i}toString(){return`{${[...this].map(([t,e])=>`${$e(t)}: ${$e(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}},Da=class{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){let t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),Dt.visit(this.vals,t)]})}},Ea=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Le].toArray().map(String)}has(t,e){return t[Le].includes(e)}getOwnPropertyDescriptor(t,e){if(t[Le].indexOf(e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];let i=t[Le].indexOf(e);if(i!==-1){let n=Dt.visit(Reflect.get(t,Cn),i);return Reflect.set(t,e,n),n}}set(t,e,i){let n=t[Le].indexOf(e);return n!==-1?($t.visit(Reflect.get(t,Cn),n,i),Reflect.set(t,e,i)):Reflect.has(t,e)?Reflect.set(t,e,i):!1}};Object.defineProperties(cr.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Le]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Cn]:{writable:!0,enumerable:!1,configurable:!1,value:null}});function lm(t,e,i){let n=t.length,r=e>-1?e:n+e%n;return i?i(t,r):r}var Ql;function _i(t,e,i,n){let{length:r=0}=t,s=typeof e!="number"?0:e,a=typeof i!="number"?r:i;return s<0&&(s=(s%r+r)%r),a<0&&(a=(a%r+r)%r),a<s&&(Ql=s,s=a,a=Ql),a>r&&(a=r),n?n(t,s,a):[s,a]}var tu=t=>t!==t;function Jr(t){if(typeof t!="object"||t===null)return tu(t)?tu:e=>e===t;if(t instanceof Date){let e=t.valueOf();return i=>i instanceof Date?i.valueOf()===e:!1}return ArrayBuffer.isView(t)?e=>e?da(t,e):!1:t instanceof Map?dm(t):Array.isArray(t)?um(t):t instanceof k?fm(t):hm(t,!0)}function um(t){let e=[];for(let i=-1,n=t.length;++i<n;)e[i]=Jr(t[i]);return Xs(e)}function dm(t){let e=-1,i=[];for(let n of t.values())i[++e]=Jr(n);return Xs(i)}function fm(t){let e=[];for(let i=-1,n=t.length;++i<n;)e[i]=Jr(t.get(i));return Xs(e)}function hm(t,e=!1){let i=Object.keys(t);if(!e&&i.length===0)return()=>!1;let n=[];for(let r=-1,s=i.length;++r<s;)n[r]=Jr(t[i[r]]);return Xs(n,i)}function Xs(t,e){return i=>{if(!i||typeof i!="object")return!1;switch(i.constructor){case Array:return pm(t,i);case Map:return eu(t,i,i.keys());case cr:case Gr:case Object:case void 0:return eu(t,i,e||Object.keys(i))}return i instanceof k?mm(t,i):!1}}function pm(t,e){let i=t.length;if(e.length!==i)return!1;for(let n=-1;++n<i;)if(!t[n](e[n]))return!1;return!0}function mm(t,e){let i=t.length;if(e.length!==i)return!1;for(let n=-1;++n<i;)if(!t[n](e.get(n)))return!1;return!0}function eu(t,e,i){let n=i[Symbol.iterator](),r=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),s=e instanceof Map?e.values():Object.values(e)[Symbol.iterator](),a=0,o=t.length,u=s.next(),d=n.next(),p=r.next();for(;a<o&&!d.done&&!p.done&&!u.done&&!(d.value!==p.value||!t[a](u.value));++a,d=n.next(),p=r.next(),u=s.next());return a===o&&d.done&&p.done&&u.done?!0:(n.return&&n.return(),r.return&&r.return(),s.return&&s.return(),!1)}var Ra={};dn(Ra,{BitIterator:()=>pn,getBit:()=>ru,getBool:()=>Ks,packBools:()=>mn,popcnt_array:()=>nu,popcnt_bit_range:()=>yi,popcnt_uint32:()=>Gs,setBool:()=>_m,truncateBitmap:()=>Pn});function Ks(t,e,i,n){return(i&1<<n)!==0}function ru(t,e,i,n){return(i&1<<n)>>n}function _m(t,e,i){return i?!!(t[e>>3]|=1<<e%8)||!0:!(t[e>>3]&=~(1<<e%8))&&!1}function Pn(t,e,i){let n=i.byteLength+7&-8;if(t>0||i.byteLength<n){let r=new Uint8Array(n);return r.set(t%8===0?i.subarray(t>>3):mn(new pn(i,t,e,null,Ks)).subarray(0,n)),r}return i}function mn(t){let e=[],i=0,n=0,r=0;for(let a of t)a&&(r|=1<<n),++n===8&&(e[i++]=r,r=n=0);(i===0||n>0)&&(e[i++]=r);let s=new Uint8Array(e.length+7&-8);return s.set(e),s}var pn=class{constructor(t,e,i,n,r){this.bytes=t,this.length=i,this.context=n,this.get=r,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}};function yi(t,e,i){if(i-e<=0)return 0;if(i-e<8){let s=0;for(let a of new pn(t,e,i-e,t,ru))s+=a;return s}let n=i>>3<<3,r=e+(e%8===0?0:8-e%8);return yi(t,e,r)+yi(t,n,i)+nu(t,r>>3,n-r>>3)}function nu(t,e,i){let n=0,r=Math.trunc(e),s=new DataView(t.buffer,t.byteOffset,t.byteLength),a=i===void 0?t.byteLength:r+i;for(;a-r>=4;)n+=Gs(s.getUint32(r)),r+=4;for(;a-r>=2;)n+=Gs(s.getUint16(r)),r+=2;for(;a-r>=1;)n+=Gs(s.getUint8(r)),r+=1;return n}function Gs(t){let e=Math.trunc(t);return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),(e+(e>>>4)&252645135)*16843009>>>24}var ym=-1,nt=class{constructor(t,e,i,n,r,s=[],a){this.type=t,this.children=s,this.dictionary=a,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(n||0,-1));let o;r instanceof nt?(this.stride=r.stride,this.values=r.values,this.typeIds=r.typeIds,this.nullBitmap=r.nullBitmap,this.valueOffsets=r.valueOffsets):(this.stride=Ae(t),r&&((o=r[0])&&(this.valueOffsets=o),(o=r[1])&&(this.values=o),(o=r[2])&&(this.nullBitmap=o),(o=r[3])&&(this.typeIds=o))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0,{valueOffsets:e,values:i,nullBitmap:n,typeIds:r}=this;return e&&(t+=e.byteLength),i&&(t+=i.byteLength),n&&(t+=n.byteLength),r&&(t+=r.byteLength),this.children.reduce((s,a)=>s+a.byteLength,t)}get nullCount(){let t=this._nullCount,e;return t<=ym&&(e=this.nullBitmap)&&(this._nullCount=t=this.length-yi(e,this.offset,this.offset+this.length)),t}getValid(t){if(this.nullable&&this.nullCount>0){let e=this.offset+t;return(this.nullBitmap[e>>3]&1<<e%8)!==0}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){let{nullBitmap:o}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:o,_nullCount:0})}let{nullBitmap:i,offset:n}=this,r=n+t>>3,s=(n+t)%8,a=i[r]>>s&1;return e?a===0&&(i[r]|=1<<s,this._nullCount=this.nullCount+1):a===1&&(i[r]&=~(1<<s),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,i=this.length,n=this._nullCount,r=this,s=this.children){return new nt(t,e,i,n,r,s,this.dictionary)}slice(t,e){let{stride:i,typeId:n,children:r}=this,s=+(this._nullCount===0)-1,a=n===16?i:1,o=this._sliceBuffers(t,e,i,n);return this.clone(this.type,this.offset+t,e,s,o,r.length===0||this.valueOffsets?r:this._sliceChildren(r,a*t,a*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===f.Null)return this.clone(this.type,0,t,0);let{length:e,nullCount:i}=this,n=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);n[e>>3]=(1<<e-(e&-8))-1,i>0&&n.set(Pn(this.offset,e,this.nullBitmap),0);let r=this.buffers;return r[Ue.VALIDITY]=n,this.clone(this.type,0,t,i+(t-e),r)}_sliceBuffers(t,e,i,n){let r,{buffers:s}=this;return(r=s[Ue.TYPE])&&(s[Ue.TYPE]=r.subarray(t,t+e)),(r=s[Ue.OFFSET])&&(s[Ue.OFFSET]=r.subarray(t,t+e+1))||(r=s[Ue.DATA])&&(s[Ue.DATA]=n===6?r:r.subarray(i*t,i*(t+e))),s}_sliceChildren(t,e,i){return t.map(n=>n.slice(e,i))}};nt.prototype.children=Object.freeze([]);var _n=class extends D{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){let{["type"]:e,["offset"]:i=0,["length"]:n=0}=t;return new nt(e,i,n,0)}visitBool(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.ArrayType,t.data),{["length"]:s=r.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,r,n])}visitInt(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.ArrayType,t.data),{["length"]:s=r.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,r,n])}visitFloat(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.ArrayType,t.data),{["length"]:s=r.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,r,n])}visitUtf8(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.data),r=L(t.nullBitmap),s=fn(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:o=t.nullBitmap?-1:0}=t;return new nt(e,i,a,o,[s,n,r])}visitBinary(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.data),r=L(t.nullBitmap),s=fn(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:o=t.nullBitmap?-1:0}=t;return new nt(e,i,a,o,[s,n,r])}visitFixedSizeBinary(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.ArrayType,t.data),{["length"]:s=r.length/Ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,r,n])}visitDate(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.ArrayType,t.data),{["length"]:s=r.length/Ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,r,n])}visitTimestamp(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.ArrayType,t.data),{["length"]:s=r.length/Ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,r,n])}visitTime(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.ArrayType,t.data),{["length"]:s=r.length/Ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,r,n])}visitDecimal(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.ArrayType,t.data),{["length"]:s=r.length/Ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,r,n])}visitList(t){let{["type"]:e,["offset"]:i=0,["child"]:n}=t,r=L(t.nullBitmap),s=fn(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:o=t.nullBitmap?-1:0}=t;return new nt(e,i,a,o,[s,void 0,r],[n])}visitStruct(t){let{["type"]:e,["offset"]:i=0,["children"]:n=[]}=t,r=L(t.nullBitmap),{length:s=n.reduce((o,{length:u})=>Math.max(o,u),0),nullCount:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,void 0,r],n)}visitUnion(t){let{["type"]:e,["offset"]:i=0,["children"]:n=[]}=t,r=L(t.nullBitmap),s=$(e.ArrayType,t.typeIds),{["length"]:a=s.length,["nullCount"]:o=t.nullBitmap?-1:0}=t;if(B.isSparseUnion(e))return new nt(e,i,a,o,[void 0,void 0,r,s],n);let u=fn(t.valueOffsets);return new nt(e,i,a,o,[u,void 0,r,s],n)}visitDictionary(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.indices.ArrayType,t.data),{["dictionary"]:s=new k([new _n().visit({type:e.dictionary})])}=t,{["length"]:a=r.length,["nullCount"]:o=t.nullBitmap?-1:0}=t;return new nt(e,i,a,o,[void 0,r,n],[],s)}visitInterval(t){let{["type"]:e,["offset"]:i=0}=t,n=L(t.nullBitmap),r=$(e.ArrayType,t.data),{["length"]:s=r.length/Ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,r,n])}visitFixedSizeList(t){let{["type"]:e,["offset"]:i=0,["child"]:n=new _n().visit({type:e.valueType})}=t,r=L(t.nullBitmap),{["length"]:s=n.length/Ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new nt(e,i,s,a,[void 0,void 0,r],[n])}visitMap(t){let{["type"]:e,["offset"]:i=0,["child"]:n=new _n().visit({type:e.childType})}=t,r=L(t.nullBitmap),s=fn(t.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:o=t.nullBitmap?-1:0}=t;return new nt(e,i,a,o,[s,void 0,r],[n])}};function C(t){return new _n().visit(t)}var bi=class{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){let t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}};function Js(t){return t.reduce((e,i)=>e+i.nullCount,0)}function qs(t){return t.reduce((e,i,n)=>(e[n+1]=e[n]+i.length,e),new Uint32Array(t.length+1))}function Zs(t,e,i,n){let r=[];for(let s=-1,a=t.length;++s<a;){let o=t[s],u=e[s],{length:d}=o;if(u>=n)break;if(i>=u+d)continue;if(u>=i&&u+d<=n){r.push(o);continue}let p=Math.max(0,i-u),v=Math.min(n-u,d);r.push(o.slice(p,v-p))}return r.length===0&&r.push(t[0].slice(0,0)),r}function Ma(t,e,i,n){let r=0,s=0,a=e.length-1;do{if(r>=a-1)return i<e[a]?n(t,r,i-e[r]):null;s=r+Math.trunc((a-r)*.5),i<e[s]?a=s:r=s}while(r<a)}function gi(t,e){return t.getValid(e)}function qr(t){function e(i,n,r){return t(i[n],r)}return function(i){let n=this.data;return Ma(n,this._offsets,i,e)}}function Qs(t){let e;function i(n,r,s){return t(n[r],s,e)}return function(n,r){let s=this.data;e=r;let a=Ma(s,this._offsets,n,i);return e=void 0,a}}function to(t){let e;function i(n,r,s){let a=s,o=0,u=0;for(let d=r-1,p=n.length;++d<p;){let v=n[d];if(~(o=t(v,e,a)))return u+o;a=0,u+=v.length}return-1}return function(n,r){e=n;let s=this.data,a=typeof r!="number"?i(s,0,0):Ma(s,this._offsets,r,i);return e=void 0,a}}var R=class extends D{};function bm(t,e){return e===null&&t.length>0?0:-1}function gm(t,e){let{nullBitmap:i}=t;if(!i||t.nullCount<=0)return-1;let n=0;for(let r of new pn(i,t.offset+(e||0),t.length,i,Ks)){if(!r)return n;++n}return-1}function Y(t,e,i){if(e===void 0)return-1;if(e===null)return gm(t,i);let n=Dt.getVisitFn(t),r=Jr(e);for(let s=(i||0)-1,a=t.length;++s<a;)if(r(n(t,s)))return s;return-1}function iu(t,e,i){let n=Dt.getVisitFn(t),r=Jr(e);for(let s=(i||0)-1,a=t.length;++s<a;)if(r(n(t,s)))return s;return-1}R.prototype.visitNull=bm,R.prototype.visitBool=Y,R.prototype.visitInt=Y,R.prototype.visitInt8=Y,R.prototype.visitInt16=Y,R.prototype.visitInt32=Y,R.prototype.visitInt64=Y,R.prototype.visitUint8=Y,R.prototype.visitUint16=Y,R.prototype.visitUint32=Y,R.prototype.visitUint64=Y,R.prototype.visitFloat=Y,R.prototype.visitFloat16=Y,R.prototype.visitFloat32=Y,R.prototype.visitFloat64=Y,R.prototype.visitUtf8=Y,R.prototype.visitBinary=Y,R.prototype.visitFixedSizeBinary=Y,R.prototype.visitDate=Y,R.prototype.visitDateDay=Y,R.prototype.visitDateMillisecond=Y,R.prototype.visitTimestamp=Y,R.prototype.visitTimestampSecond=Y,R.prototype.visitTimestampMillisecond=Y,R.prototype.visitTimestampMicrosecond=Y,R.prototype.visitTimestampNanosecond=Y,R.prototype.visitTime=Y,R.prototype.visitTimeSecond=Y,R.prototype.visitTimeMillisecond=Y,R.prototype.visitTimeMicrosecond=Y,R.prototype.visitTimeNanosecond=Y,R.prototype.visitDecimal=Y,R.prototype.visitList=Y,R.prototype.visitStruct=Y,R.prototype.visitUnion=Y,R.prototype.visitDenseUnion=iu,R.prototype.visitSparseUnion=iu,R.prototype.visitDictionary=Y,R.prototype.visitInterval=Y,R.prototype.visitIntervalDayTime=Y,R.prototype.visitIntervalYearMonth=Y,R.prototype.visitFixedSizeList=Y,R.prototype.visitMap=Y;var yn=new R,M=class extends D{};function H(t){let{type:e}=t;if(t.nullCount===0&&t.stride===1&&(e.typeId===f.Timestamp||e instanceof xt&&e.bitWidth!==64||e instanceof Xe&&e.bitWidth!==64||e instanceof de&&e.precision!==yt.HALF))return new bi(t.data.length,n=>{let r=t.data[n];return r.values.subarray(0,r.length)[Symbol.iterator]()});let i=0;return new bi(t.data.length,n=>{let r=t.data[n].length,s=t.slice(i,i+r);return i+=r,new Ua(s)})}var Ua=class{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}};M.prototype.visitNull=H,M.prototype.visitBool=H,M.prototype.visitInt=H,M.prototype.visitInt8=H,M.prototype.visitInt16=H,M.prototype.visitInt32=H,M.prototype.visitInt64=H,M.prototype.visitUint8=H,M.prototype.visitUint16=H,M.prototype.visitUint32=H,M.prototype.visitUint64=H,M.prototype.visitFloat=H,M.prototype.visitFloat16=H,M.prototype.visitFloat32=H,M.prototype.visitFloat64=H,M.prototype.visitUtf8=H,M.prototype.visitBinary=H,M.prototype.visitFixedSizeBinary=H,M.prototype.visitDate=H,M.prototype.visitDateDay=H,M.prototype.visitDateMillisecond=H,M.prototype.visitTimestamp=H,M.prototype.visitTimestampSecond=H,M.prototype.visitTimestampMillisecond=H,M.prototype.visitTimestampMicrosecond=H,M.prototype.visitTimestampNanosecond=H,M.prototype.visitTime=H,M.prototype.visitTimeSecond=H,M.prototype.visitTimeMillisecond=H,M.prototype.visitTimeMicrosecond=H,M.prototype.visitTimeNanosecond=H,M.prototype.visitDecimal=H,M.prototype.visitList=H,M.prototype.visitStruct=H,M.prototype.visitUnion=H,M.prototype.visitDenseUnion=H,M.prototype.visitSparseUnion=H,M.prototype.visitDictionary=H,M.prototype.visitInterval=H,M.prototype.visitIntervalDayTime=H,M.prototype.visitIntervalYearMonth=H,M.prototype.visitFixedSizeList=H,M.prototype.visitMap=H;var Hn=new M,wm=(t,e)=>t+e,lr=class extends D{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return t.type.bitWidth/8}visitDate(t,e){return(t.type.unit+1)*4}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===X.SECOND?4:8}visitInterval(t,e){return(t.type.unit+1)*4}visitStruct(t,e){return t.children.reduce((i,n)=>i+xe.visit(n,e),0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return 8+t.children.reduce((i,n)=>i+xe.visit(n,e),0)}visitDictionary(t,e){var i;return t.type.indices.bitWidth/8+(((i=t.dictionary)===null||i===void 0?void 0:i.getByteLength(t.values[e]))||0)}},vm=({valueOffsets:t},e)=>8+(t[e+1]-t[e]),Sm=({valueOffsets:t},e)=>8+(t[e+1]-t[e]),Im=({valueOffsets:t,stride:e,children:i},n)=>{let r=i[0],{[n*e]:s}=t,{[n*e+1]:a}=t,o=xe.getVisitFn(r.type),u=r.slice(s,a-s),d=8;for(let p=-1,v=a-s;++p<v;)d+=o(u,p);return d},Fm=({stride:t,children:e},i)=>{let n=e[0],r=n.slice(i*t,t),s=xe.getVisitFn(n.type),a=0;for(let o=-1,u=r.length;++o<u;)a+=s(r,o);return a},Am=(t,e)=>t.type.mode===vt.Dense?su(t,e):ou(t,e),su=({type:t,children:e,typeIds:i,valueOffsets:n},r)=>{let s=t.typeIdToChildIndex[i[r]];return 8+xe.visit(e[s],n[r])},ou=({children:t},e)=>4+xe.visitMany(t,t.map(()=>e)).reduce(wm,0);lr.prototype.visitUtf8=vm,lr.prototype.visitBinary=Sm,lr.prototype.visitList=Im,lr.prototype.visitFixedSizeList=Fm,lr.prototype.visitUnion=Am,lr.prototype.visitDenseUnion=su,lr.prototype.visitSparseUnion=ou;var xe=new lr,au,cu={},lu={},k=class{constructor(t){var e,i,n;let r=t[0]instanceof k?t.flatMap(a=>a.data):t;if(r.length===0||r.some(a=>!(a instanceof nt)))throw new TypeError("Vector constructor expects an Array of Data instances.");let s=(e=r[0])===null||e===void 0?void 0:e.type;switch(r.length){case 0:this._offsets=[0];break;case 1:{let{get:a,set:o,indexOf:u,byteLength:d}=cu[s.typeId],p=r[0];this.isValid=v=>gi(p,v),this.get=v=>a(p,v),this.set=(v,Z)=>o(p,v,Z),this.indexOf=v=>u(p,v),this.getByteLength=v=>d(p,v),this._offsets=[0,p.length];break}default:Object.setPrototypeOf(this,lu[s.typeId]),this._offsets=qs(r);break}this.data=r,this.type=s,this.stride=Ae(s),this.numChildren=(n=(i=s.children)===null||i===void 0?void 0:i.length)!==null&&n!==void 0?n:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((t,e)=>t+e.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=Js(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${f[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return Hn.visit(this)}concat(...t){return new k(this.data.concat(t.flatMap(e=>e.data).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new k(_i(this,t,e,({data:i,_offsets:n},r,s)=>Zs(i,n,r,s)))}toJSON(){return[...this]}toArray(){let{type:t,data:e,length:i,stride:n,ArrayType:r}=this;switch(t.typeId){case f.Int:case f.Float:case f.Decimal:case f.Time:case f.Timestamp:switch(e.length){case 0:return new r;case 1:return e[0].values.subarray(0,i*n);default:return e.reduce((s,{values:a,length:o})=>(s.array.set(a.subarray(0,o*n),s.offset),s.offset+=o*n,s),{array:new r(i*n),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt((e=this.type.children)===null||e===void 0?void 0:e.findIndex(i=>i.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new k(this.data.map(({children:e})=>e[t])):null}get isMemoized(){return B.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(B.isDictionary(this.type)){let t=new Vn(this.data[0].dictionary),e=this.data.map(i=>{let n=i.clone();return n.dictionary=t,n});return new k(e)}return new Vn(this)}unmemoize(){if(B.isDictionary(this.type)&&this.isMemoized){let t=this.data[0].dictionary.unmemoize(),e=this.data.map(i=>{let n=i.clone();return n.dictionary=t,n});return new k(e)}return this}};au=Symbol.toStringTag,k[au]=(t=>{t.type=B.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._nullCount=-1,t._byteLength=-1,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;let e=Object.keys(f).map(i=>f[i]).filter(i=>typeof i=="number"&&i!==f.NONE);for(let i of e){let n=Dt.getVisitFnByTypeId(i),r=$t.getVisitFnByTypeId(i),s=yn.getVisitFnByTypeId(i),a=xe.getVisitFnByTypeId(i);cu[i]={get:n,set:r,indexOf:s,byteLength:a},lu[i]=Object.create(t,{isValid:{value:qr(gi)},get:{value:qr(Dt.getVisitFnByTypeId(i))},set:{value:Qs($t.getVisitFnByTypeId(i))},indexOf:{value:to(yn.getVisitFnByTypeId(i))},getByteLength:{value:qr(xe.getVisitFnByTypeId(i))}})}return"Vector"})(k.prototype);var Vn=class extends k{constructor(t){super(t.data);let e=this.get,i=this.set,n=this.slice,r=new Array(this.length);Object.defineProperty(this,"get",{value(s){let a=r[s];if(a!==void 0)return a;let o=e.call(this,s);return r[s]=o,o}}),Object.defineProperty(this,"set",{value(s,a){i.call(this,s,a),r[s]=a}}),Object.defineProperty(this,"slice",{value:(s,a)=>new Vn(n.call(this,s,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new k(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}};function uu(t){if(!t||t.length<=0)return function(n){return!0};let e="",i=t.filter(n=>n===n);return i.length>0&&(e=`
    switch (x) {${i.map(n=>`
        case ${xm(n)}:`).join("")}
            return false;
    }`),t.length!==i.length&&(e=`if (x !== x) return false;
${e}`),new Function("x",`${e}
return true;`)}function xm(t){return typeof t!="bigint"?$e(t):ms?`${$e(t)}n`:`"${$e(t)}"`}var La=(t,e)=>(Math.ceil(t)*e+63&-64||64)/e,Bm=(t,e=0)=>t.length>=e?t.subarray(0,e):Rn(new t.constructor(e),t,0),Zr=class{constructor(t,e=1){this.buffer=t,this.stride=e,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t.constructor,this._resize(this.length=Math.ceil(t.length/e))}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,e){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;let e=this.stride,i=this.length*e,n=this.buffer.length;i>=n&&this._resize(n===0?La(i*1,this.BYTES_PER_ELEMENT):La(i*2,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=La(t*this.stride,this.BYTES_PER_ELEMENT);let e=Bm(this.buffer,t);return this.clear(),e}clear(){return this.length=0,this._resize(0),this}_resize(t){return this.buffer=Rn(new this.ArrayType(t),this.buffer)}};Zr.prototype.offset=0;var Ur=class extends Zr{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,e){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=e,this}},zn=class extends Ur{constructor(t=new Uint8Array(0)){super(t,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,e){let{buffer:i}=this.reserve(t-this.length+1),n=t>>3,r=t%8,s=i[n]>>r&1;return e?s===0&&(i[n]|=1<<r,++this.numValid):s===1&&(i[n]&=~(1<<r),--this.numValid),this}clear(){return this.numValid=0,super.clear()}},jn=class extends Ur{constructor(t=new Int32Array(1)){super(t,1)}append(t){return this.set(this.length-1,t)}set(t,e){let i=this.length-1,n=this.reserve(t-i+1).buffer;return i<t++&&n.fill(n[i],i,t),n[t]=n[t-1]+e,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,0),super.flush(t+1)}},bt=class{constructor({type:t,nullValues:e}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=e,this.stride=Ae(t),this._nulls=new zn,e&&e.length>0&&(this._isValid=uu(e))}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}toVector(){return new k([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0,{_offsets:e,_values:i,_nulls:n,_typeIds:r,children:s}=this;return e&&(t+=e.byteLength),i&&(t+=i.byteLength),n&&(t+=n.byteLength),r&&(t+=r.byteLength),s.reduce((a,o)=>a+o.byteLength,t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce((e,i)=>e+i.reservedByteLength,t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,e){return this.setValid(t,this.isValid(e))&&this.setValue(t,e),this}setValue(t,e){this._setValue(this,t,e)}setValid(t,e){return this.length=this._nulls.set(t,+e).length,e}addChild(t,e=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,e,i,n,{type:r,length:s,nullCount:a,_typeIds:o,_offsets:u,_values:d,_nulls:p}=this;(e=o==null?void 0:o.flush(s))?n=u==null?void 0:u.flush(s):(n=u==null?void 0:u.flush(s))?t=d==null?void 0:d.flush(u.last()):t=d==null?void 0:d.flush(s),a>0&&(i=p==null?void 0:p.flush(s));let v=this.children.map(Z=>Z.flush());return this.clear(),C({type:r,length:s,nullCount:a,children:v,child:v[0],data:t,typeIds:e,nullBitmap:i,valueOffsets:n})}finish(){this.finished=!0;for(let t of this.children)t.finish();return this}clear(){var t,e,i,n;this.length=0,(t=this._nulls)===null||t===void 0||t.clear(),(e=this._values)===null||e===void 0||e.clear(),(i=this._offsets)===null||i===void 0||i.clear(),(n=this._typeIds)===null||n===void 0||n.clear();for(let r of this.children)r.clear();return this}};bt.prototype.length=1,bt.prototype.stride=1,bt.prototype.children=null,bt.prototype.finished=!1,bt.prototype.nullValues=null,bt.prototype._isValid=()=>!0;var Nt=class extends bt{constructor(t){super(t),this._values=new Ur(new this.ArrayType(0),this.stride)}setValue(t,e){let i=this._values;return i.reserve(t-i.length+1),super.setValue(t,e)}},ur=class extends bt{constructor(t){super(t),this._pendingLength=0,this._offsets=new jn}setValue(t,e){let i=this._pending||(this._pending=new Map),n=i.get(t);n&&(this._pendingLength-=n.length),this._pendingLength+=e instanceof cr?e[Le].length:e.length,i.set(t,e)}setValid(t,e){return super.setValid(t,e)?!0:((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let t=this._pending,e=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,e),this}},bn=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,i,n){return t.prep(8,24),t.writeInt64(n),t.pad(4),t.writeInt32(i),t.writeInt64(e),t.offset()}},dr=new Int32Array(2),eo=new Float32Array(dr.buffer),ro=new Float64Array(dr.buffer),Wn=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,Et=class{constructor(t,e){this.low=t|0,this.high=e|0}static create(t,e){return t==0&&e==0?Et.ZERO:new Et(t,e)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}};Et.ZERO=new Et(0,0);var wi;(function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"})(wi||(wi={}));var se=class{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new se(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new Et(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new Et(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return dr[0]=this.readInt32(t),eo[0]}readFloat64(t){return dr[Wn?0:1]=this.readInt32(t),dr[Wn?1:0]=this.readInt32(t+4),ro[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){eo[0]=e,this.writeInt32(t,dr[0])}writeFloat64(t,e){ro[0]=e,this.writeInt32(t,dr[Wn?0:1]),this.writeInt32(t+4,dr[Wn?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){let i=t-this.readInt32(t);return e<this.readInt16(i)?this.readInt16(i+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);let i=this.readInt32(t),n="",r=0;if(t+=4,e===wi.UTF8_BYTES)return this.bytes_.subarray(t,t+i);for(;r<i;){let s,a=this.readUint8(t+r++);if(a<192)s=a;else{let o=this.readUint8(t+r++);if(a<224)s=(a&31)<<6|o&63;else{let u=this.readUint8(t+r++);if(a<240)s=(a&15)<<12|(o&63)<<6|u&63;else{let d=this.readUint8(t+r++);s=(a&7)<<18|(o&63)<<12|(u&63)<<6|d&63}}}s<65536?n+=String.fromCharCode(s):(s-=65536,n+=String.fromCharCode((s>>10)+55296,(s&1024-1)+56320))}return n}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createLong(t,e){return Et.create(t,e)}createScalarList(t,e){let i=[];for(let n=0;n<e;++n)t(n)!==null&&i.push(t(n));return i}createObjList(t,e){let i=[];for(let n=0;n<e;++n){let r=t(n);r!==null&&i.push(r.unpack())}return i}},Lr=class{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let e;t?e=t:e=1024,this.bb=se.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);let i=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<i+t+e;){let n=this.bb.capacity();this.bb=Lr.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n}this.pad(i)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,i){(this.force_defaults||e!=i)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,i){(this.force_defaults||e!=i)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,i){(this.force_defaults||e!=i)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,i){(this.force_defaults||!e.equals(i))&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,i){(this.force_defaults||e!=i)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,i){e!=i&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){let e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let i=e<<1,n=se.allocate(i);return n.setPosition(i-e),n.bytes().set(t.bytes(),i-e),n}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let t=this.offset(),e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);let i=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);let n=2;this.addInt16(t-this.object_start);let r=(i+n)*2;this.addInt16(r);let s=0,a=this.space;t:for(e=0;e<this.vtables.length;e++){let o=this.bb.capacity()-this.vtables[e];if(r==this.bb.readInt16(o)){for(let u=2;u<r;u+=2)if(this.bb.readInt16(a+u)!=this.bb.readInt16(o+u))continue t;s=this.vtables[e];break}}return s?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,s-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,i){let n=i?4:0;if(e){let r=e;if(this.prep(this.minalign,4+4+n),r.length!=4)throw new Error("FlatBuffers: file identifier must be length 4");for(let s=4-1;s>=0;s--)this.writeInt8(r.charCodeAt(s))}this.prep(this.minalign,4+n),this.addOffset(t),n&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){let i=this.bb.capacity()-t,n=i-this.bb.readInt32(i);if(this.bb.readInt16(n+e)==0)throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,i){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(i,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);let e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let i=0;for(;i<t.length;){let n,r=t.charCodeAt(i++);if(r<55296||r>=56320)n=r;else{let s=t.charCodeAt(i++);n=(r<<10)+s+(65536-56623104-56320)}n<128?e.push(n):(n<2048?e.push(n>>6&31|192):(n<65536?e.push(n>>12&15|224):e.push(n>>18&7|240,n>>12&63|128),e.push(n>>6&63|128)),e.push(n&63|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let i=0,n=this.space,r=this.bb.bytes();i<e.length;i++)r[n++]=e[i];return this.endVector()}createLong(t,e){return Et.create(t,e)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){let e=[];for(let i=0;i<t.length;++i){let n=t[i];if(n!==null)e.push(this.createObjectOffset(n));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}},pt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new pt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+4),(e||new pt).__init(t.readInt32(t.position())+t.position(),t)}key(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,i){return pt.startKeyValue(t),pt.addKey(t,e),pt.addValue(t,i),pt.endKeyValue(t)}},Qr;(function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"})(Qr||(Qr={}));var tn;(function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"})(tn||(tn={}));var vi;(function(t){t[t.DenseArray=0]="DenseArray"})(vi||(vi={}));var kt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new kt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+4),(e||new kt).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,i){return kt.startInt(t),kt.addBitWidth(t,e),kt.addIsSigned(t,i),kt.endInt(t)}},Be=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new Be).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+4),(e||new Be).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new kt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):vi.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,vi.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}},fr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new fr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+4),(e||new fr).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return fr.startBinary(t),fr.endBinary(t)}},hr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new hr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+4),(e||new hr).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return hr.startBool(t),hr.endBool(t)}},Si;(function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"})(Si||(Si={}));var fe=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new fe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+4),(e||new fe).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Si.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Si.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return fe.startDate(t),fe.addUnit(t,e),fe.endDate(t)}},Ct=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new Ct).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+4),(e||new Ct).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,i,n){return Ct.startDecimal(t),Ct.addPrecision(t,e),Ct.addScale(t,i),Ct.addBitWidth(t,n),Ct.endDecimal(t)}},en;(function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"})(en||(en={}));var he=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new he).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+4),(e||new he).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return he.startFixedSizeBinary(t),he.addByteWidth(t,e),he.endFixedSizeBinary(t)}},pe=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new pe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+4),(e||new pe).__init(t.readInt32(t.position())+t.position(),t)}listSize(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return pe.startFixedSizeList(t),pe.addListSize(t,e),pe.endFixedSizeList(t)}},Ii;(function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"})(Ii||(Ii={}));var me=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new me).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+4),(e||new me).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ii.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,Ii.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return me.startFloatingPoint(t),me.addPrecision(t,e),me.endFloatingPoint(t)}},Fi;(function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Fi||(Fi={}));var _e=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new _e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+4),(e||new _e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Fi.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Fi.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return _e.startInterval(t),_e.addUnit(t,e),_e.endInterval(t)}},pr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new pr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+4),(e||new pr).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return pr.startList(t),pr.endList(t)}},ye=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new ye).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+4),(e||new ye).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){let t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return ye.startMap(t),ye.addKeysSorted(t,e),ye.endMap(t)}},mr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new mr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+4),(e||new mr).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return mr.startNull(t),mr.endNull(t)}},_r=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new _r).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+4),(e||new _r).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return _r.startStruct_(t),_r.endStruct_(t)}},Gt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new Gt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+4),(e||new Gt).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):en.MILLISECOND}bitWidth(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,en.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,i){return Gt.startTime(t),Gt.addUnit(t,e),Gt.addBitWidth(t,i),Gt.endTime(t)}},Kt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new Kt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+4),(e||new Kt).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):en.SECOND}timezone(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,en.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,i){return Kt.startTimestamp(t),Kt.addUnit(t,e),Kt.addTimezone(t,i),Kt.endTimestamp(t)}},Ai;(function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"})(Ai||(Ai={}));var Pt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new Pt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+4),(e||new Pt).__init(t.readInt32(t.position())+t.position(),t)}mode(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ai.Sparse}typeIds(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+t*4):0}typeIdsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,Ai.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,i){return Pt.startUnion(t),Pt.addMode(t,e),Pt.addTypeIds(t,i),Pt.endUnion(t)}},yr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new yr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+4),(e||new yr).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return yr.startUtf8(t),yr.endUtf8(t)}},gt;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList"})(gt||(gt={}));var Ot=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new Ot).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+4),(e||new Ot).__init(t.readInt32(t.position())+t.position(),t)}name(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):gt.NONE}type(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){let e=this.bb.__offset(this.bb_pos,12);return e?(t||new Be).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){let i=this.bb.__offset(this.bb_pos,14);return i?(e||new Ot).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}childrenLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){let i=this.bb.__offset(this.bb_pos,16);return i?(e||new pt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,gt.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}},St=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new St).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+4),(e||new St).__init(t.readInt32(t.position())+t.position(),t)}endianness(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):tn.Little}fields(t,e){let i=this.bb.__offset(this.bb_pos,6);return i?(e||new Ot).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}fieldsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){let i=this.bb.__offset(this.bb_pos,8);return i?(e||new pt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+t*8):this.bb.createLong(0,0)}featuresLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,tn.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let i=e.length-1;i>=0;i--)t.addInt64(e[i]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,i,n,r){return St.startSchema(t),St.addEndianness(t,e),St.addFields(t,i),St.addCustomMetadata(t,n),St.addFeatures(t,r),St.endSchema(t)}},Jt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new Jt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+4),(e||new Jt).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Qr.V1}schema(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new St).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){let i=this.bb.__offset(this.bb_pos,8);return i?(e||new bn).__init(this.bb.__vector(this.bb_pos+i)+t*24,this.bb):null}dictionariesLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){let i=this.bb.__offset(this.bb_pos,10);return i?(e||new bn).__init(this.bb.__vector(this.bb_pos+i)+t*24,this.bb):null}recordBatchesLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){let i=this.bb.__offset(this.bb_pos,12);return i?(e||new pt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Qr.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}},G=class{constructor(t=[],e,i){this.fields=t||[],this.metadata=e||new Map,i||(i=Na(t)),this.dictionaries=i}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,e)=>`${e}: ${t}`).join(", ")} }>`}select(t){let e=new Set(t),i=this.fields.filter(n=>e.has(n.name));return new G(i,this.metadata)}selectAt(t){let e=t.map(i=>this.fields[i]).filter(Boolean);return new G(e,this.metadata)}assign(...t){let e=t[0]instanceof G?t[0]:Array.isArray(t[0])?new G(t[0]):new G(t),i=[...this.fields],n=io(io(new Map,this.metadata),e.metadata),r=e.fields.filter(a=>{let o=i.findIndex(u=>u.name===a.name);return~o?(i[o]=a.clone({metadata:io(io(new Map,i[o].metadata),a.metadata)}))&&!1:!0}),s=Na(r,new Map);return new G([...i,...r],n,new Map([...this.dictionaries,...s]))}};G.prototype.fields=null,G.prototype.metadata=null,G.prototype.dictionaries=null;var V=class{constructor(t,e,i=!1,n){this.name=t,this.type=e,this.nullable=i,this.metadata=n||new Map}static new(...t){let[e,i,n,r]=t;return t[0]&&typeof t[0]=="object"&&({name:e}=t[0],i===void 0&&(i=t[0].type),n===void 0&&(n=t[0].nullable),r===void 0&&(r=t[0].metadata)),new V(`${e}`,i,n,r)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,i,n,r]=t;return!t[0]||typeof t[0]!="object"?[e=this.name,i=this.type,n=this.nullable,r=this.metadata]=t:{name:e=this.name,type:i=this.type,nullable:n=this.nullable,metadata:r=this.metadata}=t[0],V.new(e,i,n,r)}};V.prototype.type=null,V.prototype.name=null,V.prototype.nullable=null,V.prototype.metadata=null;function io(t,e){return new Map([...t||new Map,...e||new Map])}function Na(t,e=new Map){for(let i=-1,n=t.length;++i<n;){let r=t[i].type;if(B.isDictionary(r)){if(!e.has(r.id))e.set(r.id,r.dictionary);else if(e.get(r.id)!==r.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}r.children&&r.children.length>0&&Na(r.children,e)}return e}var du=Et,Tm=Lr,Dm=se,Nr=class{constructor(t,e=Lt.V4,i,n){this.schema=t,this.version=e,i&&(this._recordBatches=i),n&&(this._dictionaryBatches=n)}static decode(t){t=new Dm(L(t));let e=Jt.getRootAsFooter(t),i=G.decode(e.schema());return new ka(i,e)}static encode(t){let e=new Tm,i=G.encode(e,t.schema);Jt.startRecordBatchesVector(e,t.numRecordBatches);for(let s of[...t.recordBatches()].slice().reverse())tr.encode(e,s);let n=e.endVector();Jt.startDictionariesVector(e,t.numDictionaries);for(let s of[...t.dictionaryBatches()].slice().reverse())tr.encode(e,s);let r=e.endVector();return Jt.startFooter(e),Jt.addSchema(e,i),Jt.addVersion(e,Lt.V4),Jt.addRecordBatches(e,n),Jt.addDictionaries(e,r),Jt.finishFooterBuffer(e,Jt.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,i=this.numRecordBatches;++e<i;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,i=this.numDictionaries;++e<i;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}},ka=class extends Nr{constructor(t,e){super(t,e.version()),this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){let e=this._footer.recordBatches(t);if(e)return tr.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){let e=this._footer.dictionaries(t);if(e)return tr.decode(e)}return null}},tr=class{constructor(t,e,i){this.metaDataLength=t,this.offset=typeof i=="number"?i:i.low,this.bodyLength=typeof e=="number"?e:e.low}static decode(t){return new tr(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){let{metaDataLength:i}=e,n=new du(e.offset,0),r=new du(e.bodyLength,0);return bn.createBlock(t,n,i,r)}},mt=Object.freeze({done:!0,value:void 0}),xi=class{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}},gn=class{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}},so=class extends gn{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return I(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){let{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(mt);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return jt.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return jt.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return I(this,void 0,void 0,function*(){return yield this.abort(t),mt})}return(t){return I(this,void 0,void 0,function*(){return yield this.close(),mt})}read(t){return I(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return I(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((e,i)=>{this.resolvers.push({resolve:e,reject:i})}):Promise.resolve(mt)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}},br=class extends so{write(t){if((t=L(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?di(this.toUint8Array(!0)):this.toUint8Array(!1).then(di)}toUint8Array(t=!1){return t?Ie(this._values)[0]:(()=>I(this,void 0,void 0,function*(){var e,i;let n=[],r=0;try{for(var s=Ee(this),a;a=yield s.next(),!a.done;){let o=a.value;n.push(o),r+=o.byteLength}}catch(o){e={error:o}}finally{try{a&&!a.done&&(i=s.return)&&(yield i.call(s))}finally{if(e)throw e.error}}return Ie(n,r)[0]}))()}},gr=class{constructor(t){t&&(this.source=new Ca(jt.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},be=class{constructor(t){t instanceof be?this.source=t.source:t instanceof br?this.source=new kr(jt.fromAsyncIterable(t)):vs(t)?this.source=new kr(jt.fromNodeStream(t)):fi(t)?this.source=new kr(jt.fromDOMStream(t)):gs(t)?this.source=new kr(jt.fromDOMStream(t.body)):je(t)?this.source=new kr(jt.fromIterable(t)):ze(t)?this.source=new kr(jt.fromAsyncIterable(t)):Me(t)&&(this.source=new kr(jt.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},Ca=class{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||mt)}return(t){return Object.create(this.source.return&&this.source.return(t)||mt)}},kr=class{constructor(t){this.source=t,this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}cancel(t){return I(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return I(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return I(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,e="read"){return I(this,void 0,void 0,function*(){return yield this.source.next({cmd:e,size:t})})}throw(t){return I(this,void 0,void 0,function*(){let e=this.source.throw&&(yield this.source.throw(t))||mt;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}return(t){return I(this,void 0,void 0,function*(){let e=this.source.return&&(yield this.source.return(t))||mt;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}},Bi=class extends gr{constructor(t,e){super(),this.position=0,this.buffer=L(t),this.size=typeof e>"u"?this.buffer.byteLength:e}readInt32(t){let{buffer:e,byteOffset:i}=this.readAt(t,4);return new DataView(e,i).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){let{buffer:e,size:i,position:n}=this;return e&&n<i?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(i,n+Math.min(i-n,t)),e.subarray(n,this.position)):null}readAt(t,e){let i=this.buffer,n=Math.min(this.size,t+e);return i?i.subarray(t,n):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}},rn=class extends be{constructor(t,e){super(),this.position=0,this._handle=t,typeof e=="number"?this.size=e:this._pending=(()=>I(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending}))()}readInt32(t){return I(this,void 0,void 0,function*(){let{buffer:e,byteOffset:i}=yield this.readAt(t,4);return new DataView(e,i).getInt32(0,!0)})}seek(t){return I(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return I(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:e,size:i,position:n}=this;if(e&&n<i){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let r=n,s=0,a=0,o=Math.min(i,r+Math.min(i-r,t)),u=new Uint8Array(Math.max(0,(this.position=o)-r));for(;(r+=a)<o&&(s+=a)<u.byteLength;)({bytesRead:a}=yield e.read(u,s,u.byteLength-s,r));return u}return null})}readAt(t,e){return I(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:i,size:n}=this;if(i&&t+e<n){let r=Math.min(n,t+e),s=new Uint8Array(r-t);return(yield i.read(s,0,e,t)).buffer}return new Uint8Array(e)})}close(){return I(this,void 0,void 0,function*(){let t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return I(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return I(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}},Ha={};dn(Ha,{BaseInt64:()=>Ti,Int128:()=>ge,Int64:()=>Ht,Uint64:()=>it});function $n(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}var Yn=8,Pa=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],Ti=class{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){let e=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),i=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]),n=e[3]*i[3];this.buffer[0]=n&65535;let r=n>>>16;return n=e[2]*i[3],r+=n,n=e[3]*i[2]>>>0,r+=n,this.buffer[0]+=r<<16,this.buffer[1]=r>>>0<n?65536:0,this.buffer[1]+=r>>>16,this.buffer[1]+=e[1]*i[3]+e[2]*i[2]+e[3]*i[1],this.buffer[1]+=e[0]*i[3]+e[1]*i[2]+e[2]*i[1]+e[3]*i[0]<<16,this}_plus(t){let e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${$n(this.buffer[1])} ${$n(this.buffer[0])}`}},it=class extends Ti{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return it.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return it.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){let i=t.length,n=new it(e);for(let r=0;r<i;){let s=Yn<i-r?Yn:i-r,a=new it(new Uint32Array([Number.parseInt(t.slice(r,r+s),10),0])),o=new it(new Uint32Array([Pa[s],0]));n.times(o),n.plus(a),r+=s}return n}static convertArray(t){let e=new Uint32Array(t.length*2);for(let i=-1,n=t.length;++i<n;)it.from(t[i],new Uint32Array(e.buffer,e.byteOffset+2*i*4,2));return e}static multiply(t,e){return new it(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new it(new Uint32Array(t.buffer)).plus(e)}},Ht=class extends Ti{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){let e=this.buffer[1]<<0,i=t.buffer[1]<<0;return e<i||e===i&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return Ht.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return Ht.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){let i=t.startsWith("-"),n=t.length,r=new Ht(e);for(let s=i?1:0;s<n;){let a=Yn<n-s?Yn:n-s,o=new Ht(new Uint32Array([Number.parseInt(t.slice(s,s+a),10),0])),u=new Ht(new Uint32Array([Pa[a],0]));r.times(u),r.plus(o),s+=a}return i?r.negate():r}static convertArray(t){let e=new Uint32Array(t.length*2);for(let i=-1,n=t.length;++i<n;)Ht.from(t[i],new Uint32Array(e.buffer,e.byteOffset+2*i*4,2));return e}static multiply(t,e){return new Ht(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Ht(new Uint32Array(t.buffer)).plus(e)}},ge=class{constructor(t){this.buffer=t}high(){return new Ht(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Ht(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){let e=new it(new Uint32Array([this.buffer[3],0])),i=new it(new Uint32Array([this.buffer[2],0])),n=new it(new Uint32Array([this.buffer[1],0])),r=new it(new Uint32Array([this.buffer[0],0])),s=new it(new Uint32Array([t.buffer[3],0])),a=new it(new Uint32Array([t.buffer[2],0])),o=new it(new Uint32Array([t.buffer[1],0])),u=new it(new Uint32Array([t.buffer[0],0])),d=it.multiply(r,u);this.buffer[0]=d.low();let p=new it(new Uint32Array([d.high(),0]));return d=it.multiply(n,u),p.plus(d),d=it.multiply(r,o),p.plus(d),this.buffer[1]=p.low(),this.buffer[3]=p.lessThan(d)?1:0,this.buffer[2]=p.high(),new it(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(it.multiply(i,u)).plus(it.multiply(n,o)).plus(it.multiply(r,a)),this.buffer[3]+=it.multiply(e,u).plus(it.multiply(i,o)).plus(it.multiply(n,a)).plus(it.multiply(r,s)).low(),this}plus(t){let e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${$n(this.buffer[3])} ${$n(this.buffer[2])} ${$n(this.buffer[1])} ${$n(this.buffer[0])}`}static multiply(t,e){return new ge(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new ge(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return ge.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return ge.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){let i=t.startsWith("-"),n=t.length,r=new ge(e);for(let s=i?1:0;s<n;){let a=Yn<n-s?Yn:n-s,o=new ge(new Uint32Array([Number.parseInt(t.slice(s,s+a),10),0,0,0])),u=new ge(new Uint32Array([Pa[a],0,0,0]));r.times(u),r.plus(o),s+=a}return i?r.negate():r}static convertArray(t){let e=new Uint32Array(t.length*4);for(let i=-1,n=t.length;++i<n;)ge.from(t[i],new Uint32Array(e.buffer,e.byteOffset+4*4*i,4));return e}},Di=class extends D{constructor(t,e,i,n){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=i,this.dictionaries=n}visit(t){return super.visit(t instanceof V?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return C({type:t,length:e})}visitBool(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitInt(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDate(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTime(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitList(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===vt.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:i}=this.nextFieldNode()){return C({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,i=this.nextBufferRange()){return e>0&&this.readData(t,i)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+e)}readDictionary(t){return this.dictionaries.get(t.id)}},oo=class extends Di{constructor(t,e,i,n){super(new Uint8Array(0),e,i,n),this.sources=t}readNullBitmap(t,e,{offset:i}=this.nextBufferRange()){return e<=0?new Uint8Array(0):mn(this.sources[i])}readOffsets(t,{offset:e}=this.nextBufferRange()){return $(Uint8Array,$(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return $(Uint8Array,$(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){let{sources:i}=this;return B.isTimestamp(t)||(B.isInt(t)||B.isTime(t))&&t.bitWidth===64||B.isDate(t)&&t.unit===Wt.MILLISECOND?$(Uint8Array,Ht.convertArray(i[e])):B.isDecimal(t)?$(Uint8Array,ge.convertArray(i[e])):B.isBinary(t)||B.isFixedSizeBinary(t)?Em(i[e]):B.isBool(t)?mn(i[e]):B.isUtf8(t)?Yr(i[e].join("")):$(Uint8Array,$(t.ArrayType,i[e].map(n=>+n)))}};function Em(t){let e=t.join(""),i=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)i[n>>1]=Number.parseInt(e.slice(n,n+2),16);return i}var Xn=class extends ur{constructor(t){super(t),this._values=new Zr(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,L(e))}_flushPending(t,e){let i=this._offsets,n=this._values.reserve(e).buffer,r=0;for(let[s,a]of t)if(a===void 0)i.set(s,0);else{let o=a.length;n.set(a,r),i.set(s,o),r+=o}}},ao=class extends bt{constructor(t){super(t),this._values=new zn}setValue(t,e){this._values.set(t,+e)}},wn=class extends Nt{};wn.prototype._setValue=va;var Ei=class extends wn{};Ei.prototype._setValue=Ls;var Oi=class extends wn{};Oi.prototype._setValue=Ns;var Ri=class extends Nt{};Ri.prototype._setValue=Fa;var co=class extends bt{constructor({type:t,nullValues:e,dictionaryHashFunction:i}){super({type:new Fe(t.dictionary,t.indices,t.id,t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=vn({type:this.type.indices,nullValues:e}),this.dictionary=vn({type:this.type.dictionary,nullValues:null}),typeof i=="function"&&(this.valueToKey=i)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,e){let i=this.indices;return e=i.setValid(t,e),this.length=i.length,e}setValue(t,e){let i=this._keysToIndices,n=this.valueToKey(e),r=i[n];return r===void 0&&(i[n]=r=this._dictionaryOffset+this.dictionary.append(e).length-1),this.indices.setValue(t,r)}flush(){let t=this.type,e=this._dictionary,i=this.dictionary.toVector(),n=this.indices.flush().clone(t);return n.dictionary=e?e.concat(i):i,this.finished||(this._dictionaryOffset+=i.length),this._dictionary=n.dictionary,this.clear(),n}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return typeof t=="string"?t:`${t}`}},Mi=class extends Nt{};Mi.prototype._setValue=wa;var lo=class extends bt{setValue(t,e){let[i]=this.children,n=t*this.stride;for(let r=-1,s=e.length;++r<s;)i.set(n+r,e[r])}addChild(t,e="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let i=this.children.push(t);return this.type=new Je(this.type.listSize,new V(e,t.type,!0)),i}},Sn=class extends Nt{setValue(t,e){this._values.set(t,e)}},uo=class extends Sn{setValue(t,e){super.setValue(t,mi(e))}},fo=class extends Sn{},ho=class extends Sn{},In=class extends Nt{};In.prototype._setValue=Aa;var Ui=class extends In{};Ui.prototype._setValue=$s;var Li=class extends In{};Li.prototype._setValue=Ys;var ke=class extends Nt{setValue(t,e){this._values.set(t,e)}},po=class extends ke{},mo=class extends ke{},_o=class extends ke{},yo=class extends ke{},bo=class extends ke{},go=class extends ke{},wo=class extends ke{},vo=class extends ke{},So=class extends ur{constructor(t){super(t),this._offsets=new jn}addChild(t,e="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Ge(new V(e,t.type,!0)),this.numChildren-1}_flushPending(t){let e=this._offsets,[i]=this.children;for(let[n,r]of t)if(typeof r>"u")e.set(n,0);else{let s=r.length,a=e.set(n,s).buffer[n];for(let o=-1;++o<s;)i.set(a+o,r[o])}}},Io=class extends ur{set(t,e){return super.set(t,e)}setValue(t,e){let i=e instanceof Map?e:new Map(Object.entries(e)),n=this._pending||(this._pending=new Map),r=n.get(t);r&&(this._pendingLength-=r.size),this._pendingLength+=i.size,n.set(t,i)}addChild(t,e=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new qe(new V(e,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){let e=this._offsets,[i]=this.children;for(let[n,r]of t)if(r===void 0)e.set(n,0);else{let{[n]:s,[n+1]:a}=e.set(n,r.size).buffer;for(let o of r.entries())if(i.set(s,o),++s>=a)break}}},Fo=class extends bt{setValue(t,e){}setValid(t,e){return this.length=Math.max(t+1,this.length),e}},Ao=class extends bt{setValue(t,e){let{children:i,type:n}=this;switch(Array.isArray(e)||e.constructor){case!0:return n.children.forEach((r,s)=>i[s].set(t,e[s]));case Map:return n.children.forEach((r,s)=>i[s].set(t,e.get(r.name)));default:return n.children.forEach((r,s)=>i[s].set(t,e[r.name]))}}setValid(t,e){return super.setValid(t,e)||this.children.forEach(i=>i.setValid(t,e)),e}addChild(t,e=`${this.numChildren}`){let i=this.children.push(t);return this.type=new ht([...this.type.children,new V(e,t.type,!0)]),i}},Cr=class extends Nt{};Cr.prototype._setValue=Sa;var Ni=class extends Cr{};Ni.prototype._setValue=ks;var ki=class extends Cr{};ki.prototype._setValue=Cs;var Ci=class extends Cr{};Ci.prototype._setValue=Ps;var Pi=class extends Cr{};Pi.prototype._setValue=Hs;var Pr=class extends Nt{};Pr.prototype._setValue=Ia;var Hi=class extends Pr{};Hi.prototype._setValue=Vs;var Vi=class extends Pr{};Vi.prototype._setValue=zs;var zi=class extends Pr{};zi.prototype._setValue=js;var ji=class extends Pr{};ji.prototype._setValue=Ws;var Gn=class extends bt{constructor(t){super(t),this._typeIds=new Ur(new Int8Array(0),1),typeof t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,e){return this.set(this.length,t,e)}set(t,e,i){return i===void 0&&(i=this._valueToChildTypeId(this,e,t)),this.setValid(t,this.isValid(e))&&this.setValue(t,e,i),this}setValue(t,e,i){this._typeIds.set(t,i);let n=this.type.typeIdToChildIndex[i],r=this.children[n];r==null||r.set(t,e)}addChild(t,e=`${this.children.length}`){let i=this.children.push(t),{type:{children:n,mode:r,typeIds:s}}=this,a=[...n,new V(e,t.type)];return this.type=new Ke(r,[...s,i],a),i}_valueToChildTypeId(t,e,i){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}},xo=class extends Gn{},Bo=class extends Gn{constructor(t){super(t),this._offsets=new Ur(new Int32Array(0))}setValue(t,e,i){let n=this._typeIds.set(t,i).buffer[t],r=this.getChildAt(this.type.typeIdToChildIndex[n]),s=this._offsets.set(t,r.length).buffer[t];r==null||r.set(s,e)}},Wi=class extends ur{constructor(t){super(t),this._values=new Zr(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,Yr(e))}_flushPending(t,e){}};Wi.prototype._flushPending=Xn.prototype._flushPending;var Va=class extends D{visitNull(){return Fo}visitBool(){return ao}visitInt(){return ke}visitInt8(){return po}visitInt16(){return mo}visitInt32(){return _o}visitInt64(){return yo}visitUint8(){return bo}visitUint16(){return go}visitUint32(){return wo}visitUint64(){return vo}visitFloat(){return Sn}visitFloat16(){return uo}visitFloat32(){return fo}visitFloat64(){return ho}visitUtf8(){return Wi}visitBinary(){return Xn}visitFixedSizeBinary(){return Mi}visitDate(){return wn}visitDateDay(){return Ei}visitDateMillisecond(){return Oi}visitTimestamp(){return Cr}visitTimestampSecond(){return Ni}visitTimestampMillisecond(){return ki}visitTimestampMicrosecond(){return Ci}visitTimestampNanosecond(){return Pi}visitTime(){return Pr}visitTimeSecond(){return Hi}visitTimeMillisecond(){return Vi}visitTimeMicrosecond(){return zi}visitTimeNanosecond(){return ji}visitDecimal(){return Ri}visitList(){return So}visitStruct(){return Ao}visitUnion(){return Gn}visitDenseUnion(){return Bo}visitSparseUnion(){return xo}visitDictionary(){return co}visitInterval(){return In}visitIntervalDayTime(){return Ui}visitIntervalYearMonth(){return Li}visitFixedSizeList(){return lo}visitMap(){return Io}},fu=new Va,U=class extends D{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((i,n)=>this.compareFields(i,e[n]))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}};function we(t,e){return e instanceof t.constructor}function $i(t,e){return t===e||we(t,e)}function Hr(t,e){return t===e||we(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function To(t,e){return t===e||we(t,e)&&t.precision===e.precision}function Om(t,e){return t===e||we(t,e)&&t.byteWidth===e.byteWidth}function za(t,e){return t===e||we(t,e)&&t.unit===e.unit}function Yi(t,e){return t===e||we(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function Xi(t,e){return t===e||we(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function Rm(t,e){return t===e||we(t,e)&&t.children.length===e.children.length&&wr.compareManyFields(t.children,e.children)}function Mm(t,e){return t===e||we(t,e)&&t.children.length===e.children.length&&wr.compareManyFields(t.children,e.children)}function ja(t,e){return t===e||we(t,e)&&t.mode===e.mode&&t.typeIds.every((i,n)=>i===e.typeIds[n])&&wr.compareManyFields(t.children,e.children)}function Um(t,e){return t===e||we(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&wr.visit(t.indices,e.indices)&&wr.visit(t.dictionary,e.dictionary)}function Wa(t,e){return t===e||we(t,e)&&t.unit===e.unit}function Lm(t,e){return t===e||we(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&wr.compareManyFields(t.children,e.children)}function Nm(t,e){return t===e||we(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&wr.compareManyFields(t.children,e.children)}U.prototype.visitNull=$i,U.prototype.visitBool=$i,U.prototype.visitInt=Hr,U.prototype.visitInt8=Hr,U.prototype.visitInt16=Hr,U.prototype.visitInt32=Hr,U.prototype.visitInt64=Hr,U.prototype.visitUint8=Hr,U.prototype.visitUint16=Hr,U.prototype.visitUint32=Hr,U.prototype.visitUint64=Hr,U.prototype.visitFloat=To,U.prototype.visitFloat16=To,U.prototype.visitFloat32=To,U.prototype.visitFloat64=To,U.prototype.visitUtf8=$i,U.prototype.visitBinary=$i,U.prototype.visitFixedSizeBinary=Om,U.prototype.visitDate=za,U.prototype.visitDateDay=za,U.prototype.visitDateMillisecond=za,U.prototype.visitTimestamp=Yi,U.prototype.visitTimestampSecond=Yi,U.prototype.visitTimestampMillisecond=Yi,U.prototype.visitTimestampMicrosecond=Yi,U.prototype.visitTimestampNanosecond=Yi,U.prototype.visitTime=Xi,U.prototype.visitTimeSecond=Xi,U.prototype.visitTimeMillisecond=Xi,U.prototype.visitTimeMicrosecond=Xi,U.prototype.visitTimeNanosecond=Xi,U.prototype.visitDecimal=$i,U.prototype.visitList=Rm,U.prototype.visitStruct=Mm,U.prototype.visitUnion=ja,U.prototype.visitDenseUnion=ja,U.prototype.visitSparseUnion=ja,U.prototype.visitDictionary=Um,U.prototype.visitInterval=Wa,U.prototype.visitIntervalDayTime=Wa,U.prototype.visitIntervalYearMonth=Wa,U.prototype.visitFixedSizeList=Lm,U.prototype.visitMap=Nm;var wr=new U;function Fn(t,e){return wr.compareSchemas(t,e)}function hu(t,e){return wr.compareFields(t,e)}function pu(t,e){return wr.visit(t,e)}function vn(t){let e=t.type,i=new(fu.getVisitFn(e)())(t);if(e.children&&e.children.length>0){let n=t.children||[],r={nullValues:t.nullValues},s=Array.isArray(n)?(a,o)=>n[o]||r:({name:a})=>n[a]||r;for(let[a,o]of e.children.entries()){let{type:u}=o,d=s(o,a);i.children.push(vn(Object.assign(Object.assign({},d),{type:u})))}}return i}function Do(t,e){return km(t,e.map(i=>i.data.concat()))}function km(t,e){let i=[...t.fields],n=[],r={numBatches:e.reduce((v,Z)=>Math.max(v,Z.length),0)},s=0,a=0,o=-1,u=e.length,d,p=[];for(;r.numBatches-- >0;){for(a=Number.POSITIVE_INFINITY,o=-1;++o<u;)p[o]=d=e[o].shift(),a=Math.min(a,d?d.length:a);Number.isFinite(a)&&(p=Cm(i,a,p,e,r),a>0&&(n[s++]=C({type:new ht(i),length:a,nullCount:0,children:p.slice()})))}return[t=t.assign(i),n.map(v=>new ft(t,v))]}function Cm(t,e,i,n,r){var s;let a=(e+63&-64)>>3;for(let o=-1,u=n.length;++o<u;){let d=i[o],p=d==null?void 0:d.length;if(p>=e)p===e?i[o]=d:(i[o]=d.slice(0,e),r.numBatches=Math.max(r.numBatches,n[o].unshift(d.slice(e,p-e))));else{let v=t[o];t[o]=v.clone({nullable:!0}),i[o]=(s=d==null?void 0:d._changeLengthAndBackfillNullBitmap(e))!==null&&s!==void 0?s:C({type:v.type,length:e,nullCount:e,nullBitmap:new Uint8Array(a)})}}return i}var mu,At=class{constructor(...t){var e,i;if(t.length===0)return this.batches=[],this.schema=new G([]),this._offsets=[0],this;let n,r;t[0]instanceof G&&(n=t.shift()),t[t.length-1]instanceof Uint32Array&&(r=t.pop());let s=o=>{if(o){if(o instanceof ft)return[o];if(o instanceof At)return o.batches;if(o instanceof nt){if(o.type instanceof ht)return[new ft(new G(o.type.children),o)]}else{if(Array.isArray(o))return o.flatMap(u=>s(u));if(typeof o[Symbol.iterator]=="function")return[...o].flatMap(u=>s(u));if(typeof o=="object"){let u=Object.keys(o),d=u.map(Z=>new k([o[Z]])),p=new G(u.map((Z,J)=>new V(String(Z),d[J].type))),[,v]=Do(p,d);return v.length===0?[new ft(o)]:v}}}return[]},a=t.flatMap(o=>s(o));if(n=(i=n??((e=a[0])===null||e===void 0?void 0:e.schema))!==null&&i!==void 0?i:new G([]),!(n instanceof G))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let o of a){if(!(o instanceof ft))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!Fn(n,o.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=n,this.batches=a,this._offsets=r??qs(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,e)=>t+e.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=Js(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?Hn.visit(new k(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){let e=this.schema,i=this.data.concat(t.flatMap(({data:n})=>n));return new At(e,i.map(n=>new ft(e,n)))}slice(t,e){let i=this.schema;[t,e]=_i({length:this.numRows},t,e);let n=Zs(this.data,this._offsets,t,e);return new At(i,n.map(r=>new ft(i,r)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(e=>e.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){let e=this.data.map(i=>i.children[t]);if(e.length===0){let{type:i}=this.schema.fields[t],n=C({type:i,length:0,nullCount:0});e.push(n._changeLengthAndBackfillNullBitmap(this.numRows))}return new k(e)}return null}setChild(t,e){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(n=>n.name===t),e)}setChildAt(t,e){let i=this.schema,n=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new k([C({type:new ie,length:this.numRows})]));let r=i.fields.slice(),s=r[t].clone({type:e.type}),a=this.schema.fields.map((o,u)=>this.getChildAt(u));[r[t],a[t]]=[s,e],[i,n]=Do(i,a)}return new At(i,n)}select(t){let e=this.schema.fields.reduce((i,n,r)=>i.set(n.name,r),new Map);return this.selectAt(t.map(i=>e.get(i)).filter(i=>i>-1))}selectAt(t){let e=this.schema.selectAt(t),i=this.batches.map(n=>n.selectAt(t));return new At(e,i)}assign(t){let e=this.schema.fields,[i,n]=t.schema.fields.reduce((a,o,u)=>{let[d,p]=a,v=e.findIndex(Z=>Z.name===o.name);return~v?p[v]=u:d.push(u),a},[[],[]]),r=this.schema.assign(t.schema),s=[...e.map((a,o)=>[o,n[o]]).map(([a,o])=>o===void 0?this.getChildAt(a):t.getChildAt(o)),...i.map(a=>t.getChildAt(a))].filter(Boolean);return new At(...Do(r,s))}};mu=Symbol.toStringTag,At[mu]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=qr(gi),t.get=qr(Dt.getVisitFn(f.Struct)),t.set=Qs($t.getVisitFn(f.Struct)),t.indexOf=to(yn.getVisitFn(f.Struct)),t.getByteLength=qr(xe.getVisitFn(f.Struct)),"Table"))(At.prototype);var yu,ft=class{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof G))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=C({nullCount:0,type:new ht(this.schema.fields),children:this.schema.fields.map(e=>C({type:e.type,nullCount:0}))})]=t,!(this.data instanceof nt))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=_u(this.schema,this.data.children);break}case 1:{let[e]=t,{fields:i,children:n,length:r}=Object.keys(e).reduce((o,u,d)=>(o.children[d]=e[u],o.length=Math.max(o.length,e[u].length),o.fields[d]=V.new({name:u,type:e[u].type,nullable:!0}),o),{length:0,fields:new Array,children:new Array}),s=new G(i),a=C({type:new ht(i),length:r,children:n,nullCount:0});[this.schema,this.data]=_u(s,a.children,r);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=bu(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return Dt.visit(this.data,t)}set(t,e){return $t.visit(this.data,t,e)}indexOf(t,e){return yn.visit(this.data,t,e)}getByteLength(t){return xe.visit(this.data,t)}[Symbol.iterator](){return Hn.visit(new k([this.data]))}toArray(){return[...this]}concat(...t){return new At(this.schema,[this,...t])}slice(t,e){let[i]=new k([this.data]).slice(t,e).data;return new ft(this.schema,i)}getChild(t){var e;return this.getChildAt((e=this.schema.fields)===null||e===void 0?void 0:e.findIndex(i=>i.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new k([this.data.children[t]]):null}setChild(t,e){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(n=>n.name===t),e)}setChildAt(t,e){let i=this.schema,n=this.data;if(t>-1&&t<this.numCols){e||(e=new k([C({type:new ie,length:this.numRows})]));let r=i.fields.slice(),s=n.children.slice(),a=r[t].clone({type:e.type});[r[t],s[t]]=[a,e.data[0]],i=new G(r,new Map(this.schema.metadata)),n=C({type:new ht(r),children:s})}return new ft(i,n)}select(t){let e=this.schema.select(t),i=new ht(e.fields),n=[];for(let r of t){let s=this.schema.fields.findIndex(a=>a.name===r);~s&&(n[s]=this.data.children[s])}return new ft(e,C({type:i,length:this.numRows,children:n}))}selectAt(t){let e=this.schema.selectAt(t),i=t.map(r=>this.data.children[r]).filter(Boolean),n=C({type:new ht(e.fields),length:this.numRows,children:i});return new ft(e,n)}};yu=Symbol.toStringTag,ft[yu]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(ft.prototype);function _u(t,e,i=e.reduce((n,r)=>Math.max(n,r.length),0)){var n;let r=[...t.fields],s=[...e],a=(i+63&-64)>>3;for(let[o,u]of t.fields.entries()){let d=e[o];(!d||d.length!==i)&&(r[o]=u.clone({nullable:!0}),s[o]=(n=d==null?void 0:d._changeLengthAndBackfillNullBitmap(i))!==null&&n!==void 0?n:C({type:u.type,length:i,nullCount:i,nullBitmap:new Uint8Array(a)}))}return[t.assign(r),C({type:new ht(r),length:i,children:s})]}function bu(t,e,i=new Map){for(let n=-1,r=t.length;++n<r;){let s=t[n].type,a=e[n];if(B.isDictionary(s)){if(!i.has(s.id))a.dictionary&&i.set(s.id,a.dictionary);else if(i.get(s.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&bu(s.children,a.children,i)}return i}var An=class extends ft{constructor(t){let e=t.fields.map(n=>C({type:n.type})),i=C({type:new ht(t.fields),nullCount:0,children:e});super(t,i)}},Gi;(function(t){t[t.BUFFER=0]="BUFFER"})(Gi||(Gi={}));var Ki;(function(t){t[t.LZ4_FRAME=0]="LZ4_FRAME",t[t.ZSTD=1]="ZSTD"})(Ki||(Ki={}));var er=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new er).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+4),(e||new er).__init(t.readInt32(t.position())+t.position(),t)}codec(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):Ki.LZ4_FRAME}method(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):Gi.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,Ki.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,Gi.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,i){return er.startBodyCompression(t),er.addCodec(t,e),er.addMethod(t,i),er.endBodyCompression(t)}},Kn=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,i){return t.prep(8,16),t.writeInt64(i),t.writeInt64(e),t.offset()}},Jn=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,i){return t.prep(8,16),t.writeInt64(i),t.writeInt64(e),t.offset()}},qt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new qt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+4),(e||new qt).__init(t.readInt32(t.position())+t.position(),t)}length(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){let i=this.bb.__offset(this.bb_pos,6);return i?(e||new Jn).__init(this.bb.__vector(this.bb_pos+i)+t*16,this.bb):null}nodesLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){let i=this.bb.__offset(this.bb_pos,8);return i?(e||new Kn).__init(this.bb.__vector(this.bb_pos+i)+t*16,this.bb):null}buffersLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){let e=this.bb.__offset(this.bb_pos,10);return e?(t||new er).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}},Ce=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new Ce).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+4),(e||new Ce).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new qt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}},qn;(function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"})(qn||(qn={}));var Bt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new Bt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+4),(e||new Bt).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Qr.V1}headerType(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):qn.NONE}header(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){let i=this.bb.__offset(this.bb_pos,12);return i?(e||new pt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Qr.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,qn.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,i,n,r,s){return Bt.startMessage(t),Bt.addVersion(t,e),Bt.addHeaderType(t,i),Bt.addHeader(t,n),Bt.addBodyLength(t,r),Bt.addCustomMetadata(t,s),Bt.endMessage(t)}},Hm=Et,$a=class extends D{visit(t,e){return t==null||e==null?void 0:super.visit(t,e)}visitNull(t,e){return mr.startNull(e),mr.endNull(e)}visitInt(t,e){return kt.startInt(e),kt.addBitWidth(e,t.bitWidth),kt.addIsSigned(e,t.isSigned),kt.endInt(e)}visitFloat(t,e){return me.startFloatingPoint(e),me.addPrecision(e,t.precision),me.endFloatingPoint(e)}visitBinary(t,e){return fr.startBinary(e),fr.endBinary(e)}visitBool(t,e){return hr.startBool(e),hr.endBool(e)}visitUtf8(t,e){return yr.startUtf8(e),yr.endUtf8(e)}visitDecimal(t,e){return Ct.startDecimal(e),Ct.addScale(e,t.scale),Ct.addPrecision(e,t.precision),Ct.addBitWidth(e,t.bitWidth),Ct.endDecimal(e)}visitDate(t,e){return fe.startDate(e),fe.addUnit(e,t.unit),fe.endDate(e)}visitTime(t,e){return Gt.startTime(e),Gt.addUnit(e,t.unit),Gt.addBitWidth(e,t.bitWidth),Gt.endTime(e)}visitTimestamp(t,e){let i=t.timezone&&e.createString(t.timezone)||void 0;return Kt.startTimestamp(e),Kt.addUnit(e,t.unit),i!==void 0&&Kt.addTimezone(e,i),Kt.endTimestamp(e)}visitInterval(t,e){return _e.startInterval(e),_e.addUnit(e,t.unit),_e.endInterval(e)}visitList(t,e){return pr.startList(e),pr.endList(e)}visitStruct(t,e){return _r.startStruct_(e),_r.endStruct_(e)}visitUnion(t,e){Pt.startTypeIdsVector(e,t.typeIds.length);let i=Pt.createTypeIdsVector(e,t.typeIds);return Pt.startUnion(e),Pt.addMode(e,t.mode),Pt.addTypeIds(e,i),Pt.endUnion(e)}visitDictionary(t,e){let i=this.visit(t.indices,e);return Be.startDictionaryEncoding(e),Be.addId(e,new Hm(t.id,0)),Be.addIsOrdered(e,t.isOrdered),i!==void 0&&Be.addIndexType(e,i),Be.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return he.startFixedSizeBinary(e),he.addByteWidth(e,t.byteWidth),he.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return pe.startFixedSizeList(e),pe.addListSize(e,t.listSize),pe.endFixedSizeList(e)}visitMap(t,e){return ye.startMap(e),ye.addKeysSorted(e,t.keysSorted),ye.endMap(e)}},Eo=new $a;function Su(t,e=new Map){return new G(Vm(t,e),Oo(t.customMetadata),e)}function Ya(t){return new Yt(t.count,Fu(t.columns),Au(t.columns))}function Iu(t){return new Se(Ya(t.data),t.id,t.isDelta)}function Vm(t,e){return(t.fields||[]).filter(Boolean).map(i=>V.fromJSON(i,e))}function gu(t,e){return(t.children||[]).filter(Boolean).map(i=>V.fromJSON(i,e))}function Fu(t){return(t||[]).reduce((e,i)=>[...e,new rr(i.count,zm(i.VALIDITY)),...Fu(i.children)],[])}function Au(t,e=[]){for(let i=-1,n=(t||[]).length;++i<n;){let r=t[i];r.VALIDITY&&e.push(new ve(e.length,r.VALIDITY.length)),r.TYPE&&e.push(new ve(e.length,r.TYPE.length)),r.OFFSET&&e.push(new ve(e.length,r.OFFSET.length)),r.DATA&&e.push(new ve(e.length,r.DATA.length)),e=Au(r.children,e)}return e}function zm(t){return(t||[]).reduce((e,i)=>e+ +(i===0),0)}function xu(t,e){let i,n,r,s,a,o;return!e||!(s=t.dictionary)?(a=vu(t,gu(t,e)),r=new V(t.name,a,t.nullable,Oo(t.customMetadata))):e.has(i=s.id)?(n=(n=s.indexType)?wu(n):new ar,o=new Fe(e.get(i),n,i,s.isOrdered),r=new V(t.name,o,t.nullable,Oo(t.customMetadata))):(n=(n=s.indexType)?wu(n):new ar,e.set(i,a=vu(t,gu(t,e))),o=new Fe(a,n,i,s.isOrdered),r=new V(t.name,o,t.nullable,Oo(t.customMetadata))),r||null}function Oo(t){return new Map(Object.entries(t||{}))}function wu(t){return new xt(t.isSigned,t.bitWidth)}function vu(t,e){let i=t.type.name;switch(i){case"NONE":return new ie;case"null":return new ie;case"binary":return new Ar;case"utf8":return new xr;case"bool":return new Br;case"list":return new Ge((e||[])[0]);case"struct":return new ht(e||[]);case"struct_":return new ht(e||[])}switch(i){case"int":{let n=t.type;return new xt(n.isSigned,n.bitWidth)}case"floatingpoint":{let n=t.type;return new de(yt[n.precision])}case"decimal":{let n=t.type;return new Tr(n.scale,n.precision,n.bitWidth)}case"date":{let n=t.type;return new Dr(Wt[n.unit])}case"time":{let n=t.type;return new Xe(X[n.unit],n.bitWidth)}case"timestamp":{let n=t.type;return new Er(X[n.unit],n.timezone)}case"interval":{let n=t.type;return new Or(ne[n.unit])}case"union":{let n=t.type;return new Ke(vt[n.mode],n.typeIds||[],e||[])}case"fixedsizebinary":{let n=t.type;return new Rr(n.byteWidth)}case"fixedsizelist":{let n=t.type;return new Je(n.listSize,(e||[])[0])}case"map":{let n=t.type;return new qe((e||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${i}"`)}var xn=Et,jm=Lr,Wm=se,Rt=class{constructor(t,e,i,n){this._version=e,this._headerType=i,this.body=new Uint8Array(0),n&&(this._createHeader=()=>n),this._bodyLength=typeof t=="number"?t:t.low}static fromJSON(t,e){let i=new Rt(0,Lt.V4,e);return i._createHeader=$m(t,e),i}static decode(t){t=new Wm(L(t));let e=Bt.getRootAsMessage(t),i=e.bodyLength(),n=e.version(),r=e.headerType(),s=new Rt(i,n,r);return s._createHeader=Ym(e,r),s}static encode(t){let e=new jm,i=-1;return t.isSchema()?i=G.encode(e,t.header()):t.isRecordBatch()?i=Yt.encode(e,t.header()):t.isDictionaryBatch()&&(i=Se.encode(e,t.header())),Bt.startMessage(e),Bt.addVersion(e,Lt.V4),Bt.addHeader(e,i),Bt.addHeaderType(e,t.headerType),Bt.addBodyLength(e,new xn(t.bodyLength,0)),Bt.finishMessageBuffer(e,Bt.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof G)return new Rt(0,Lt.V4,tt.Schema,t);if(t instanceof Yt)return new Rt(e,Lt.V4,tt.RecordBatch,t);if(t instanceof Se)return new Rt(e,Lt.V4,tt.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===tt.Schema}isRecordBatch(){return this.headerType===tt.RecordBatch}isDictionaryBatch(){return this.headerType===tt.DictionaryBatch}},Yt=class{constructor(t,e,i){this._nodes=e,this._buffers=i,this._length=typeof t=="number"?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}},Se=class{constructor(t,e,i=!1){this._data=t,this._isDelta=i,this._id=typeof e=="number"?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}},ve=class{constructor(t,e){this.offset=typeof t=="number"?t:t.low,this.length=typeof e=="number"?e:e.low}},rr=class{constructor(t,e){this.length=typeof t=="number"?t:t.low,this.nullCount=typeof e=="number"?e:e.low}};function $m(t,e){return()=>{switch(e){case tt.Schema:return G.fromJSON(t);case tt.RecordBatch:return Yt.fromJSON(t);case tt.DictionaryBatch:return Se.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${tt[e]}, type: ${e} }`)}}function Ym(t,e){return()=>{switch(e){case tt.Schema:return G.decode(t.header(new St));case tt.RecordBatch:return Yt.decode(t.header(new qt),t.version());case tt.DictionaryBatch:return Se.decode(t.header(new Ce),t.version())}throw new Error(`Unrecognized Message type: { name: ${tt[e]}, type: ${e} }`)}}V.encode=n_,V.decode=e_,V.fromJSON=xu,G.encode=r_,G.decode=Xm,G.fromJSON=Su,Yt.encode=i_,Yt.decode=Gm,Yt.fromJSON=Ya,Se.encode=s_,Se.decode=Km,Se.fromJSON=Iu,rr.encode=o_,rr.decode=qm,ve.encode=a_,ve.decode=Jm;function Xm(t,e=new Map){let i=t_(t,e);return new G(i,Ro(t),e)}function Gm(t,e=Lt.V4){if(t.compression()!==null)throw new Error("Record batch compression not implemented");return new Yt(t.length(),Zm(t),Qm(t,e))}function Km(t,e=Lt.V4){return new Se(Yt.decode(t.data(),e),t.id(),t.isDelta())}function Jm(t){return new ve(t.offset(),t.length())}function qm(t){return new rr(t.length(),t.nullCount())}function Zm(t){let e=[];for(let i,n=-1,r=-1,s=t.nodesLength();++n<s;)(i=t.nodes(n))&&(e[++r]=rr.decode(i));return e}function Qm(t,e){let i=[];for(let n,r=-1,s=-1,a=t.buffersLength();++r<a;)(n=t.buffers(r))&&(e<Lt.V4&&(n.bb_pos+=8*(r+1)),i[++s]=ve.decode(n));return i}function t_(t,e){let i=[];for(let n,r=-1,s=-1,a=t.fieldsLength();++r<a;)(n=t.fields(r))&&(i[++s]=V.decode(n,e));return i}function Bu(t,e){let i=[];for(let n,r=-1,s=-1,a=t.childrenLength();++r<a;)(n=t.children(r))&&(i[++s]=V.decode(n,e));return i}function e_(t,e){let i,n,r,s,a,o;return!e||!(o=t.dictionary())?(r=Du(t,Bu(t,e)),n=new V(t.name(),r,t.nullable(),Ro(t))):e.has(i=o.id().low)?(s=(s=o.indexType())?Tu(s):new ar,a=new Fe(e.get(i),s,i,o.isOrdered()),n=new V(t.name(),a,t.nullable(),Ro(t))):(s=(s=o.indexType())?Tu(s):new ar,e.set(i,r=Du(t,Bu(t,e))),a=new Fe(r,s,i,o.isOrdered()),n=new V(t.name(),a,t.nullable(),Ro(t))),n||null}function Ro(t){let e=new Map;if(t)for(let i,n,r=-1,s=Math.trunc(t.customMetadataLength());++r<s;)(i=t.customMetadata(r))&&(n=i.key())!=null&&e.set(n,i.value());return e}function Tu(t){return new xt(t.isSigned(),t.bitWidth())}function Du(t,e){let i=t.typeType();switch(i){case gt.NONE:return new ie;case gt.Null:return new ie;case gt.Binary:return new Ar;case gt.Utf8:return new xr;case gt.Bool:return new Br;case gt.List:return new Ge((e||[])[0]);case gt.Struct_:return new ht(e||[])}switch(i){case gt.Int:{let n=t.type(new kt);return new xt(n.isSigned(),n.bitWidth())}case gt.FloatingPoint:{let n=t.type(new me);return new de(n.precision())}case gt.Decimal:{let n=t.type(new Ct);return new Tr(n.scale(),n.precision(),n.bitWidth())}case gt.Date:{let n=t.type(new fe);return new Dr(n.unit())}case gt.Time:{let n=t.type(new Gt);return new Xe(n.unit(),n.bitWidth())}case gt.Timestamp:{let n=t.type(new Kt);return new Er(n.unit(),n.timezone())}case gt.Interval:{let n=t.type(new _e);return new Or(n.unit())}case gt.Union:{let n=t.type(new Pt);return new Ke(n.mode(),n.typeIdsArray()||[],e||[])}case gt.FixedSizeBinary:{let n=t.type(new he);return new Rr(n.byteWidth())}case gt.FixedSizeList:{let n=t.type(new pe);return new Je(n.listSize(),(e||[])[0])}case gt.Map:{let n=t.type(new ye);return new qe((e||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${gt[i]}" (${i})`)}function r_(t,e){let i=e.fields.map(s=>V.encode(t,s));St.startFieldsVector(t,i.length);let n=St.createFieldsVector(t,i),r=e.metadata&&e.metadata.size>0?St.createCustomMetadataVector(t,[...e.metadata].map(([s,a])=>{let o=t.createString(`${s}`),u=t.createString(`${a}`);return pt.startKeyValue(t),pt.addKey(t,o),pt.addValue(t,u),pt.endKeyValue(t)})):-1;return St.startSchema(t),St.addFields(t,n),St.addEndianness(t,c_?tn.Little:tn.Big),r!==-1&&St.addCustomMetadata(t,r),St.endSchema(t)}function n_(t,e){let i=-1,n=-1,r=-1,s=e.type,a=e.typeId;B.isDictionary(s)?(a=s.dictionary.typeId,r=Eo.visit(s,t),n=Eo.visit(s.dictionary,t)):n=Eo.visit(s,t);let o=(s.children||[]).map(p=>V.encode(t,p)),u=Ot.createChildrenVector(t,o),d=e.metadata&&e.metadata.size>0?Ot.createCustomMetadataVector(t,[...e.metadata].map(([p,v])=>{let Z=t.createString(`${p}`),J=t.createString(`${v}`);return pt.startKeyValue(t),pt.addKey(t,Z),pt.addValue(t,J),pt.endKeyValue(t)})):-1;return e.name&&(i=t.createString(e.name)),Ot.startField(t),Ot.addType(t,n),Ot.addTypeType(t,a),Ot.addChildren(t,u),Ot.addNullable(t,!!e.nullable),i!==-1&&Ot.addName(t,i),r!==-1&&Ot.addDictionary(t,r),d!==-1&&Ot.addCustomMetadata(t,d),Ot.endField(t)}function i_(t,e){let i=e.nodes||[],n=e.buffers||[];qt.startNodesVector(t,i.length);for(let a of i.slice().reverse())rr.encode(t,a);let r=t.endVector();qt.startBuffersVector(t,n.length);for(let a of n.slice().reverse())ve.encode(t,a);let s=t.endVector();return qt.startRecordBatch(t),qt.addLength(t,new xn(e.length,0)),qt.addNodes(t,r),qt.addBuffers(t,s),qt.endRecordBatch(t)}function s_(t,e){let i=Yt.encode(t,e.data);return Ce.startDictionaryBatch(t),Ce.addId(t,new xn(e.id,0)),Ce.addIsDelta(t,e.isDelta),Ce.addData(t,i),Ce.endDictionaryBatch(t)}function o_(t,e){return Jn.createFieldNode(t,new xn(e.length,0),new xn(e.nullCount,0))}function a_(t,e){return Kn.createBuffer(t,new xn(e.offset,0),new xn(e.length,0))}var c_=(()=>{let t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),new Int16Array(t)[0]===256})(),Ga=t=>`Expected ${tt[t]} Message in stream, but was null or length 0.`,Ka=t=>`Header pointer of flatbuffer-encoded ${tt[t]} Message is null or length 0.`,Eu=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,Ou=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`,Zn=class{constructor(t){this.source=t instanceof gr?t:new gr(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||t.value===-1&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?mt:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(Ga(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);let e=L(this.source.read(t));if(e.byteLength<t)throw new Error(Ou(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){let e=tt.Schema,i=this.readMessage(e),n=i==null?void 0:i.header();if(t&&!n)throw new Error(Ka(e));return n}readMetadataLength(){let t=this.source.read(Mo),e=t&&new se(t),i=(e==null?void 0:e.readInt32(0))||0;return{done:i===0,value:i}}readMetadata(t){let e=this.source.read(t);if(!e)return mt;if(e.byteLength<t)throw new Error(Eu(t,e.byteLength));return{done:!1,value:Rt.decode(e)}}},Ji=class{constructor(t,e){this.source=t instanceof be?t:bs(t)?new rn(t,e):new be(t)}[Symbol.asyncIterator](){return this}next(){return I(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done||t.value===-1&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?mt:t})}throw(t){return I(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return I(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return I(this,void 0,void 0,function*(){let e;if((e=yield this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(Ga(t));return e.value})}readMessageBody(t){return I(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);let e=L(yield this.source.read(t));if(e.byteLength<t)throw new Error(Ou(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()})}readSchema(t=!1){return I(this,void 0,void 0,function*(){let e=tt.Schema,i=yield this.readMessage(e),n=i==null?void 0:i.header();if(t&&!n)throw new Error(Ka(e));return n})}readMetadataLength(){return I(this,void 0,void 0,function*(){let t=yield this.source.read(Mo),e=t&&new se(t),i=(e==null?void 0:e.readInt32(0))||0;return{done:i===0,value:i}})}readMetadata(t){return I(this,void 0,void 0,function*(){let e=yield this.source.read(t);if(!e)return mt;if(e.byteLength<t)throw new Error(Eu(t,e.byteLength));return{done:!1,value:Rt.decode(e)}})}},qi=class extends Zn{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof xi?t:new xi(t)}next(){let{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:Rt.fromJSON(t.schema,tt.Schema)};if(this._dictionaryIndex<t.dictionaries.length){let e=t.dictionaries[this._dictionaryIndex++];return this._body=e.data.columns,{done:!1,value:Rt.fromJSON(e,tt.DictionaryBatch)}}if(this._batchIndex<t.batches.length){let e=t.batches[this._batchIndex++];return this._body=e.columns,{done:!1,value:Rt.fromJSON(e,tt.RecordBatch)}}return this._body=[],mt}readMessageBody(t){return e(this._body);function e(i){return(i||[]).reduce((n,r)=>[...n,...r.VALIDITY&&[r.VALIDITY]||[],...r.TYPE&&[r.TYPE]||[],...r.OFFSET&&[r.OFFSET]||[],...r.DATA&&[r.DATA]||[],...e(r.children)],[])}}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(Ga(t));return e.value}readSchema(){let t=tt.Schema,e=this.readMessage(t),i=e==null?void 0:e.header();if(!e||!i)throw new Error(Ka(t));return i}},Mo=4,Xa="ARROW1",Qn=new Uint8Array(Xa.length);for(let t=0;t<Xa.length;t+=1)Qn[t]=Xa.codePointAt(t);function Uo(t,e=0){for(let i=-1,n=Qn.length;++i<n;)if(Qn[i]!==t[e+i])return!1;return!0}var ti=Qn.length,Ja=ti+Mo,Ru=ti*2+Mo,Tt=class extends gn{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){let e=this._impl.open(t);return ze(e)?e.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return jt.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return jt.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof Tt?t:_s(t)?u_(t):bs(t)?h_(t):ze(t)?(()=>I(this,void 0,void 0,function*(){return yield Tt.from(yield t)}))():gs(t)||fi(t)||vs(t)||Me(t)?f_(new be(t)):d_(new gr(t))}static readAll(t){return t instanceof Tt?t.isSync()?Mu(t):Uu(t):_s(t)||ArrayBuffer.isView(t)||je(t)||ys(t)?Mu(t):Uu(t)}},vr=class extends Tt{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return ue(this,arguments,function*(){yield W(yield*On(Ee(this[Symbol.iterator]())))})}},nn=class extends Tt{constructor(t){super(t),this._impl=t}readAll(){var t,e;return I(this,void 0,void 0,function*(){let i=new Array;try{for(var n=Ee(this),r;r=yield n.next(),!r.done;){let s=r.value;i.push(s)}}catch(s){t={error:s}}finally{try{r&&!r.done&&(e=n.return)&&(yield e.call(n))}finally{if(t)throw t.error}}return i})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}},sn=class extends vr{constructor(t){super(t),this._impl=t}},Zi=class extends nn{constructor(t){super(t),this._impl=t}},Lo=class{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){let i=this._loadVectors(t,e,this.schema.fields),n=C({type:new ht(this.schema.fields),length:t.length,children:i});return new ft(this.schema,n)}_loadDictionaryBatch(t,e){let{id:i,isDelta:n}=t,{dictionaries:r,schema:s}=this,a=r.get(i);if(n||!a){let o=s.dictionaries.get(i),u=this._loadVectors(t.data,e,[o]);return(a&&n?a.concat(new k(u)):new k(u)).memoize()}return a.memoize()}_loadVectors(t,e,i){return new Di(e,t.nodes,t.buffers,this.dictionaries).visitMany(i)}},ei=class extends Lo{constructor(t,e){super(e),this._reader=_s(t)?new qi(this._handle=t):new Zn(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=Lu(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):mt}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):mt}next(){if(this.closed)return mt;let t,{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let i=t.header(),n=e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let i=t.header(),n=e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,r)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new An(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}},ri=class extends Lo{constructor(t,e){super(e),this._reader=new Ji(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return I(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return I(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=Lu(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return I(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):mt})}return(t){return I(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):mt})}next(){return I(this,void 0,void 0,function*(){if(this.closed)return mt;let t,{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let i=t.header(),n=yield e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let i=t.header(),n=yield e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,r)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new An(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return I(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}},No=class extends ei{constructor(t,e){super(t instanceof Bi?t:new Bi(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();let i=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(i&&this._handle.seek(i.offset)){let n=this._reader.readMessage(tt.RecordBatch);if(n!=null&&n.isRecordBatch()){let r=n.header(),s=this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(r,s)}}return null}_readDictionaryBatch(t){var e;let i=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(i&&this._handle.seek(i.offset)){let n=this._reader.readMessage(tt.DictionaryBatch);if(n!=null&&n.isDictionaryBatch()){let r=n.header(),s=this._reader.readMessageBody(n.bodyLength),a=this._loadDictionaryBatch(r,s);this.dictionaries.set(r.id,a)}}}_readFooter(){let{_handle:t}=this,e=t.size-Ja,i=t.readInt32(e),n=t.readAt(e-i,i);return Nr.decode(n)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let i=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(this._recordBatchIndex);if(i&&this._handle.seek(i.offset))return this._reader.readMessage(t)}return null}},qa=class extends ri{constructor(t,...e){let i=typeof e[0]!="number"?e.shift():void 0,n=e[0]instanceof Map?e.shift():void 0;super(t instanceof rn?t:new rn(t,i),n)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){let e=Object.create(null,{open:{get:()=>super.open}});return I(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(let i of this._footer.dictionaryBatches())i&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)})}readRecordBatch(t){var e;return I(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());let i=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(i&&(yield this._handle.seek(i.offset))){let n=yield this._reader.readMessage(tt.RecordBatch);if(n!=null&&n.isRecordBatch()){let r=n.header(),s=yield this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(r,s)}}return null})}_readDictionaryBatch(t){var e;return I(this,void 0,void 0,function*(){let i=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(i&&(yield this._handle.seek(i.offset))){let n=yield this._reader.readMessage(tt.DictionaryBatch);if(n!=null&&n.isDictionaryBatch()){let r=n.header(),s=yield this._reader.readMessageBody(n.bodyLength),a=this._loadDictionaryBatch(r,s);this.dictionaries.set(r.id,a)}}})}_readFooter(){return I(this,void 0,void 0,function*(){let{_handle:t}=this;t._pending&&(yield t._pending);let e=t.size-Ja,i=yield t.readInt32(e),n=yield t.readAt(e-i,i);return Nr.decode(n)})}_readNextMessageAndValidate(t){return I(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){let e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null})}},Za=class extends ei{constructor(t,e){super(t,e)}_loadVectors(t,e,i){return new oo(e,t.nodes,t.buffers,this.dictionaries).visitMany(i)}};function Lu(t,e){return e&&typeof e.autoDestroy=="boolean"?e.autoDestroy:t.autoDestroy}function*Mu(t){let e=Tt.from(t);try{if(!e.open({autoDestroy:!1}).closed)do yield e;while(!e.reset().open().closed)}finally{e.cancel()}}function Uu(t){return ue(this,arguments,function*(){let e=yield W(Tt.from(t));try{if(!(yield W(e.open({autoDestroy:!1}))).closed)do yield yield W(e);while(!(yield W(e.reset().open())).closed)}finally{yield W(e.cancel())}})}function u_(t){return new vr(new Za(t))}function d_(t){let e=t.peek(ti+7&-8);return e&&e.byteLength>=4?Uo(e)?new sn(new No(t.read())):new vr(new ei(t)):new vr(new ei(function*(){}()))}function f_(t){return I(this,void 0,void 0,function*(){let e=yield t.peek(ti+7&-8);return e&&e.byteLength>=4?Uo(e)?new sn(new No(yield t.read())):new nn(new ri(t)):new nn(new ri(function(){return ue(this,arguments,function*(){})}()))})}function h_(t){return I(this,void 0,void 0,function*(){let{size:e}=yield t.stat(),i=new rn(t,e);return e>=Ru&&Uo(yield i.readAt(0,ti+7&-8))?new Zi(new qa(i)):new nn(new ri(i))})}var It=class extends D{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...t){let e=n=>n.flatMap(r=>Array.isArray(r)?e(r):r instanceof ft?r.data.children:r.data),i=new It;return i.visitMany(e(t)),i}visit(t){if(t instanceof k)return this.visitMany(t.data),this;let{type:e}=t;if(!B.isDictionary(e)){let{length:i,nullCount:n}=t;if(i>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");B.isNull(e)||nr.call(this,n<=0?new Uint8Array(0):Pn(t.offset,i,t.nullBitmap)),this.nodes.push(new rr(i,n))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};function nr(t){let e=t.byteLength+7&-8;return this.buffers.push(t),this.bufferRegions.push(new ve(this._byteLength,e)),this._byteLength+=e,this}function p_(t){let{type:e,length:i,typeIds:n,valueOffsets:r}=t;if(nr.call(this,n),e.mode===vt.Sparse)return Qa.call(this,t);if(e.mode===vt.Dense){if(t.offset<=0)return nr.call(this,r),Qa.call(this,t);{let s=n.reduce((p,v)=>Math.max(p,v),n[0]),a=new Int32Array(s+1),o=new Int32Array(s+1).fill(-1),u=new Int32Array(i),d=hi(-r[0],i,r);for(let p,v,Z=-1;++Z<i;)(v=o[p=n[Z]])===-1&&(v=o[p]=d[p]),u[Z]=d[Z]-v,++a[p];nr.call(this,u);for(let p,v=-1,Z=e.children.length;++v<Z;)if(p=t.children[v]){let J=e.typeIds[v],zt=Math.min(i,a[J]);this.visit(p.slice(o[J],zt))}}}return this}function m_(t){let e;return t.nullCount>=t.length?nr.call(this,new Uint8Array(0)):(e=t.values)instanceof Uint8Array?nr.call(this,Pn(t.offset,t.length,e)):nr.call(this,mn(t.values))}function on(t){return nr.call(this,t.values.subarray(0,t.length*t.stride))}function Nu(t){let{length:e,values:i,valueOffsets:n}=t,r=n[0],s=n[e],a=Math.min(s-r,i.byteLength-r);return nr.call(this,hi(-n[0],e,n)),nr.call(this,i.subarray(r,r+a)),this}function tc(t){let{length:e,valueOffsets:i}=t;return i&&nr.call(this,hi(i[0],e,i)),this.visit(t.children[0])}function Qa(t){return this.visitMany(t.type.children.map((e,i)=>t.children[i]).filter(Boolean))[0]}It.prototype.visitBool=m_,It.prototype.visitInt=on,It.prototype.visitFloat=on,It.prototype.visitUtf8=Nu,It.prototype.visitBinary=Nu,It.prototype.visitFixedSizeBinary=on,It.prototype.visitDate=on,It.prototype.visitTimestamp=on,It.prototype.visitTime=on,It.prototype.visitDecimal=on,It.prototype.visitList=tc,It.prototype.visitStruct=Qa,It.prototype.visitUnion=p_,It.prototype.visitInterval=on,It.prototype.visitFixedSizeList=tc,It.prototype.visitMap=tc;var Bn=class extends gn{constructor(t){super(),this._position=0,this._started=!1,this._sink=new br,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,re(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return ze(t)?t.then(e=>this.writeAll(e)):Me(t)?rc(this,t):ec(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,e=null){return t===this._sink||t instanceof br?this._sink=t:(this._sink=new br,t&&ol(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&al(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!e||!Fn(e,this._schema))&&(e==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=e,this._writeSchema(e))),this}write(t){let e=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof At&&!(e=t.schema))return this.finish()&&void 0;if(t instanceof ft&&!(e=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(e&&!Fn(e,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,e)}t instanceof ft?t instanceof An||this._writeRecordBatch(t):t instanceof At?this.writeAll(t.batches):je(t)&&this.writeAll(t)}_writeMessage(t,e=8){let i=e-1,n=Rt.encode(t),r=n.byteLength,s=this._writeLegacyIpcFormat?4:8,a=r+s+i&~i,o=a-r-s;return t.headerType===tt.RecordBatch?this._recordBatchBlocks.push(new tr(a,t.bodyLength,this._position)):t.headerType===tt.DictionaryBatch&&this._dictionaryBlocks.push(new tr(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-s)),r>0&&this._write(n),this._writePadding(o)}_write(t){if(this._started){let e=L(t);e&&e.byteLength>0&&(this._sink.write(e),this._position+=e.byteLength)}return this}_writeSchema(t){return this._writeMessage(Rt.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Qn)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){let{byteLength:e,nodes:i,bufferRegions:n,buffers:r}=It.assemble(t),s=new Yt(t.numRows,i,n),a=Rt.from(s,e);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(r)}_writeDictionaryBatch(t,e,i=!1){this._dictionaryDeltaOffsets.set(e,t.length+(this._dictionaryDeltaOffsets.get(e)||0));let{byteLength:n,nodes:r,bufferRegions:s,buffers:a}=It.assemble(new k([t])),o=new Yt(t.length,r,s),u=new Se(o,e,i),d=Rt.from(u,n);return this._writeMessage(d)._writeBodyBuffers(a)}_writeBodyBuffers(t){let e,i,n;for(let r=-1,s=t.length;++r<s;)(e=t[r])&&(i=e.byteLength)>0&&(this._write(e),(n=(i+7&-8)-i)>0&&this._writePadding(n));return this}_writeDictionaries(t){for(let[e,i]of t.dictionaries){let n=this._dictionaryDeltaOffsets.get(e)||0;if(n===0||(i=i==null?void 0:i.slice(n)).length>0)for(let r of i.data)this._writeDictionaryBatch(r,e,n>0),n+=r.length}return this}},Vr=class extends Bn{static writeAll(t,e){let i=new Vr(e);return ze(t)?t.then(n=>i.writeAll(n)):Me(t)?rc(i,t):ec(i,t)}},zr=class extends Bn{static writeAll(t){let e=new zr;return ze(t)?t.then(i=>e.writeAll(i)):Me(t)?rc(e,t):ec(e,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){let e=Nr.encode(new Nr(t,Lt.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(e)._write(Int32Array.of(e.byteLength))._writeMagic()}};function ec(t,e){let i=e;e instanceof At&&(i=e.batches,t.reset(void 0,e.schema));for(let n of i)t.write(n);return t.finish()}function rc(t,e){var i,n,r,s;return I(this,void 0,void 0,function*(){try{for(i=Ee(e);n=yield i.next(),!n.done;){let a=n.value;t.write(a)}}catch(a){r={error:a}}finally{try{n&&!n.done&&(s=i.return)&&(yield s.call(i))}finally{if(r)throw r.error}}return t.finish()})}function ku(t,e){if(Me(t))return y_(t,e);if(je(t))return __(t,e);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function __(t,e){let i=null,n=(e==null?void 0:e.type)==="bytes"||!1,r=(e==null?void 0:e.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},e),{start(a){s(a,i||(i=t[Symbol.iterator]()))},pull(a){i?s(a,i):a.close()},cancel(){(i!=null&&i.return&&i.return()||!0)&&(i=null)}}),Object.assign({highWaterMark:n?r:void 0},e));function s(a,o){let u,d=null,p=a.desiredSize||null;for(;!(d=o.next(n?p:null)).done;)if(ArrayBuffer.isView(d.value)&&(u=L(d.value))&&(p!=null&&n&&(p=p-u.byteLength+1),d.value=u),a.enqueue(d.value),p!=null&&--p<=0)return;a.close()}}function y_(t,e){let i=null,n=(e==null?void 0:e.type)==="bytes"||!1,r=(e==null?void 0:e.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},e),{start(a){return I(this,void 0,void 0,function*(){yield s(a,i||(i=t[Symbol.asyncIterator]()))})},pull(a){return I(this,void 0,void 0,function*(){i?yield s(a,i):a.close()})},cancel(){return I(this,void 0,void 0,function*(){(i!=null&&i.return&&(yield i.return())||!0)&&(i=null)})}}),Object.assign({highWaterMark:n?r:void 0},e));function s(a,o){return I(this,void 0,void 0,function*(){let u,d=null,p=a.desiredSize||null;for(;!(d=yield o.next(n?p:null)).done;)if(ArrayBuffer.isView(d.value)&&(u=L(d.value))&&(p!=null&&n&&(p=p-u.byteLength+1),d.value=u),a.enqueue(d.value),p!=null&&--p<=0)return;a.close()})}}function Hu(t){return new nc(t)}var nc=class{constructor(t){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:e,["writableStrategy"]:i,["queueingStrategy"]:n="count"}=t,r=il(t,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=vn(r),this._getSize=n!=="bytes"?Cu:Pu;let{["highWaterMark"]:s=n==="bytes"?Math.pow(2,14):1e3}=Object.assign({},e),{["highWaterMark"]:a=n==="bytes"?Math.pow(2,14):1e3}=Object.assign({},i);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:o=>{this._maybeFlush(this._builder,this._controller=o)},start:o=>{this._maybeFlush(this._builder,this._controller=o)}},{highWaterMark:s,size:n!=="bytes"?Cu:Pu}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:a,size:o=>this._writeValueAndReturnChunkSize(o)})}_writeValueAndReturnChunkSize(t){let e=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(t)),this._bufferedSize-e}_maybeFlush(t,e){e!=null&&(this._bufferedSize>=e.desiredSize&&++this._numChunks&&this._enqueue(e,t.toVector()),t.finished&&((t.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(e,t.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(e,null)))}_enqueue(t,e){this._bufferedSize=0,this._controller=null,e==null?t.close():t.enqueue(e)}},Cu=t=>{var e;return(e=t==null?void 0:t.length)!==null&&e!==void 0?e:0},Pu=t=>{var e;return(e=t==null?void 0:t.byteLength)!==null&&e!==void 0?e:0};function ko(t,e){let i=new br,n=null,r=new ReadableStream({cancel(){return I(this,void 0,void 0,function*(){yield i.close()})},start(o){return I(this,void 0,void 0,function*(){yield a(o,n||(n=yield s()))})},pull(o){return I(this,void 0,void 0,function*(){n?yield a(o,n):o.close()})}});return{writable:new WritableStream(i,Object.assign({highWaterMark:Math.pow(2,14)},t)),readable:r};function s(){return I(this,void 0,void 0,function*(){return yield(yield Tt.from(i)).open(e)})}function a(o,u){return I(this,void 0,void 0,function*(){let d=o.desiredSize,p=null;for(;!(p=yield u.next()).done;)if(o.enqueue(p.value),d!=null&&--d<=0)return;o.close()})}}function Co(t,e){let i=new this(t),n=new be(i),r=new ReadableStream({cancel(){return I(this,void 0,void 0,function*(){yield n.cancel()})},pull(a){return I(this,void 0,void 0,function*(){yield s(a)})},start(a){return I(this,void 0,void 0,function*(){yield s(a)})}},Object.assign({highWaterMark:Math.pow(2,14)},e));return{writable:new WritableStream(i,t),readable:r};function s(a){return I(this,void 0,void 0,function*(){let o=null,u=a.desiredSize;for(;o=yield n.read(u||null);)if(a.enqueue(o),u!=null&&(u-=o.byteLength)<=0)return;a.close()})}}function Po(t,e="stream"){return(e==="stream"?Vr:zr).writeAll(t).toUint8Array(!0)}Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},_a),Ha),Ra),ya),fa),Oa),{compareSchemas:Fn,compareFields:hu,compareTypes:pu}),jt.toDOMStream=ku,bt.throughDOM=Hu,Tt.throughDOM=ko,sn.throughDOM=ko,vr.throughDOM=ko,Bn.throughDOM=Co,zr.throughDOM=Co,Vr.throughDOM=Co;function ni(t){switch(t.typeId){case f.Binary:return{sqlType:"binary"};case f.Bool:return{sqlType:"bool"};case f.Date:return{sqlType:"date"};case f.DateDay:return{sqlType:"date32[d]"};case f.DateMillisecond:return{sqlType:"date64[ms]"};case f.Decimal:{let e=t;return{sqlType:"decimal",precision:e.precision,scale:e.scale}}case f.Float:return{sqlType:"float"};case f.Float16:return{sqlType:"float16"};case f.Float32:return{sqlType:"float32"};case f.Float64:return{sqlType:"float64"};case f.Int:return{sqlType:"int32"};case f.Int16:return{sqlType:"int16"};case f.Int32:return{sqlType:"int32"};case f.Int64:return{sqlType:"int64"};case f.Uint16:return{sqlType:"uint16"};case f.Uint32:return{sqlType:"uint32"};case f.Uint64:return{sqlType:"uint64"};case f.Uint8:return{sqlType:"uint8"};case f.IntervalDayTime:return{sqlType:"interval[dt]"};case f.IntervalYearMonth:return{sqlType:"interval[m]"};case f.List:return{sqlType:"list",valueType:ni(t.valueType)};case f.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:t.byteWidth};case f.Null:return{sqlType:"null"};case f.Utf8:return{sqlType:"utf8"};case f.Struct:return{sqlType:"struct",fields:t.children.map(e=>Ho(e.name,e.type))};case f.Map:{let e=t;return{sqlType:"map",keyType:ni(e.keyType),valueType:ni(e.valueType)}}case f.Time:return{sqlType:"time[s]"};case f.TimeMicrosecond:return{sqlType:"time[us]"};case f.TimeMillisecond:return{sqlType:"time[ms]"};case f.TimeNanosecond:return{sqlType:"time[ns]"};case f.TimeSecond:return{sqlType:"time[s]"};case f.Timestamp:return{sqlType:"timestamp",timezone:t.timezone||void 0};case f.TimestampSecond:return{sqlType:"timestamp[s]",timezone:t.timezone||void 0};case f.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:t.timezone||void 0};case f.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:t.timezone||void 0};case f.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:t.timezone||void 0}}throw new Error(`unsupported arrow type: ${t.toString()}`)}function Ho(t,e){let i=ni(e);return i.name=t,i}var Vo=class{constructor(){this._bindings=null,this._nextMessageId=0}log(t){this.postMessage({messageId:this._nextMessageId++,requestId:0,type:"LOG",data:t},[])}sendOK(t){this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"OK",data:null},[])}failWith(t,e){let i={name:e.name,message:e.message,stack:e.stack||void 0};this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"ERROR",data:i},[])}async onMessage(t){switch(t.type){case"PING":this.sendOK(t);return;case"INSTANTIATE":this._bindings!=null&&this.failWith(t,new Error("duckdb already initialized"));try{this._bindings=await this.instantiate(t.data[0],t.data[1],e=>{this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"INSTANTIATE_PROGRESS",data:e},[])}),this.sendOK(t)}catch(e){this._bindings=null,this.failWith(t,e)}return}if(!this._bindings)return this.failWith(t,new Error("duckdb is not initialized"));try{switch(t.type){case"GET_VERSION":this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"VERSION_STRING",data:this._bindings.getVersion()},[]);break;case"GET_FEATURE_FLAGS":this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FEATURE_FLAGS",data:this._bindings.getFeatureFlags()},[]);break;case"RESET":this._bindings.reset(),this.sendOK(t);break;case"OPEN":this._bindings.open(t.data),this.sendOK(t);break;case"DROP_FILE":this._bindings.dropFile(t.data),this.sendOK(t);break;case"DROP_FILES":this._bindings.dropFiles(),this.sendOK(t);break;case"FLUSH_FILES":this._bindings.flushFiles(),this.sendOK(t);break;case"CONNECT":{let e=this._bindings.connect();this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"CONNECTION_INFO",data:e.useUnsafe((i,n)=>n)},[]);break}case"DISCONNECT":this._bindings.disconnect(t.data),this.sendOK(t);break;case"CREATE_PREPARED":{let e=this._bindings.createPrepared(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"PREPARED_STATEMENT_ID",data:e},[]);break}case"CLOSE_PREPARED":{this._bindings.closePrepared(t.data[0],t.data[1]),this.sendOK(t);break}case"RUN_PREPARED":{let e=this._bindings.runPrepared(t.data[0],t.data[1],t.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT",data:e},[e.buffer]);break}case"RUN_QUERY":{let e=this._bindings.runQuery(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT",data:e},[e.buffer]);break}case"SEND_PREPARED":{let e=this._bindings.sendPrepared(t.data[0],t.data[1],t.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT_HEADER",data:e},[e.buffer]);break}case"START_PENDING_QUERY":{let e=this._bindings.startPendingQuery(t.data[0],t.data[1]),i=[];e&&i.push(e.buffer),this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT_HEADER_OR_NULL",data:e},i);break}case"POLL_PENDING_QUERY":{let e=this._bindings.pollPendingQuery(t.data),i=[];e&&i.push(e.buffer),this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT_HEADER_OR_NULL",data:e},i);break}case"CANCEL_PENDING_QUERY":{let e=this._bindings.cancelPendingQuery(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"SUCCESS",data:e},[]);break}case"FETCH_QUERY_RESULTS":{let e=this._bindings.fetchQueryResults(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT_CHUNK",data:e},[e.buffer]);break}case"GET_TABLE_NAMES":{let e=this._bindings.getTableNames(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"TABLE_NAMES",data:e},[]);break}case"GLOB_FILE_INFOS":{let e=this._bindings.globFiles(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FILE_INFOS",data:e},[]);break}case"REGISTER_FILE_URL":this._bindings.registerFileURL(t.data[0],t.data[1],t.data[2],t.data[3]),this.sendOK(t);break;case"REGISTER_FILE_BUFFER":this._bindings.registerFileBuffer(t.data[0],t.data[1]),this.sendOK(t);break;case"REGISTER_FILE_HANDLE":this._bindings.registerFileHandle(t.data[0],t.data[1],t.data[2],t.data[3]),this.sendOK(t);break;case"COPY_FILE_TO_PATH":this._bindings.copyFileToPath(t.data[0],t.data[1]),this.sendOK(t);break;case"COPY_FILE_TO_BUFFER":{let e=this._bindings.copyFileToBuffer(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FILE_BUFFER",data:e},[]);break}case"COLLECT_FILE_STATISTICS":this._bindings.collectFileStatistics(t.data[0],t.data[1]),this.sendOK(t);break;case"EXPORT_FILE_STATISTICS":{this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FILE_STATISTICS",data:this._bindings.exportFileStatistics(t.data)},[]);break}case"INSERT_ARROW_FROM_IPC_STREAM":{this._bindings.insertArrowFromIPCStream(t.data[0],t.data[1],t.data[2]),this.sendOK(t);break}case"IMPORT_CSV_FROM_PATH":{this._bindings.insertCSVFromPath(t.data[0],t.data[1],t.data[2]),this.sendOK(t);break}case"IMPORT_JSON_FROM_PATH":{this._bindings.insertJSONFromPath(t.data[0],t.data[1],t.data[2]),this.sendOK(t);break}case"TOKENIZE":{let e=this._bindings.tokenize(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"SCRIPT_TOKENS",data:e},[]);break}}}catch(e){return this.failWith(t,e)}}},ju={},S_=(()=>{var t=ju.url;return function(e){e=e||{};var i=typeof e<"u"?e:{},n,r;i.ready=new Promise(function(l,h){n=l,r=h});var s=Object.assign({},i),a="./this.program",o=(l,h)=>{throw h},u=typeof window=="object",d=typeof importScripts=="function",p=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",v="";function Z(l){return i.locateFile?i.locateFile(l,v):v+l}var J,zt;function te(l){l instanceof ts||ee("exiting due to exception: "+l)}if(p){d?v=ic().dirname(v)+"/":v=__dirname+"/";var Ut,Ne;typeof sa=="function"&&(Ut=zu(),Ne=ic()),J=(l,h)=>(l=Ne.normalize(l),Ut.readFileSync(l,h?void 0:"utf8")),zt=l=>{var h=J(l,!0);return h.buffer||(h=new Uint8Array(h)),h},process.argv.length>1&&(a=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(l){if(!(l instanceof ts))throw l}),process.on("unhandledRejection",function(l){throw l}),o=(l,h)=>{if(sr())throw process.exitCode=l,h;te(h),process.exit(l)},i.inspect=function(){return"[Emscripten Module object]"}}else(u||d)&&(d?v=self.location.href:typeof document<"u"&&document.currentScript&&(v=document.currentScript.src),t&&(v=t),v.indexOf("blob:")!==0?v=v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1):v="",J=l=>{var h=new XMLHttpRequest;return h.open("GET",l,!1),h.send(null),h.responseText},d&&(zt=l=>{var h=new XMLHttpRequest;return h.open("GET",l,!1),h.responseType="arraybuffer",h.send(null),new Uint8Array(h.response)}));var si=i.print||console.log.bind(console),ee=i.printErr||console.warn.bind(console);Object.assign(i,s),s=null,i.arguments&&i.arguments,i.thisProgram&&(a=i.thisProgram),i.quit&&(o=i.quit);var Ve;i.wasmBinary&&(Ve=i.wasmBinary);var cn=i.noExitRuntime||!0;typeof WebAssembly!="object"&&oi("no native wasm support detected");var ui,ci=!1,ai;function ut(l,h){l||oi(h)}var ce=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function rt(l,h,c){h>>>=0;for(var y=h+c,g=h;l[g]&&!(g>=y);)++g;if(g-h>16&&l.buffer&&ce)return ce.decode(l.subarray(h,g));for(var q="";h<g;){var F=l[h++];if(!(F&128)){q+=String.fromCharCode(F);continue}var T=l[h++]&63;if((F&224)==192){q+=String.fromCharCode((F&31)<<6|T);continue}var Q=l[h++]&63;if((F&240)==224?F=(F&15)<<12|T<<6|Q:F=(F&7)<<18|T<<12|Q<<6|l[h++]&63,F<65536)q+=String.fromCharCode(F);else{var ct=F-65536;q+=String.fromCharCode(55296|ct>>10,56320|ct&1023)}}return q}function Xt(l,h){return l>>>=0,l?rt(x,l,h):""}function Qt(l,h,c,y){if(c>>>=0,!(y>0))return 0;for(var g=c,q=c+y-1,F=0;F<l.length;++F){var T=l.charCodeAt(F);if(T>=55296&&T<=57343){var Q=l.charCodeAt(++F);T=65536+((T&1023)<<10)|Q&1023}if(T<=127){if(c>=q)break;h[c++>>>0]=T}else if(T<=2047){if(c+1>=q)break;h[c++>>>0]=192|T>>6,h[c++>>>0]=128|T&63}else if(T<=65535){if(c+2>=q)break;h[c++>>>0]=224|T>>12,h[c++>>>0]=128|T>>6&63,h[c++>>>0]=128|T&63}else{if(c+3>=q)break;h[c++>>>0]=240|T>>18,h[c++>>>0]=128|T>>12&63,h[c++>>>0]=128|T>>6&63,h[c++>>>0]=128|T&63}}return h[c>>>0]=0,c-g}function b(l,h,c){return Qt(l,x,h,c)}function _(l){for(var h=0,c=0;c<l.length;++c){var y=l.charCodeAt(c);y<=127?h++:y<=2047?h+=2:y>=55296&&y<=57343?(h+=4,++c):h+=3}return h}var m,S,x,E,at,A,ae;function lt(l){m=l,i.HEAP8=S=new Int8Array(l),i.HEAP16=E=new Int16Array(l),i.HEAP32=A=new Int32Array(l),i.HEAPU8=x=new Uint8Array(l),i.HEAPU16=at=new Uint16Array(l),i.HEAPU32=ae=new Uint32Array(l),i.HEAPF32=new Float32Array(l),i.HEAPF64=new Float64Array(l)}i.INITIAL_MEMORY;var le=[],Qi=[],oe=[],ln=[];function sr(){return cn}function fs(){if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)ih(i.preRun.shift());es(le)}function Vu(){es(Qi)}function th(){es(oe)}function eh(){if(i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;)rh(i.postRun.shift());es(ln)}function ih(l){le.unshift(l)}function nh(l){Qi.unshift(l)}function rh(l){ln.unshift(l)}var En=0,Fr=null;function sh(l){En++,i.monitorRunDependencies&&i.monitorRunDependencies(En)}function ah(l){if(En--,i.monitorRunDependencies&&i.monitorRunDependencies(En),En==0&&Fr){var h=Fr;Fr=null,h()}}function oi(l){i.onAbort&&i.onAbort(l),l="Aborted("+l+")",ee(l),ci=!0,ai=1,l+=". Build with -sASSERTIONS for more info.",Qo()}var oh="data:application/octet-stream;base64,";function Rs(l){return l.startsWith(oh)}var Qe;i.locateFile?(Qe="./duckdb-eh.wasm",Rs(Qe)||(Qe=Z(Qe))):Qe=new URL("./duckdb-eh.wasm",ju.url).toString();function xs(l){try{if(l==Qe&&Ve)return new Uint8Array(Ve);if(zt)return zt(l);throw"both async and sync fetching of the wasm failed"}catch(h){oi(h)}}function lh(){return!Ve&&(u||d)&&typeof fetch=="function"?fetch(Qe,{credentials:"same-origin"}).then(function(l){if(!l.ok)throw"failed to load wasm binary file at '"+Qe+"'";return l.arrayBuffer()}).catch(function(){return xs(Qe)}):Promise.resolve().then(function(){return xs(Qe)})}function uh(){var l={a:cd};function h(F,T){var Q=F.exports;i.asm=Q,ui=i.asm.ia,lt(ui.buffer),i.asm.la,nh(i.asm.ja),ah()}sh();function c(F){h(F.instance)}function y(F){return lh().then(function(T){return WebAssembly.instantiate(T,l)}).then(function(T){return T}).then(F,function(T){ee("failed to asynchronously prepare wasm: "+T),oi(T)})}function g(){return!Ve&&typeof WebAssembly.instantiateStreaming=="function"&&!Rs(Qe)&&!p&&typeof fetch=="function"?fetch(Qe,{credentials:"same-origin"}).then(function(F){var T=WebAssembly.instantiateStreaming(F,l);return T.then(c,function(Q){return ee("wasm streaming compile failed: "+Q),ee("falling back to ArrayBuffer instantiation"),y(c)})}):y(c)}if(i.instantiateWasm)try{var q=i.instantiateWasm(l,h);return q}catch(F){ee("Module.instantiateWasm callback failed with error: "+F),r(F)}return g().catch(r),{}}function ts(l){this.name="ExitStatus",this.message="Program terminated with exit("+l+")",this.status=l}function es(l){for(;l.length>0;)l.shift()(i)}var Dn={varargs:void 0,get:function(){Dn.varargs+=4;var l=A[Dn.varargs-4>>>2];return l},getStr:function(l){var h=Xt(l);return h}};function hh(l,h,c,y,g){for(var q=0,F=h?A[h>>>2]:0,T=h?A[h+4>>>2]:0,Q=c?A[c>>>2]:0,ct=c?A[c+4>>>2]:0,dt=y?A[y>>>2]:0,Pe=y?A[y+4>>>2]:0,wt=0,li=0,Zt=0,Te=0,He=0,un=0,w=(h?A[h>>>2]:0)|(c?A[c>>>2]:0)|(y?A[y>>>2]:0),st=(h?A[h+4>>>2]:0)|(c?A[c+4>>>2]:0)|(y?A[y+4>>>2]:0),Vt=function(fd,pd,yd,el){return fd<32?pd&el:yd&el},Ft=0;Ft<l;Ft++){var De=1<<Ft%32;if(Vt(Ft,w,st,De)){var $r=Dn.getStreamFromFD(Ft),cs=Dn.DEFAULT_POLLMASK;$r.stream_ops.poll&&(cs=$r.stream_ops.poll($r)),cs&1&&Vt(Ft,F,T,De)&&(Ft<32?wt=wt|De:li=li|De,q++),cs&4&&Vt(Ft,Q,ct,De)&&(Ft<32?Zt=Zt|De:Te=Te|De,q++),cs&2&&Vt(Ft,dt,Pe,De)&&(Ft<32?He=He|De:un=un|De,q++)}}return h&&(A[h>>>2]=wt,A[h+4>>>2]=li),c&&(A[c>>>2]=Zt,A[c+4>>>2]=Te),y&&(A[y>>>2]=He,A[y+4>>>2]=un),q}function ch(){ee("missing function: $SOCKFS"),oi(-1)}function ta(){ee("missing function: $FS"),oi(-1)}function jr(l){var h=ch.getSocket(l);if(!h)throw new ta.ErrnoError(8);return h}function ps(l){return(l&255)+"."+(l>>8&255)+"."+(l>>16&255)+"."+(l>>24&255)}function ea(l){var h="",c=0,y=0,g=0,q=0,F=0,T=0,Q=[l[0]&65535,l[0]>>16,l[1]&65535,l[1]>>16,l[2]&65535,l[2]>>16,l[3]&65535,l[3]>>16],ct=!0,dt="";for(T=0;T<5;T++)if(Q[T]!==0){ct=!1;break}if(ct){if(dt=ps(Q[6]|Q[7]<<16),Q[5]===-1)return h="::ffff:",h+=dt,h;if(Q[5]===0)return h="::",dt==="0.0.0.0"&&(dt=""),dt==="0.0.0.1"&&(dt="1"),h+=dt,h}for(c=0;c<8;c++)Q[c]===0&&(c-g>1&&(F=0),g=c,F++),F>y&&(y=F,q=c-y+1);for(c=0;c<8;c++){if(y>1&&Q[c]===0&&c>=q&&c<q+y){c===q&&(h+=":",q===0&&(h+=":"));continue}h+=Number(Es(Q[c]&65535)).toString(16),h+=c<7?":":""}return h}function ia(l,h){var c=E[l>>>1],y=Es(at[l+2>>>1]),g;switch(c){case 2:if(h!==16)return{errno:28};g=A[l+4>>>2],g=ps(g);break;case 10:if(h!==28)return{errno:28};g=[A[l+8>>>2],A[l+12>>>2],A[l+16>>>2],A[l+20>>>2]],g=ea(g);break;default:return{errno:5}}return{family:c,addr:g,port:y}}function is(l){for(var h=l.split("."),c=0;c<4;c++){var y=Number(h[c]);if(isNaN(y))return null;h[c]=y}return(h[0]|h[1]<<8|h[2]<<16|h[3]<<24)>>>0}function ns(l){return parseInt(l)}function As(l){var h,c,y,g,q=/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,F=[];if(!q.test(l))return null;if(l==="::")return[0,0,0,0,0,0,0,0];for(l.startsWith("::")?l=l.replace("::","Z:"):l=l.replace("::",":Z:"),l.indexOf(".")>0?(l=l.replace(new RegExp("[.]","g"),":"),h=l.split(":"),h[h.length-4]=ns(h[h.length-4])+ns(h[h.length-3])*256,h[h.length-3]=ns(h[h.length-2])+ns(h[h.length-1])*256,h=h.slice(0,h.length-2)):h=l.split(":"),y=0,g=0,c=0;c<h.length;c++)if(typeof h[c]=="string")if(h[c]==="Z"){for(g=0;g<8-h.length+1;g++)F[c+g]=0;y=g-1}else F[c+y]=os(parseInt(h[c],16));else F[c+y]=h[c];return[F[1]<<16|F[0],F[3]<<16|F[2],F[5]<<16|F[4],F[7]<<16|F[6]]}var ii={address_map:{id:1,addrs:{},names:{}},lookup_name:function(l){var h=is(l);if(h!==null||(h=As(l),h!==null))return l;var c;if(ii.address_map.addrs[l])c=ii.address_map.addrs[l];else{var y=ii.address_map.id++;ut(y<65535,"exceeded max address mappings of 65535"),c="172.29."+(y&255)+"."+(y&65280),ii.address_map.names[c]=l,ii.address_map.addrs[l]=c}return c},lookup_addr:function(l){return ii.address_map.names[l]?ii.address_map.names[l]:null}};function na(l,h,c){if(c&&l===0)return null;var y=ia(l,h);if(y.errno)throw new ta.ErrnoError(y.errno);return y.addr=ii.lookup_addr(y.addr)||y.addr,y}function dh(l,h,c){var y=jr(l),g=na(h,c);return y.sock_ops.bind(y,g.addr,g.port),0}function fh(l,h,c){var y=jr(l),g=na(h,c);return y.sock_ops.connect(y,g.addr,g.port),0}function ph(l,h,c,y){}function yh(l,h,c){return Dn.varargs=c,0}function bh(l,h){}function _h(l,h,c){}function mh(l,h,c){}function ra(l,h){return x.fill(0,l,l+h),l}function Ts(l,h,c,y,g){switch(h){case 2:c=is(c),ra(l,16),g&&(A[g>>>2]=16),E[l>>>1]=h,A[l+4>>>2]=c,E[l+2>>>1]=os(y);break;case 10:c=As(c),ra(l,28),g&&(A[g>>>2]=28),A[l>>>2]=h,A[l+8>>>2]=c[0],A[l+12>>>2]=c[1],A[l+16>>>2]=c[2],A[l+20>>>2]=c[3],E[l+2>>>1]=os(y);break;default:return 5}return 0}function gh(l,h,c){var y=jr(l);return y.daddr?(Ts(h,y.family,ii.lookup_name(y.daddr),y.dport,c),0):-53}function vh(l,h,c,y,g){var q=jr(l);return h===1&&c===4?(A[y>>>2]=q.error,A[g>>>2]=4,q.error=null,0):-50}function wh(l,h,c){return Dn.varargs=c,0}function Ih(l,h){}function Sh(l,h,c){}function Ah(l,h,c,y){}function Th(l,h,c,y){Dn.varargs=y}function Oh(l,h,c,y,g,q){var F=jr(l),T=F.sock_ops.recvmsg(F,c);if(!T)return 0;if(g)var Q=Ts(g,F.family,ii.lookup_name(T.addr),T.port,q);return x.set(T.buffer,h>>>0),T.buffer.byteLength}function Bh(l,h,c,y){}function Eh(l){}function Mh(l,h,c,y,g,q){}function Fh(l,h,c){}function Dh(l,h){}function Rh(l,h,c){}function xh(l){}var oa="To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking";function uc(l,h){oi(oa)}function hc(l,h){oi(oa)}var dc=!0;function fc(){return dc}function pc(){oi("")}function yc(l,h){return globalThis.DUCKDB_RUNTIME.createDirectory(i,l,h)}function bc(l,h){return globalThis.DUCKDB_RUNTIME.checkDirectory(i,l,h)}function _c(l,h){return globalThis.DUCKDB_RUNTIME.listDirectoryEntries(i,l,h)}function mc(l,h){return globalThis.DUCKDB_RUNTIME.removeDirectory(i,l,h)}function gc(l){return globalThis.DUCKDB_RUNTIME.closeFile(i,l)}function vc(l,h){return globalThis.DUCKDB_RUNTIME.checkFile(i,l,h)}function wc(l){return globalThis.DUCKDB_RUNTIME.getLastFileModificationTime(i,l)}function Ic(l,h,c,y){return globalThis.DUCKDB_RUNTIME.moveFile(i,l,h,c,y)}function Sc(l,h){return globalThis.DUCKDB_RUNTIME.openFile(i,l,h)}function Ac(l,h,c,y){return globalThis.DUCKDB_RUNTIME.readFile(i,l,h,c,y)}function Tc(l,h){return globalThis.DUCKDB_RUNTIME.truncateFile(i,l,h)}function Oc(l,h,c,y){return globalThis.DUCKDB_RUNTIME.writeFile(i,l,h,c,y)}function Bc(l){return globalThis.DUCKDB_RUNTIME.getDefaultDataProtocol(l)}function Ec(l,h){return globalThis.DUCKDB_RUNTIME.glob(i,l,h)}function Fc(l){return globalThis.DUCKDB_RUNTIME.testPlatformFeature(i,l)}function Dc(l,h,c,y,g,q){return globalThis.DUCKDB_RUNTIME.callScalarUDF(i,l,h,c,y,g,q)}function Rc(){return Date.now()}function no(){return 4294901760}function Lc(){return no()}var Os;p?Os=()=>{var l=process.hrtime();return l[0]*1e3+l[1]/1e6}:Os=()=>performance.now();function xc(l,h,c){x.copyWithin(l>>>0,h>>>0,h+c>>>0)}function Nc(l){try{return ui.grow(l-m.byteLength+65535>>>16),lt(ui.buffer),1}catch{}}function Cc(l){var h=x.length;l=l>>>0;var c=no();if(l>c)return!1;let y=(Q,ct)=>Q+(ct-Q%ct)%ct;for(var g=1;g<=4;g*=2){var q=h*(1+.2/g);q=Math.min(q,l+100663296);var F=Math.min(c,y(Math.max(l,q),65536)),T=Nc(F);if(T)return!0}return!1}var Bs={};function kc(){return a||"./this.program"}function Wr(){if(!Wr.strings){var l=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",h={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:l,_:kc()};for(var c in Bs)Bs[c]===void 0?delete h[c]:h[c]=Bs[c];var y=[];for(var c in h)y.push(c+"="+h[c]);Wr.strings=y}return Wr.strings}function Pc(l,h,c){for(var y=0;y<l.length;++y)S[h++>>>0]=l.charCodeAt(y);c||(S[h>>>0]=0)}function Hc(l,h){var c=0;return Wr().forEach(function(y,g){var q=h+c;ae[l+g*4>>>2]=q,Pc(y,q),c+=y.length+1}),0}function Vc(l,h){var c=Wr();ae[l>>>2]=c.length;var y=0;return c.forEach(function(g){y+=g.length+1}),ae[h>>>2]=y,0}function zc(l){return 52}function jc(l,h){var c=l==1||l==2?2:oi();return S[h>>>0]=c,0}function Wc(l,h,c,y,g,q){return 52}function $c(l,h,c,y,g,q){return 52}function Yc(l,h,c,y){return 52}function qc(l,h,c,y,g){return 70}function Xc(l){return 52}var Gc=[null,[],[]];function Kc(l,h){var c=Gc[l];h===0||h===10?((l===1?si:ee)(rt(c,0)),c.length=0):c.push(h)}function Jc(l,h,c,y){for(var g=0,q=0;q<c;q++){var F=ae[h>>>2],T=ae[h+4>>>2];h+=8;for(var Q=0;Q<T;Q++)Kc(l,x[F+Q>>>0]);g+=T}return ae[y>>>2]=g,0}function Qc(l,h,c,y){var g=0,q=0,F=0,T=0,Q=0,ct=0,dt;function Pe(wt,li,Zt,Te,He,un){var w,st,Vt,Ft;return st=wt===10?28:16,He=wt===10?ea(He):ps(He),w=Ms(st),Ft=Ts(w,wt,He,un),ut(!Ft),Vt=Ms(32),A[Vt+4>>>2]=wt,A[Vt+8>>>2]=li,A[Vt+12>>>2]=Zt,A[Vt+24>>>2]=Te,ae[Vt+20>>>2]=w,wt===10?A[Vt+16>>>2]=28:A[Vt+16>>>2]=16,A[Vt+28>>>2]=0,Vt}if(c&&(F=A[c>>>2],T=A[c+4>>>2],Q=A[c+8>>>2],ct=A[c+12>>>2]),Q&&!ct&&(ct=Q===2?17:6),!Q&&ct&&(Q=ct===17?2:1),ct===0&&(ct=6),Q===0&&(Q=1),!l&&!h)return-2;if(F&-1088||c!==0&&A[c>>>2]&2&&!l)return-1;if(F&32)return-2;if(Q!==0&&Q!==1&&Q!==2)return-7;if(T!==0&&T!==2&&T!==10)return-6;if(h&&(h=Xt(h),q=parseInt(h,10),isNaN(q)))return F&1024?-2:-8;if(!l)return T===0&&(T=2),!(F&1)&&(T===2?g=as(2130706433):g=[0,0,0,1]),dt=Pe(T,Q,ct,null,g,q),ae[y>>>2]=dt,0;if(l=Xt(l),g=is(l),g!==null)if(T===0||T===2)T=2;else if(T===10&&F&8)g=[0,0,as(65535),g],T=10;else return-2;else if(g=As(l),g!==null)if(T===0||T===10)T=10;else return-2;return g!=null?(dt=Pe(T,Q,ct,l,g,q),ae[y>>>2]=dt,0):F&4?-2:(l=ii.lookup_name(l),g=is(l),T===0?T=2:T===10&&(g=[0,0,as(65535),g]),dt=Pe(T,Q,ct,null,g,q),ae[y>>>2]=dt,0)}function Zc(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var l=new Uint8Array(1);return()=>(crypto.getRandomValues(l),l[0])}else if(p)try{var h=sa("crypto");return()=>h.randomBytes(1)[0]}catch{}return()=>oi("randomDevice")}function rs(l,h){rs.randomDevice||(rs.randomDevice=Zc());for(var c=0;c<h;c++)S[l+c>>>0]=rs.randomDevice();return 0}function td(l,h,c,y,g,q,F){var T=ia(l,h);if(T.errno)return-6;var Q=T.port,ct=T.addr,dt=!1;if(c&&y){var Pe;if(F&1||!(Pe=ii.lookup_addr(ct))){if(F&8)return-2}else ct=Pe;var wt=b(ct,c,y);wt+1>=y&&(dt=!0)}if(g&&q){Q=""+Q;var wt=b(Q,g,q);wt+1>=q&&(dt=!0)}return dt?-12:0}function ss(l){return l%4===0&&(l%100!==0||l%400===0)}function ed(l,h){for(var c=0,y=0;y<=h;c+=l[y++]);return c}var qo=[31,29,31,30,31,30,31,31,30,31,30,31],Ko=[31,28,31,30,31,30,31,31,30,31,30,31];function id(l,h){for(var c=new Date(l.getTime());h>0;){var y=ss(c.getFullYear()),g=c.getMonth(),q=(y?qo:Ko)[g];if(h>q-c.getDate())h-=q-c.getDate()+1,c.setDate(1),g<11?c.setMonth(g+1):(c.setMonth(0),c.setFullYear(c.getFullYear()+1));else return c.setDate(c.getDate()+h),c}return c}function nd(l,h,c){var y=c>0?c:_(l)+1,g=new Array(y),q=Qt(l,g,0,g.length);return h&&(g.length=q),g}function Jo(l,h){S.set(l,h>>>0)}function rd(l,h,c,y){var g=A[y+40>>>2],q={tm_sec:A[y>>>2],tm_min:A[y+4>>>2],tm_hour:A[y+8>>>2],tm_mday:A[y+12>>>2],tm_mon:A[y+16>>>2],tm_year:A[y+20>>>2],tm_wday:A[y+24>>>2],tm_yday:A[y+28>>>2],tm_isdst:A[y+32>>>2],tm_gmtoff:A[y+36>>>2],tm_zone:g?Xt(g):""},F=Xt(c),T={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var Q in T)F=F.replace(new RegExp(Q,"g"),T[Q]);var ct=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dt=["January","February","March","April","May","June","July","August","September","October","November","December"];function Pe(w,st,Vt){for(var Ft=typeof w=="number"?w.toString():w||"";Ft.length<st;)Ft=Vt[0]+Ft;return Ft}function wt(w,st){return Pe(w,st,"0")}function li(w,st){function Vt(De){return De<0?-1:De>0?1:0}var Ft;return(Ft=Vt(w.getFullYear()-st.getFullYear()))===0&&(Ft=Vt(w.getMonth()-st.getMonth()))===0&&(Ft=Vt(w.getDate()-st.getDate())),Ft}function Zt(w){switch(w.getDay()){case 0:return new Date(w.getFullYear()-1,11,29);case 1:return w;case 2:return new Date(w.getFullYear(),0,3);case 3:return new Date(w.getFullYear(),0,2);case 4:return new Date(w.getFullYear(),0,1);case 5:return new Date(w.getFullYear()-1,11,31);case 6:return new Date(w.getFullYear()-1,11,30)}}function Te(w){var st=id(new Date(w.tm_year+1900,0,1),w.tm_yday),Vt=new Date(st.getFullYear(),0,4),Ft=new Date(st.getFullYear()+1,0,4),De=Zt(Vt),$r=Zt(Ft);return li(De,st)<=0?li($r,st)<=0?st.getFullYear()+1:st.getFullYear():st.getFullYear()-1}var He={"%a":function(w){return ct[w.tm_wday].substring(0,3)},"%A":function(w){return ct[w.tm_wday]},"%b":function(w){return dt[w.tm_mon].substring(0,3)},"%B":function(w){return dt[w.tm_mon]},"%C":function(w){var st=w.tm_year+1900;return wt(st/100|0,2)},"%d":function(w){return wt(w.tm_mday,2)},"%e":function(w){return Pe(w.tm_mday,2," ")},"%g":function(w){return Te(w).toString().substring(2)},"%G":function(w){return Te(w)},"%H":function(w){return wt(w.tm_hour,2)},"%I":function(w){var st=w.tm_hour;return st==0?st=12:st>12&&(st-=12),wt(st,2)},"%j":function(w){return wt(w.tm_mday+ed(ss(w.tm_year+1900)?qo:Ko,w.tm_mon-1),3)},"%m":function(w){return wt(w.tm_mon+1,2)},"%M":function(w){return wt(w.tm_min,2)},"%n":function(){return`
`},"%p":function(w){return w.tm_hour>=0&&w.tm_hour<12?"AM":"PM"},"%S":function(w){return wt(w.tm_sec,2)},"%t":function(){return"	"},"%u":function(w){return w.tm_wday||7},"%U":function(w){var st=w.tm_yday+7-w.tm_wday;return wt(Math.floor(st/7),2)},"%V":function(w){var st=Math.floor((w.tm_yday+7-(w.tm_wday+6)%7)/7);if((w.tm_wday+371-w.tm_yday-2)%7<=2&&st++,st){if(st==53){var Vt=(w.tm_wday+371-w.tm_yday)%7;Vt!=4&&(Vt!=3||!ss(w.tm_year))&&(st=1)}}else{st=52;var Ft=(w.tm_wday+7-w.tm_yday-1)%7;(Ft==4||Ft==5&&ss(w.tm_year%400-1))&&st++}return wt(st,2)},"%w":function(w){return w.tm_wday},"%W":function(w){var st=w.tm_yday+7-(w.tm_wday+6)%7;return wt(Math.floor(st/7),2)},"%y":function(w){return(w.tm_year+1900).toString().substring(2)},"%Y":function(w){return w.tm_year+1900},"%z":function(w){var st=w.tm_gmtoff,Vt=st>=0;return st=Math.abs(st)/60,st=st/60*100+st%60,(Vt?"+":"-")+("0000"+st).slice(-4)},"%Z":function(w){return w.tm_zone},"%%":function(){return"%"}};F=F.replace(/%%/g,"\0\0");for(var Q in He)F.includes(Q)&&(F=F.replace(new RegExp(Q,"g"),He[Q](q)));F=F.replace(/\0\0/g,"%");var un=nd(F,!1);return un.length>h?0:(Jo(un,l),un.length-1)}function sd(l,h,c,y,g){return rd(l,h,c,y)}function ad(l){ai=l,sr()||(i.onExit&&i.onExit(l),ci=!0),o(l,new ts(l))}function od(l,h){ai=l,ad(l)}function ld(l){if(l instanceof ts||l=="unwind")return ai;o(1,l)}function ud(l){var h=i["_"+l];return h}function hd(l,h,c,y,g){var q={string:Zt=>{var Te=0;if(Zt!=null&&Zt!==0){var He=(Zt.length<<2)+1;Te=ls(He),b(Zt,Te,He)}return Te},array:Zt=>{var Te=ls(Zt.length);return Jo(Zt,Te),Te}};function F(Zt){return h==="string"?Xt(Zt):h==="boolean"?!!Zt:Zt}var T=ud(l),Q=[],ct=0;if(y)for(var dt=0;dt<y.length;dt++){var Pe=q[c[dt]];Pe?(ct===0&&(ct=Fs()),Q[dt]=Pe(y[dt])):Q[dt]=y[dt]}var wt=T.apply(null,Q);function li(Zt){return ct!==0&&Ds(ct),F(Zt)}return wt=li(wt),wt}var cd={Z:hh,ba:dh,aa:fh,U:ph,a:yh,T:bh,t:_h,O:mh,X:gh,Y:vh,n:wh,Q:Ih,P:Sh,R:Ah,o:Th,_:Oh,L:Bh,i:Eh,$:Mh,k:Fh,S:Dh,j:Rh,ca:xh,ea:uc,da:hc,p:fc,c:pc,D:yc,F:bc,B:_c,C:mc,g:gc,z:vc,s:wc,A:Ic,H:Sc,d:Ac,G:Tc,h:Oc,I:Bc,y:Ec,f:Fc,J:Dc,q:Rc,r:Lc,V:Os,ga:xc,ha:Cc,E:Hc,M:Vc,b:zc,fa:jc,w:Wc,v:$c,m:Yc,x:qc,N:Xc,e:Jc,l:Qc,K:rs,W:td,u:sd};uh(),i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.ja).apply(null,arguments)},i._main=function(){return(i._main=i.asm.ka).apply(null,arguments)},i._duckdb_web_fs_glob_add_path=function(){return(i._duckdb_web_fs_glob_add_path=i.asm.ma).apply(null,arguments)},i._duckdb_web_clear_response=function(){return(i._duckdb_web_clear_response=i.asm.na).apply(null,arguments)},i._duckdb_web_fail_with=function(){return(i._duckdb_web_fail_with=i.asm.oa).apply(null,arguments)},i._duckdb_web_reset=function(){return(i._duckdb_web_reset=i.asm.pa).apply(null,arguments)},i._duckdb_web_connect=function(){return(i._duckdb_web_connect=i.asm.qa).apply(null,arguments)},i._duckdb_web_disconnect=function(){return(i._duckdb_web_disconnect=i.asm.ra).apply(null,arguments)},i._duckdb_web_flush_files=function(){return(i._duckdb_web_flush_files=i.asm.sa).apply(null,arguments)},i._duckdb_web_flush_file=function(){return(i._duckdb_web_flush_file=i.asm.ta).apply(null,arguments)},i._duckdb_web_open=function(){return(i._duckdb_web_open=i.asm.ua).apply(null,arguments)},i._duckdb_web_get_global_file_info=function(){return(i._duckdb_web_get_global_file_info=i.asm.va).apply(null,arguments)},i._duckdb_web_collect_file_stats=function(){return(i._duckdb_web_collect_file_stats=i.asm.wa).apply(null,arguments)},i._duckdb_web_export_file_stats=function(){return(i._duckdb_web_export_file_stats=i.asm.xa).apply(null,arguments)},i._duckdb_web_fs_drop_file=function(){return(i._duckdb_web_fs_drop_file=i.asm.ya).apply(null,arguments)},i._duckdb_web_fs_drop_files=function(){return(i._duckdb_web_fs_drop_files=i.asm.za).apply(null,arguments)},i._duckdb_web_fs_glob_file_infos=function(){return(i._duckdb_web_fs_glob_file_infos=i.asm.Aa).apply(null,arguments)},i._duckdb_web_fs_get_file_info_by_id=function(){return(i._duckdb_web_fs_get_file_info_by_id=i.asm.Ba).apply(null,arguments)},i._duckdb_web_fs_get_file_info_by_name=function(){return(i._duckdb_web_fs_get_file_info_by_name=i.asm.Ca).apply(null,arguments)},i._duckdb_web_fs_register_file_url=function(){return(i._duckdb_web_fs_register_file_url=i.asm.Da).apply(null,arguments)},i._duckdb_web_fs_register_file_buffer=function(){return(i._duckdb_web_fs_register_file_buffer=i.asm.Ea).apply(null,arguments)},i._duckdb_web_copy_file_to_buffer=function(){return(i._duckdb_web_copy_file_to_buffer=i.asm.Fa).apply(null,arguments)},i._duckdb_web_copy_file_to_path=function(){return(i._duckdb_web_copy_file_to_path=i.asm.Ga).apply(null,arguments)},i._duckdb_web_get_version=function(){return(i._duckdb_web_get_version=i.asm.Ha).apply(null,arguments)},i._duckdb_web_get_feature_flags=function(){return(i._duckdb_web_get_feature_flags=i.asm.Ia).apply(null,arguments)},i._duckdb_web_tokenize=function(){return(i._duckdb_web_tokenize=i.asm.Ja).apply(null,arguments)},i._duckdb_web_udf_scalar_create=function(){return(i._duckdb_web_udf_scalar_create=i.asm.Ka).apply(null,arguments)},i._duckdb_web_prepared_create=function(){return(i._duckdb_web_prepared_create=i.asm.La).apply(null,arguments)},i._duckdb_web_prepared_close=function(){return(i._duckdb_web_prepared_close=i.asm.Ma).apply(null,arguments)},i._duckdb_web_prepared_run=function(){return(i._duckdb_web_prepared_run=i.asm.Na).apply(null,arguments)},i._duckdb_web_prepared_send=function(){return(i._duckdb_web_prepared_send=i.asm.Oa).apply(null,arguments)},i._duckdb_web_query_run=function(){return(i._duckdb_web_query_run=i.asm.Pa).apply(null,arguments)},i._duckdb_web_pending_query_start=function(){return(i._duckdb_web_pending_query_start=i.asm.Qa).apply(null,arguments)},i._duckdb_web_pending_query_poll=function(){return(i._duckdb_web_pending_query_poll=i.asm.Ra).apply(null,arguments)},i._duckdb_web_pending_query_cancel=function(){return(i._duckdb_web_pending_query_cancel=i.asm.Sa).apply(null,arguments)},i._duckdb_web_query_fetch_results=function(){return(i._duckdb_web_query_fetch_results=i.asm.Ta).apply(null,arguments)},i._duckdb_web_get_tablenames=function(){return(i._duckdb_web_get_tablenames=i.asm.Ua).apply(null,arguments)},i._duckdb_web_insert_arrow_from_ipc_stream=function(){return(i._duckdb_web_insert_arrow_from_ipc_stream=i.asm.Va).apply(null,arguments)},i._duckdb_web_insert_csv_from_path=function(){return(i._duckdb_web_insert_csv_from_path=i.asm.Wa).apply(null,arguments)},i._duckdb_web_insert_json_from_path=function(){return(i._duckdb_web_insert_json_from_path=i.asm.Xa).apply(null,arguments)};var as=i._htonl=function(){return(as=i._htonl=i.asm.Ya).apply(null,arguments)},os=i._htons=function(){return(os=i._htons=i.asm.Za).apply(null,arguments)},Es=i._ntohs=function(){return(Es=i._ntohs=i.asm._a).apply(null,arguments)},Ms=i._malloc=function(){return(Ms=i._malloc=i.asm.$a).apply(null,arguments)};i._free=function(){return(i._free=i.asm.ab).apply(null,arguments)};var Qo=i.___trap=function(){return(Qo=i.___trap=i.asm.bb).apply(null,arguments)},Fs=i.stackSave=function(){return(Fs=i.stackSave=i.asm.cb).apply(null,arguments)},Ds=i.stackRestore=function(){return(Ds=i.stackRestore=i.asm.db).apply(null,arguments)},ls=i.stackAlloc=function(){return(ls=i.stackAlloc=i.asm.eb).apply(null,arguments)};i.stackAlloc=ls,i.stackSave=Fs,i.stackRestore=Ds,i.ccall=hd;var hs;Fr=function l(){hs||Zo(),hs||(Fr=l)};function dd(l){var h=i._main,c=0,y=0;try{var g=h(c,y);return od(g,!0),g}catch(q){return ld(q)}}function Zo(l){if(En>0||(fs(),En>0))return;function h(){hs||(hs=!0,i.calledRun=!0,!ci&&(Vu(),th(),n(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),tl&&dd(),eh()))}i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),h()},1)):h()}if(i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();var tl=!0;return i.noInitialRun&&(tl=!1),Zo(),e.ready}})(),Wu=S_,zo=class{constructor(t,e){this._bindings=t,this._conn=e}close(){this._bindings.disconnect(this._conn)}useUnsafe(t){return t(this._bindings,this._conn)}query(t){let e=this._bindings.runQuery(this._conn,t),i=Tt.from(e);return console.assert(i.isSync()),console.assert(i.isFile()),new At(i)}async send(t){let e=this._bindings.startPendingQuery(this._conn,t);for(;e==null;)e=await new Promise((r,s)=>{try{r(this._bindings.pollPendingQuery(this._conn))}catch(a){s(a)}});let i=new jo(this._bindings,this._conn,e),n=Tt.from(i);return console.assert(n.isSync()),console.assert(n.isStream()),n}cancelSent(){return this._bindings.cancelPendingQuery(this._conn)}getTableNames(t){return this._bindings.getTableNames(this._conn,t)}prepare(t){let e=this._bindings.createPrepared(this._conn,t);return new sc(this._bindings,this._conn,e)}createScalarFunction(t,e,i){this._bindings.createScalarFunction(this._conn,t,e,i)}insertArrowTable(t,e){let i=Po(t,"stream");this.insertArrowFromIPCStream(i,e)}insertArrowFromIPCStream(t,e){this._bindings.insertArrowFromIPCStream(this._conn,t,e)}insertCSVFromPath(t,e){this._bindings.insertCSVFromPath(this._conn,t,e)}insertJSONFromPath(t,e){this._bindings.insertJSONFromPath(this._conn,t,e)}},jo=class{constructor(t,e,i){this.bindings=t,this.conn=e,this.header=i,this._first=!0,this._depleted=!1}next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let t=this.bindings.fetchQueryResults(this.conn);return this._depleted=t.length==0,{done:this._depleted,value:t}}[Symbol.iterator](){return this}},sc=class{constructor(t,e,i){this.bindings=t,this.connectionId=e,this.statementId=i}close(){this.bindings.closePrepared(this.connectionId,this.statementId)}query(...t){let e=this.bindings.runPrepared(this.connectionId,this.statementId,t),i=Tt.from(e);return console.assert(i.isSync()),console.assert(i.isFile()),new At(i)}send(...t){let e=this.bindings.sendPrepared(this.connectionId,this.statementId,t),i=new jo(this.bindings,this.connectionId,e),n=Tt.from(i);return console.assert(n.isSync()),console.assert(n.isStream()),n}},Xu=new TextEncoder,$u=new TextDecoder("utf-8");function oc(t,e,i){let n=Xu.encode(i),r=t._malloc(n.byteLength),s=t.HEAPU8.subarray(r,r+n.byteLength);s.set(n),t.HEAPF64[(e>>3)+0]=1,t.HEAPF64[(e>>3)+1]=r,t.HEAPF64[(e>>3)+2]=s.byteLength}function cc(t){switch(t){case"UINT8":case"INT8":return 1;case"INT32":case"FLOAT":return 4;case"INT64":case"UINT64":case"DOUBLE":case"VARCHAR":return 8;default:return 0}}function ac(t,e,i,n){let r=t.HEAPU8.subarray(e,e+n*cc(i));switch(i){case"UINT8":return new Uint8Array(r.buffer,r.byteOffset,n);case"INT8":return new Int8Array(r.buffer,r.byteOffset,n);case"INT32":return new Int32Array(r.buffer,r.byteOffset,n);case"FLOAT":return new Float32Array(r.buffer,r.byteOffset,n);case"DOUBLE":return new Float64Array(r.buffer,r.byteOffset,n);case"VARCHAR":return new Float64Array(r.buffer,r.byteOffset,n);default:return new Array(0)}}function Yu(t,e,i){let n=t.HEAPU8.subarray(e,e+i);return new Uint8Array(n.buffer,n.byteOffset,i)}function Wo(t,e,i){let n=t.HEAPU8.subarray(e,e+i*8);return new Float64Array(n.buffer,n.byteOffset,i)}function Gu(t,e,i,n,r,s,a,o){try{let u=t._udfFunctions.get(n);if(!u){oc(e,i,"Unknown UDF with id: "+n);return}let d=$u.decode(e.HEAPU8.subarray(r,r+s)),p=JSON.parse(d),v=Wo(e,a,o/8),Z=ut=>{var ce;let rt=null;switch(ut.validityBuffer!==void 0&&(rt=Yu(e,v[ut.validityBuffer],p.rows)),ut.physicalType){case"VARCHAR":{if(ut.dataBuffer===null||ut.dataBuffer===void 0)throw new Error("malformed data view, expected data buffer for VARCHAR argument");if(ut.lengthBuffer===null||ut.lengthBuffer===void 0)throw new Error("malformed data view, expected data length buffer for VARCHAR argument");let Xt=ac(e,v[ut.dataBuffer],ut.physicalType,p.rows),Qt=[],b=Wo(e,v[ut.lengthBuffer],p.rows);for(let _=0;_<p.rows;++_){if(rt!=null&&!rt[_]){Qt.push(null);continue}let m=e.HEAPU8.subarray(Xt[_],Xt[_]+b[_]),S=$u.decode(m);Qt.push(S)}return _=>Qt[_]}case"STRUCT":{let Xt={},Qt=[];for(let b=0;b<(((ce=ut.children)==null?void 0:ce.length)||0);++b){let _=ut.children[b],m=Z(_);Qt.push(S=>{Xt[_.name]=m(S)})}return rt!=null?b=>{if(!rt[b])return null;for(let _ of Qt)_(b);return Xt}:b=>{for(let _ of Qt)_(b);return Xt}}default:{if(ut.dataBuffer===void 0)throw new Error("malformed data view, expected data buffer for argument of type: "+ut.physicalType);let Xt=ac(e,v[ut.dataBuffer],ut.physicalType,p.rows);return rt!=null?Qt=>rt[Qt]?Xt[Qt]:null:Qt=>Xt[Qt]}}},J=[];for(let ut=0;ut<p.args.length;++ut)J.push(Z(p.args[ut]));let zt=p.rows*cc(p.ret.physicalType),te=e._malloc(zt),Ut=ac(e,te,p.ret.physicalType,p.rows),Ne=e._malloc(p.rows),si=Yu(e,Ne,p.rows);if(Ut.length==0||si.length==0){oc(e,i,"Can't create physical arrays for result");return}let ee=Ut;p.ret.physicalType=="VARCHAR"&&(ee=new Array(p.rows));let Ve=[];for(let ut=0;ut<p.args.length;++ut)Ve.push(null);for(let ut=0;ut<p.rows;++ut){for(let rt=0;rt<p.args.length;++rt)Ve[rt]=J[rt](ut);let ce=u.func(...Ve);ee[ut]=ce,si[ut]=ce==null?0:1}let cn=0;switch(p.ret.physicalType){case"VARCHAR":{let ut=new Array(0);cn=e._malloc(p.rows*cc("DOUBLE"));let ce=Wo(e,cn,p.rows),rt=0;for(let _=0;_<p.rows;++_){let m=Xu.encode(ee[_]||"");ut.push(m),ce[_]=m.length,rt+=m.length}let Xt=e._malloc(rt),Qt=e.HEAPU8.subarray(Xt,Xt+rt),b=0;for(let _=0;_<p.rows;++_){Ut[_]=b;let m=ut[_];Qt.subarray(b,b+m.length).set(m),b+=m.length}}}let ui=3*8,ci=e._malloc(ui),ai=Wo(e,ci,3);ai[0]=te,ai[1]=Ne,ai[2]=cn,e.HEAPF64[(i>>3)+0]=0,e.HEAPF64[(i>>3)+1]=ci,e.HEAPF64[(i>>3)+2]=0}catch(u){oc(e,i,u.toString())}}function F_(){let t=new TextDecoder;return e=>(typeof SharedArrayBuffer<"u"&&e.buffer instanceof SharedArrayBuffer&&(e=new Uint8Array(e)),t.decode(e))}var A_=F_();function ir(t,e){console.error(`FAIL WITH: ${e}`),t.ccall("duckdb_web_fail_with",null,["string"],[e])}function Tn(t,e,i){let n=t.HEAPU8.subarray(e,e+i),r=new Uint8Array(new ArrayBuffer(n.byteLength));return r.set(n),r}function z(t,e,i){return A_(t.HEAPU8.subarray(e,e+i))}function ot(t,e,i,n){let r=t.stackSave(),s=t.stackAlloc(3*8);i.unshift("number"),n.unshift(s),t.ccall(e,null,i,n);let a=t.HEAPF64[(s>>3)+0],o=t.HEAPF64[(s>>3)+1],u=t.HEAPF64[(s>>3)+2];return t.stackRestore(r),[a,o,u]}function _t(t){t.ccall("duckdb_web_clear_response",null,[],[])}var $o=class{constructor(t){let e=new Float64Array(t.buffer,t.byteOffset,t.byteLength/8),i=new Uint8Array(new ArrayBuffer(t.byteLength));i.set(t.subarray(7*8)),this.totalFileReadsCold=e[0],this.totalFileReadsAhead=e[1],this.totalFileReadsCached=e[2],this.totalFileWrites=e[3],this.totalPageAccesses=e[4],this.totalPageLoads=e[5],this.blockSize=e[6],this.blockStats=i}getBlockStats(t,e){return e=e||{file_reads_cold:0,file_reads_ahead:0,file_reads_cached:0,file_writes:0,page_accesses:0,page_loads:0},e.file_writes=this.blockStats[t*3+0]&15,e.file_reads_cold=this.blockStats[t*3+0]>>4,e.file_reads_ahead=this.blockStats[t*3+1]&15,e.file_reads_cached=this.blockStats[t*3+1]>>4,e.page_accesses=this.blockStats[t*3+1]&15,e.page_loads=this.blockStats[t*3+1]>>4,e}},x_=new TextEncoder,Yo=class{constructor(t,e){this._instance=null,this._initPromise=null,this._initPromiseResolver=()=>{},this.onInstantiationProgress=[],this._logger=t,this._runtime=e,this._nextUDFId=1}get logger(){return this._logger}get mod(){return this._instance}get pthread(){return this.mod.PThread||null}async instantiate(t=e=>{}){return this._instance!=null?this:(this._initPromise!=null&&(this.onInstantiationProgress.push(t),await this._initPromise),this._initPromise=new Promise(e=>{this._initPromiseResolver=e}),this.onInstantiationProgress=[t],this._instance=await this.instantiateImpl({print:console.log.bind(console),printErr:console.log.bind(console),onRuntimeInitialized:this._initPromiseResolver}),await this._initPromise,this._initPromise=null,this.onInstantiationProgress=this.onInstantiationProgress.filter(e=>e!=t),this)}open(t){let[e,i,n]=ot(this.mod,"duckdb_web_open",["string"],[JSON.stringify(t)]);if(e!==0)throw new Error(z(this.mod,i,n));_t(this.mod)}reset(){let[t,e,i]=ot(this.mod,"duckdb_web_reset",[],[]);if(t!==0)throw new Error(z(this.mod,e,i));_t(this.mod)}getVersion(){let[t,e,i]=ot(this.mod,"duckdb_web_get_version",[],[]);if(t!==0)throw new Error(z(this.mod,e,i));let n=z(this.mod,e,i);return _t(this.mod),n}getFeatureFlags(){return this.mod.ccall("duckdb_web_get_feature_flags","number",[],[])}tokenize(t){let[e,i,n]=ot(this.mod,"duckdb_web_tokenize",["string"],[t]);if(e!==0)throw new Error(z(this.mod,i,n));let r=z(this.mod,i,n);return _t(this.mod),JSON.parse(r)}connect(){let t=this.mod.ccall("duckdb_web_connect","number",[],[]);return new zo(this,t)}disconnect(t){if(this.mod.ccall("duckdb_web_disconnect",null,["number"],[t]),this.pthread)for(let e of[...this.pthread.runningWorkers,...this.pthread.unusedWorkers])e.postMessage({cmd:"dropUDFFunctions",connectionId:t})}runQuery(t,e){let[i,n,r]=ot(this.mod,"duckdb_web_query_run",["number","string"],[t,e]);if(i!==0)throw new Error(z(this.mod,n,r));let s=Tn(this.mod,n,r);return _t(this.mod),s}startPendingQuery(t,e){let[i,n,r]=ot(this.mod,"duckdb_web_pending_query_start",["number","string"],[t,e]);if(i!==0)throw new Error(z(this.mod,n,r));if(n==0)return null;let s=Tn(this.mod,n,r);return _t(this.mod),s}pollPendingQuery(t){let[e,i,n]=ot(this.mod,"duckdb_web_pending_query_poll",["number"],[t]);if(e!==0)throw new Error(z(this.mod,i,n));if(i==0)return null;let r=Tn(this.mod,i,n);return _t(this.mod),r}cancelPendingQuery(t){return this.mod.ccall("duckdb_web_pending_query_cancel","boolean",["number"],[t])}fetchQueryResults(t){let[e,i,n]=ot(this.mod,"duckdb_web_query_fetch_results",["number"],[t]);if(e!==0)throw new Error(z(this.mod,i,n));let r=Tn(this.mod,i,n);return _t(this.mod),r}getTableNames(t,e){let[i,n,r]=ot(this.mod,"duckdb_web_get_tablenames",["number","string"],[t,e]);if(i!==0)throw new Error(z(this.mod,n,r));let s=z(this.mod,n,r);return _t(this.mod),JSON.parse(s)}createScalarFunction(t,e,i,n){let r={functionId:this._nextUDFId,name:e,returnType:ni(i)},s={functionId:r.functionId,connectionId:t,name:e,returnType:i,func:n};this._nextUDFId+=1;let[a,o,u]=ot(this.mod,"duckdb_web_udf_scalar_create",["number","string"],[t,JSON.stringify(r)]);if(a!==0)throw new Error(z(this.mod,o,u));if(_t(this.mod),globalThis.DUCKDB_RUNTIME._udfFunctions=(globalThis.DUCKDB_RUNTIME._udfFunctions||new Map).set(s.functionId,s),this.pthread)for(let d of[...this.pthread.runningWorkers,...this.pthread.unusedWorkers])d.postMessage({cmd:"registerUDFFunction",udf:s})}createPrepared(t,e){let[i,n,r]=ot(this.mod,"duckdb_web_prepared_create",["number","string"],[t,e]);if(i!==0)throw new Error(z(this.mod,n,r));return _t(this.mod),n}closePrepared(t,e){let[i,n,r]=ot(this.mod,"duckdb_web_prepared_close",["number","number"],[t,e]);if(i!==0)throw new Error(z(this.mod,n,r));_t(this.mod)}runPrepared(t,e,i){let[n,r,s]=ot(this.mod,"duckdb_web_prepared_run",["number","number","string"],[t,e,JSON.stringify(i)]);if(n!==0)throw new Error(z(this.mod,r,s));let a=Tn(this.mod,r,s);return _t(this.mod),a}sendPrepared(t,e,i){let[n,r,s]=ot(this.mod,"duckdb_web_prepared_send",["number","number","string"],[t,e,JSON.stringify(i)]);if(n!==0)throw new Error(z(this.mod,r,s));let a=Tn(this.mod,r,s);return _t(this.mod),a}insertArrowFromIPCStream(t,e,i){if(e.length==0)return;let n=this.mod._malloc(e.length);this.mod.HEAPU8.subarray(n,n+e.length).set(e);let r=i?JSON.stringify(i):"",[s,a,o]=ot(this.mod,"duckdb_web_insert_arrow_from_ipc_stream",["number","number","number","string"],[t,n,e.length,r]);if(s!==0)throw new Error(z(this.mod,a,o))}insertCSVFromPath(t,e,i){if(i.columns!==void 0){i.columnsFlat=[];for(let u in i.columns)i.columnsFlat.push(Ho(u,i.columns[u]))}let n={...i};n.columns=n.columnsFlat,delete n.columnsFlat;let r=JSON.stringify(n),[s,a,o]=ot(this.mod,"duckdb_web_insert_csv_from_path",["number","string","string"],[t,e,r]);if(s!==0)throw new Error(z(this.mod,a,o))}insertJSONFromPath(t,e,i){if(i.columns!==void 0){i.columnsFlat=[];for(let u in i.columns)i.columnsFlat.push(Ho(u,i.columns[u]))}let n={...i};n.columns=n.columnsFlat,delete n.columnsFlat;let r=JSON.stringify(n),[s,a,o]=ot(this.mod,"duckdb_web_insert_json_from_path",["number","string","string"],[t,e,r]);if(s!==0)throw new Error(z(this.mod,a,o))}globFiles(t){let[e,i,n]=ot(this.mod,"duckdb_web_fs_glob_file_infos",["string"],[t]);if(e!==0)throw new Error(z(this.mod,i,n));let r=z(this.mod,i,n);_t(this.mod);let s=JSON.parse(r);return s??[]}registerFileURL(t,e,i,n=!1){e===void 0&&(e=t);let[r,s,a]=ot(this.mod,"duckdb_web_fs_register_file_url",["string","string"],[t,e,i,n]);if(r!==0)throw new Error(z(this.mod,s,a));_t(this.mod)}registerFileText(t,e){let i=x_.encode(e);this.registerFileBuffer(t,i)}registerFileBuffer(t,e){let i=this.mod._malloc(e.length);this.mod.HEAPU8.subarray(i,i+e.length).set(e);let[n,r,s]=ot(this.mod,"duckdb_web_fs_register_file_buffer",["string","number","number"],[t,i,e.length]);if(n!==0)throw new Error(z(this.mod,r,s));_t(this.mod)}registerFileHandle(t,e,i,n){let[r,s,a]=ot(this.mod,"duckdb_web_fs_register_file_url",["string","string","number","boolean"],[t,t,i,n]);if(r!==0)throw new Error(z(this.mod,s,a));if(_t(this.mod),globalThis.DUCKDB_RUNTIME._files=(globalThis.DUCKDB_RUNTIME._files||new Map).set(t,e),this.pthread){for(let o of this.pthread.runningWorkers)o.postMessage({cmd:"registerFileHandle",fileName:t,fileHandle:e});for(let o of this.pthread.unusedWorkers)o.postMessage({cmd:"dropFileHandle",fileName:t})}}dropFile(t){let[e,i,n]=ot(this.mod,"duckdb_web_fs_drop_file",["string"],[t]);if(e!==0)throw new Error(z(this.mod,i,n));_t(this.mod)}dropFiles(){let[t,e,i]=ot(this.mod,"duckdb_web_fs_drop_files",[],[]);if(t!==0)throw new Error(z(this.mod,e,i));_t(this.mod)}flushFiles(){this.mod.ccall("duckdb_web_flush_files",null,[],[])}copyFileToPath(t,e){let[i,n,r]=ot(this.mod,"duckdb_web_copy_file_to_path",["string","string"],[t,e]);if(i!==0)throw new Error(z(this.mod,n,r));_t(this.mod)}copyFileToBuffer(t){let[e,i,n]=ot(this.mod,"duckdb_web_copy_file_to_buffer",["string"],[t]);if(e!==0)throw new Error(z(this.mod,i,n));let r=this.mod.HEAPU8.subarray(i,i+n),s=new Uint8Array(r.length);return s.set(r),_t(this.mod),s}collectFileStatistics(t,e){let[i,n,r]=ot(this.mod,"duckdb_web_collect_file_stats",["string","boolean"],[t,e]);if(i!==0)throw new Error(z(this.mod,n,r))}exportFileStatistics(t){let[e,i,n]=ot(this.mod,"duckdb_web_export_file_stats",["string"],[t]);if(e!==0)throw new Error(z(this.mod,i,n));return new $o(this.mod.HEAPU8.subarray(i,i+n))}},Xo=class extends Yo{constructor(t,e,i,n){super(t,e),this.mainModuleURL=i,this.pthreadWorkerURL=n}locateFile(t,e){if(t.endsWith(".wasm"))return this.mainModuleURL;if(t.endsWith(".worker.js")){if(!this.pthreadWorkerURL)throw new Error("Missing DuckDB worker URL!");return this.pthreadWorkerURL}throw new Error(`WASM instantiation requested unexpected file: prefix=${e} path=${t}`)}instantiateWasm(t,e){globalThis.DUCKDB_RUNTIME=this._runtime;let i=this.onInstantiationProgress;if(WebAssembly.instantiateStreaming)if(typeof TransformStream=="function"){let n=(async()=>{var r;let s=new Request(this.mainModuleURL),a=await fetch(s),o=a.headers.get("content-length"),u=o&&parseInt(o,10)||0,d=new Date,p={startedAt:d,updatedAt:d,bytesTotal:u||0,bytesLoaded:0},v={transform(J,zt){p.bytesLoaded+=J.byteLength;let te=new Date;if(te.getTime()-p.updatedAt.getTime()<20){p.updatedAt=te,zt.enqueue(J);return}for(let Ut of i)Ut(p);zt.enqueue(J)}},Z=new TransformStream(v);return new Response((r=a.body)==null?void 0:r.pipeThrough(Z),a)})();WebAssembly.instantiateStreaming(n,t).then(r=>{e(r.instance,r.module)})}else{console.warn("instantiating without progress handler since transform streams are unavailable");let n=new Request(this.mainModuleURL);WebAssembly.instantiateStreaming(fetch(n),t).then(r=>{e(r.instance,r.module)})}else if(typeof XMLHttpRequest=="function"){let n=new XMLHttpRequest,r=this.mainModuleURL,s=new Date,a={startedAt:s,updatedAt:s,bytesTotal:0,bytesLoaded:0};n.open("GET",r),n.responseType="arraybuffer",n.onerror=o=>{throw this.logger.log({timestamp:new Date,level:4,origin:3,topic:5,event:2,value:"Failed to load WASM: "+o}),new Error(o.toString())},n.onprogress=o=>{a.bytesTotal=o.total,a.bytesLoaded=o.loaded;let u=new Date;if(u.getTime()-a.updatedAt.getTime()<20){a.updatedAt=u;return}for(let d of i)d(a)},n.onload=()=>{WebAssembly.instantiate(n.response,t).then(o=>{e(o.instance,o.module)}).catch(o=>{throw this.logger.log({timestamp:new Date,level:4,origin:3,topic:5,event:2,value:"Failed to instantiate WASM: "+o}),new Error(o)})},n.send()}else console.warn("instantiating with manual fetch since streaming instantiation and xhrs are unavailable"),(async()=>{let n=new Request(this.mainModuleURL),r=await(await fetch(n)).arrayBuffer();WebAssembly.instantiate(r,t).then(s=>{e(s.instance,s.module)})})();return[]}},Go=class extends Xo{constructor(t,e,i,n=null){super(t,e,i,n)}instantiateImpl(t){return Wu({...t,instantiateWasm:this.instantiateWasm.bind(this),locateFile:this.locateFile.bind(this)})}},an=Uc(Ku()),Ju=function(t,e,i){var n;if((n=t==null?void 0:t.endpoint)!=null&&n.startsWith("http")){let r=`${t==null?void 0:t.endpoint}`,s=r.indexOf("://")+3;return r.substring(s)}else return t!=null&&t.endpoint?`${i}.${t==null?void 0:t.endpoint}`:`${i}.s3.amazonaws.com`};function B_(t,e,i){var n,r,s,a;let o=qu(e),u=o.path;return Zu(t)&&(u=`/${o.bucket}${u}`),{url:u,query:"",host:Ju(t,e,o.bucket),region:(n=t==null?void 0:t.region)!=null?n:"",service:"s3",method:i,accessKeyId:(r=t==null?void 0:t.accessKeyId)!=null?r:"",secretAccessKey:(s=t==null?void 0:t.secretAccessKey)!=null?s:"",sessionToken:(a=t==null?void 0:t.sessionToken)!=null?a:"",dateNow:new Date().toISOString().replace(/-/g,"").split("T")[0],datetimeNow:new Date().toISOString().replace(/-/g,"").replace(/:/g,"").split(".")[0]+"Z"}}function T_(t,e=!1){let i="0123456789ABCDEF",n="";for(let r=0;r<t.length;r++){let s=t[r];s>="A"&&s<="Z"||s>="a"&&s<="z"||s>="0"&&s<="9"||s=="_"||s=="-"||s=="~"||s=="."?n+=s:s=="/"?e?n+="%2F":n+=s:(n+="%",n+=i[s.charCodeAt(0)>>4],n+=i[s.charCodeAt(0)&15])}return n}function D_(t,e=null){var i;let n=(i=e==null?void 0:e.contentHash)!=null?i:"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",r=new Map;r.set("x-amz-date",t.datetimeNow),r.set("x-amz-content-sha256",n),t.sessionToken&&r.set("x-amz-security-token",t.sessionToken);let s="";e!=null&&e.contentType&&(s+="content-type;"),s+="host;x-amz-content-sha256;x-amz-date",t.sessionToken&&(s+=";x-amz-security-token");let a=t.method+`
`+T_(t.url)+`
`+t.query;e!=null&&e.contentType&&(a+=`
content-type:`+(e==null?void 0:e.contentType)),a+=`
host:`+t.host+`
x-amz-content-sha256:`+n+`
x-amz-date:`+t.datetimeNow,t.sessionToken&&t.sessionToken.length>0&&(a+=`
x-amz-security-token:`+t.sessionToken),a+=`

`+s+`
`+n;let o=(0,an.sha256)(a),u=`AWS4-HMAC-SHA256
`+t.datetimeNow+`
`+t.dateNow+"/"+t.region+"/"+t.service+`/aws4_request
`+o,d="AWS4"+t.secretAccessKey,p=an.sha256.hmac.arrayBuffer(d,t.dateNow),v=an.sha256.hmac.arrayBuffer(p,t.region),Z=an.sha256.hmac.arrayBuffer(v,t.service),J=an.sha256.hmac.arrayBuffer(Z,"aws4_request"),zt=an.sha256.hmac(J,u);return r.set("Authorization","AWS4-HMAC-SHA256 Credential="+t.accessKeyId+"/"+t.dateNow+"/"+t.region+"/"+t.service+"/aws4_request, SignedHeaders="+s+", Signature="+zt),r}var E_=function(t,e,i,n=null,r=null){let s=B_(t,e,i),a={contentType:n,contentHash:r?an.sha256.hex(r):null};return D_(s,a)};function Sr(t,e,i,n,r=null,s=null){(e!=null&&e.accessKeyId||e!=null&&e.sessionToken)&&(E_(e,i,n,r,s).forEach((a,o)=>{t.setRequestHeader(o,a)}),r&&t.setRequestHeader("content-type",r))}function qu(t){if(t.indexOf("s3://")!=0)throw new Error("URL needs to start with s3://");let e=t.indexOf("/",5);if(e==-1)throw new Error("URL needs to contain a '/' after the host");let i=t.substring(5,e);if(!i)throw new Error("URL needs to contain a bucket name");let n=t.substring(e);if(!n)throw new Error("URL needs to contain key");return{bucket:i,path:n}}function Zu(t){var e;return!!((e=t==null?void 0:t.endpoint)!=null&&e.startsWith("http"))}function Ir(t,e){let i=qu(e);return Zu(t)?`${t==null?void 0:t.endpoint}/${i.bucket}`+i.path:"https://"+Ju(t,e,i.bucket)+i.path}var et={_files:new Map,_fileInfoCache:new Map,_udfFunctions:new Map,_globalFileInfo:null,getFileInfo(t,e){try{let i=et._fileInfoCache.get(e),[n,r,s]=ot(t,"duckdb_web_fs_get_file_info_by_id",["number","number"],[e,(i==null?void 0:i.cacheEpoch)||0]);if(n!==0)return null;if(s===0)return i;let a=z(t,r,s);_t(t);let o=JSON.parse(a);if(o==null)return null;let u={...o,blob:null};return et._fileInfoCache.set(e,u),u}catch{return null}},getGlobalFileInfo(t){var e;try{let[i,n,r]=ot(t,"duckdb_web_get_global_file_info",["number"],[((e=et._globalFileInfo)==null?void 0:e.cacheEpoch)||0]);if(i!==0)return null;if(r===0)return et._globalFileInfo;let s=z(t,n,r);_t(t);let a=JSON.parse(s);return a==null?null:(et._globalFileInfo={...a,blob:null},et._globalFileInfo)}catch{return null}},testPlatformFeature:(t,e)=>{switch(e){case 1:return typeof BigInt64Array<"u";default:return console.warn(`test for unknown feature: ${e}`),!1}},getDefaultDataProtocol(t){return 2},openFile:(t,e,i)=>{var n;try{et._fileInfoCache.delete(e);let r=et.getFileInfo(t,e);switch(r==null?void 0:r.dataProtocol){case 4:case 5:{if(i&1&&i&2)throw new Error(`Opening file ${r.fileName} failed: cannot open file with both read and write flags set`);if(i&32)throw new Error(`Opening file ${r.fileName} failed: appending to HTTP/S3 files is not supported`);if(i&2){let o=new XMLHttpRequest;if(r.dataProtocol==5?(o.open("HEAD",Ir(r.s3Config,r.dataUrl),!1),Sr(o,r.s3Config,r.dataUrl,"HEAD")):o.open("HEAD",r.dataUrl,!1),o.send(null),o.status!=200&&o.status!=404)throw new Error(`Opening file ${r.fileName} failed: Unexpected return status from server (${o.status})`);if(o.status==404&&!(i&8||i&16))throw new Error(`Opening file ${r.fileName} failed: Cannot write to non-existent file without FILE_FLAGS_FILE_CREATE or FILE_FLAGS_FILE_CREATE_NEW flag.`);let u=t._malloc(1),d=new Uint8Array;t.HEAPU8.set(d,u);let p=t._malloc(2*8);return t.HEAPF64[(p>>3)+0]=1,t.HEAPF64[(p>>3)+1]=u,p}else if(i!=1)throw new Error(`Opening file ${r.fileName} failed: unsupported file flags: ${i}`);let s=null,a=null;try{let o=new XMLHttpRequest;if(r.dataProtocol==5?(o.open("HEAD",Ir(r.s3Config,r.dataUrl),!1),Sr(o,r.s3Config,r.dataUrl,"HEAD")):o.open("HEAD",r.dataUrl,!1),o.setRequestHeader("Range","bytes=0-"),o.send(null),s=o.getResponseHeader("Content-Length"),s!==null&&o.status==206){let u=t._malloc(16);return t.HEAPF64[(u>>3)+0]=+s,t.HEAPF64[(u>>3)+1]=0,u}}catch(o){a=o,console.warn(`HEAD request with range header failed: ${o}`)}if(r.allowFullHttpReads){if(s!==null&&+s>1){let u=new XMLHttpRequest;r.dataProtocol==5?(u.open("GET",Ir(r.s3Config,r.dataUrl),!1),Sr(u,r.s3Config,r.dataUrl,"GET")):u.open("GET",r.dataUrl,!1),u.setRequestHeader("Range","bytes=0-0"),u.send(null);let d=u.getResponseHeader("Content-Length");if(u.status==206&&d!==null&&+d==1){let p=t._malloc(16);return t.HEAPF64[(p>>3)+0]=+s,t.HEAPF64[(p>>3)+1]=0,p}if(u.status==200&&d!==null&&+d==+s){console.warn(`fall back to full HTTP read for: ${r.dataUrl}`);let p=t._malloc(u.response.byteLength),v=new Uint8Array(u.response,0,u.response.byteLength);t.HEAPU8.set(v,p);let Z=t._malloc(2*8);return t.HEAPF64[(Z>>3)+0]=u.response.byteLength,t.HEAPF64[(Z>>3)+1]=p,Z}}console.warn(`falling back to full HTTP read for: ${r.dataUrl}`);let o=new XMLHttpRequest;if(r.dataProtocol==5?(o.open("GET",Ir(r.s3Config,r.dataUrl),!1),Sr(o,r.s3Config,r.dataUrl,"GET")):o.open("GET",r.dataUrl,!1),o.responseType="arraybuffer",o.send(null),o.status==200){let u=t._malloc(o.response.byteLength),d=new Uint8Array(o.response,0,o.response.byteLength);t.HEAPU8.set(d,u);let p=t._malloc(2*8);return t.HEAPF64[(p>>3)+0]=o.response.byteLength,t.HEAPF64[(p>>3)+1]=u,p}}if(a!=null)throw new Error(`Reading file ${r.fileName} failed with error: ${a}`);return 0}case 2:{let s=(n=et._files)==null?void 0:n.get(r.fileName);if(s){let u=t._malloc(16);return t.HEAPF64[(u>>3)+0]=s.size,t.HEAPF64[(u>>3)+1]=0,u}console.warn(`Buffering missing file: ${r.fileName}`);let a=t._malloc(2*8),o=t._malloc(1);return t.HEAPF64[(a>>3)+0]=1,t.HEAPF64[(a>>3)+1]=o,a}}}catch(r){console.error(r.toString()),ir(t,r.toString())}return 0},glob:(t,e,i)=>{var n;try{let r=z(t,e,i);if(r.startsWith("http")||r.startsWith("s3://")){let s=new XMLHttpRequest;if(r.startsWith("s3://")){let a=et.getGlobalFileInfo(t);s.open("HEAD",Ir(a==null?void 0:a.s3Config,r),!1),Sr(s,a==null?void 0:a.s3Config,r,"HEAD")}else s.open("HEAD",r,!1);if(s.send(null),s.status!=200&&s.status!==206){if(!((n=et.getGlobalFileInfo(t))!=null&&n.allowFullHttpReads)){ir(t,`HEAD request failed: ${r}, with full http reads are disabled`);return}let a=new XMLHttpRequest;if(r.startsWith("s3://")){let u=et.getGlobalFileInfo(t);a.open("GET",Ir(u==null?void 0:u.s3Config,r),!1),Sr(a,u==null?void 0:u.s3Config,r,"HEAD")}else a.open("GET",r,!1);if(a.setRequestHeader("Range","bytes=0-0"),a.send(null),a.status!=200&&a.status!==206){ir(t,`HEAD and GET requests failed: ${r}`);return}let o=a.getResponseHeader("Content-Length");o&&+o>1&&console.warn(`Range request for ${r} did not return a partial response: ${a.status} "${a.statusText}"`)}t.ccall("duckdb_web_fs_glob_add_path",null,["string"],[r])}}catch(r){return ir(t,r.toString()),0}},checkFile:(t,e,i)=>{try{let n=z(t,e,i);if(n.startsWith("http")||n.startsWith("s3://")){let r=new XMLHttpRequest;if(n.startsWith("s3://")){let s=et.getGlobalFileInfo(t);r.open("HEAD",Ir(s==null?void 0:s.s3Config,n),!1),Sr(r,s==null?void 0:s.s3Config,n,"HEAD")}else r.open("HEAD",n,!1);return r.send(null),r.status==206||r.status==200}}catch{return!1}return!1},syncFile:(t,e)=>{},closeFile:(t,e)=>{var i;let n=et.getFileInfo(t,e);switch(et._fileInfoCache.delete(e),n==null?void 0:n.dataProtocol){case 0:case 4:case 5:break;case 1:case 2:return;case 3:{let r=(i=et._files)==null?void 0:i.get(n.fileName);if(!r)throw new Error(`No OPFS access handle registered with name: ${n.fileName}`);return r.flush()}}},truncateFile:(t,e,i)=>{var n;let r=et.getFileInfo(t,e);switch(r==null?void 0:r.dataProtocol){case 4:ir(t,"Cannot truncate a http file");return;case 5:ir(t,"Cannot truncate an s3 file");return;case 0:case 1:case 2:ir(t,"truncateFile not implemented");return;case 3:{let s=(n=et._files)==null?void 0:n.get(r.fileName);if(!s)throw new Error(`No OPFS access handle registered with name: ${r.fileName}`);return s.truncate(i)}}return 0},readFile(t,e,i,n,r){var s,a;if(n==0)return 0;try{let o=et.getFileInfo(t,e);switch(o==null?void 0:o.dataProtocol){case 4:case 5:{if(!o.dataUrl)throw new Error(`Missing data URL for file ${e}`);try{let u=new XMLHttpRequest;if(o.dataProtocol==5?(u.open("GET",Ir(o==null?void 0:o.s3Config,o.dataUrl),!1),Sr(u,o==null?void 0:o.s3Config,o.dataUrl,"GET")):u.open("GET",o.dataUrl,!1),u.responseType="arraybuffer",u.setRequestHeader("Range",`bytes=${r}-${r+n-1}`),u.send(null),u.status==206||u.status==200&&n==u.response.byteLength&&r==0){let d=new Uint8Array(u.response,0,Math.min(u.response.byteLength,n));return t.HEAPU8.set(d,i),d.byteLength}else if(u.status==200){console.warn(`Range request for ${o.dataUrl} did not return a partial response: ${u.status} "${u.statusText}"`);let d=new Uint8Array(u.response,r,Math.min(u.response.byteLength-r,n));return t.HEAPU8.set(d,i),d.byteLength}else throw new Error(`Range request for ${o.dataUrl} did returned non-success status: ${u.status} "${u.statusText}"`)}catch(u){throw new Error(`Range request for ${o.dataUrl} failed with error: ${u}"`)}}case 2:{let u=(s=et._files)==null?void 0:s.get(o.fileName);if(!u)throw new Error(`No HTML5 file registered with name: ${o.fileName}`);let d=u.slice(r,r+n),p=new Uint8Array(new FileReaderSync().readAsArrayBuffer(d));return t.HEAPU8.set(p,i),p.byteLength}case 3:{let u=(a=et._files)==null?void 0:a.get(o.fileName);if(!u)throw new Error(`No OPFS access handle registered with name: ${o.fileName}`);let d=t.HEAPU8.subarray(i,i+n);return u.read(d,{at:r})}}return 0}catch(o){return ir(t,o.toString()),0}},writeFile:(t,e,i,n,r)=>{var s;let a=et.getFileInfo(t,e);switch(a==null?void 0:a.dataProtocol){case 4:return ir(t,"Cannot write to HTTP file"),0;case 5:{let o=t.HEAPU8.subarray(i,i+n),u=new XMLHttpRequest;return u.open("PUT",Ir(a==null?void 0:a.s3Config,a.dataUrl),!1),Sr(u,a==null?void 0:a.s3Config,a.dataUrl,"PUT","",o),u.send(o),n}case 2:return ir(t,"cannot write using the html5 file reader api"),0;case 3:{let o=(s=et._files)==null?void 0:s.get(a.fileName);if(!o)throw new Error(`No OPFS access handle registered with name: ${a.fileName}`);let u=t.HEAPU8.subarray(i,i+n);return o.write(u,{at:r})}}return 0},getLastFileModificationTime:(t,e)=>{var i;let n=et.getFileInfo(t,e);switch(n==null?void 0:n.dataProtocol){case 2:{if(!((i=et._files)!=null&&i.get(n.fileName)))throw Error(`No handle available for file: ${n.fileName}`);return 0}case 4:case 5:return new Date().getTime()}return 0},checkDirectory:(t,e,i)=>{let n=z(t,e,i);return console.log(`checkDirectory: ${n}`),!1},createDirectory:(t,e,i)=>{let n=z(t,e,i);console.log(`createDirectory: ${n}`)},removeDirectory:(t,e,i)=>{let n=z(t,e,i);console.log(`removeDirectory: ${n}`)},listDirectoryEntries:(t,e,i)=>{let n=z(t,e,i);return console.log(`listDirectoryEntries: ${n}`),!1},moveFile:(t,e,i,n,r)=>{var s,a;let o=z(t,e,i),u=z(t,n,r),d=(s=et._files)==null?void 0:s.get(o);d!==void 0&&(et._files.delete(d),et._files.set(u,d));for(let[p,v]of((a=et._fileInfoCache)==null?void 0:a.entries())||[])if(v.dataUrl==o){et._fileInfoCache.delete(p);break}return!0},removeFile:(t,e,i)=>{},callScalarUDF:(t,e,i,n,r,s,a)=>{Gu(et,t,e,i,n,r,s,a)}},lc=class extends Vo{postMessage(t,e){globalThis.postMessage(t,e)}async instantiate(t,e,i){return await new Go(this,et,t,e).instantiate(i)}};function Qu(){let t=new lc;globalThis.onmessage=async e=>{await t.onMessage(e.data)}}return Qu(),Ph(O_)})()})();
